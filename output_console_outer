2018-05-12 23:37:20 WARN  Utils:66 - Your hostname, ubuntu resolves to a loopback address: 127.0.1.1; using 192.168.19.162 instead (on interface ens33)
2018-05-12 23:37:20 WARN  Utils:66 - Set SPARK_LOCAL_IP if you need to bind to another address
2018-05-12 23:37:21 WARN  NativeCodeLoader:62 - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2018-05-12 23:37:22 INFO  SparkContext:54 - Running Spark version 2.3.0
2018-05-12 23:37:22 INFO  SparkContext:54 - Submitted application: RateStreamStreamJoin
2018-05-12 23:37:22 INFO  SecurityManager:54 - Changing view acls to: fandev
2018-05-12 23:37:22 INFO  SecurityManager:54 - Changing modify acls to: fandev
2018-05-12 23:37:22 INFO  SecurityManager:54 - Changing view acls groups to: 
2018-05-12 23:37:22 INFO  SecurityManager:54 - Changing modify acls groups to: 
2018-05-12 23:37:22 INFO  SecurityManager:54 - SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(fandev); groups with view permissions: Set(); users  with modify permissions: Set(fandev); groups with modify permissions: Set()
2018-05-12 23:37:22 INFO  Utils:54 - Successfully started service 'sparkDriver' on port 46572.
2018-05-12 23:37:23 INFO  SparkEnv:54 - Registering MapOutputTracker
2018-05-12 23:37:23 INFO  SparkEnv:54 - Registering BlockManagerMaster
2018-05-12 23:37:23 INFO  BlockManagerMasterEndpoint:54 - Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
2018-05-12 23:37:23 INFO  BlockManagerMasterEndpoint:54 - BlockManagerMasterEndpoint up
2018-05-12 23:37:23 INFO  DiskBlockManager:54 - Created local directory at /tmp/blockmgr-e927e2f8-b6c8-4c19-a606-a67d2be4e8cb
2018-05-12 23:37:23 INFO  MemoryStore:54 - MemoryStore started with capacity 366.3 MB
2018-05-12 23:37:23 INFO  SparkEnv:54 - Registering OutputCommitCoordinator
2018-05-12 23:37:23 INFO  log:192 - Logging initialized @5440ms
2018-05-12 23:37:23 INFO  Server:346 - jetty-9.3.z-SNAPSHOT
2018-05-12 23:37:23 INFO  Server:414 - Started @5697ms
2018-05-12 23:37:23 INFO  AbstractConnector:278 - Started ServerConnector@1a6f5124{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2018-05-12 23:37:23 INFO  Utils:54 - Successfully started service 'SparkUI' on port 4040.
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2f40a43{/jobs,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3c291aad{/jobs/json,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2d0566ba{/jobs/job,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@7728643a{/jobs/job/json,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@320e400{/stages,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5167268{/stages/json,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1cfd1875{/stages/stage,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1af7f54a{/stages/stage/json,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@6ebd78d1{/stages/pool,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@436390f4{/stages/pool/json,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@4d157787{/storage,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@68ed96ca{/storage/json,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@6d1310f6{/storage/rdd,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3228d990{/storage/rdd/json,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@54e7391d{/environment,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@50b8ae8d{/environment/json,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@255990cc{/executors,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@51c929ae{/executors/json,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3c8bdd5b{/executors/threadDump,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@29d2d081{/executors/threadDump/json,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@40e4ea87{/static,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@28a2a3e7{/,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3f2049b6{/api,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@e72dba7{/jobs/job/kill,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@33c2bd{/stages/stage/kill,null,AVAILABLE,@Spark}
2018-05-12 23:37:23 INFO  SparkUI:54 - Bound SparkUI to 0.0.0.0, and started at http://192.168.19.162:4040
2018-05-12 23:37:24 INFO  SparkContext:54 - Added JAR file:/home/fandev/workspace/samples/spark-structured-streaming2/build/libs/spark-structured-streaming2-0.0.1-SNAPSHOT.jar at spark://192.168.19.162:46572/jars/spark-structured-streaming2-0.0.1-SNAPSHOT.jar with timestamp 1526193444014
2018-05-12 23:37:24 INFO  Executor:54 - Starting executor ID driver on host localhost
2018-05-12 23:37:24 INFO  Utils:54 - Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 46196.
2018-05-12 23:37:24 INFO  NettyBlockTransferService:54 - Server created on 192.168.19.162:46196
2018-05-12 23:37:24 INFO  BlockManager:54 - Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
2018-05-12 23:37:24 INFO  BlockManagerMaster:54 - Registering BlockManager BlockManagerId(driver, 192.168.19.162, 46196, None)
2018-05-12 23:37:24 INFO  BlockManagerMasterEndpoint:54 - Registering block manager 192.168.19.162:46196 with 366.3 MB RAM, BlockManagerId(driver, 192.168.19.162, 46196, None)
2018-05-12 23:37:24 INFO  BlockManagerMaster:54 - Registered BlockManager BlockManagerId(driver, 192.168.19.162, 46196, None)
2018-05-12 23:37:24 INFO  BlockManager:54 - Initialized BlockManager: BlockManagerId(driver, 192.168.19.162, 46196, None)
2018-05-12 23:37:24 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2e52fb3e{/metrics/json,null,AVAILABLE,@Spark}
2018-05-12 23:37:24 INFO  SharedState:54 - Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/home/fandev/workspace/samples/spark-structured-streaming2/spark-warehouse/').
2018-05-12 23:37:24 INFO  SharedState:54 - Warehouse path is 'file:/home/fandev/workspace/samples/spark-structured-streaming2/spark-warehouse/'.
2018-05-12 23:37:24 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@24a298a6{/SQL,null,AVAILABLE,@Spark}
2018-05-12 23:37:24 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@982bb90{/SQL/json,null,AVAILABLE,@Spark}
2018-05-12 23:37:24 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@57fae983{/SQL/execution,null,AVAILABLE,@Spark}
2018-05-12 23:37:24 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@4a29f290{/SQL/execution/json,null,AVAILABLE,@Spark}
2018-05-12 23:37:24 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@7a6ebe1e{/static/sql,null,AVAILABLE,@Spark}
2018-05-12 23:37:26 INFO  StateStoreCoordinatorRef:54 - Registered StateStoreCoordinator endpoint
Output to console
2018-05-12 23:37:29 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1000000.0 * 1000.0) as double) + -1.0E7)
2018-05-12 23:37:29 INFO  StreamingJoinHelper:54 - Condition Some((((clickAdId#26L = impressionAdId#22L) && (clickTime#18-T10000ms >= impressionTime#7-T10000ms)) && (clickTime#18-T10000ms <= cast(impressionTime#7-T10000ms + interval 10 seconds as timestamp)))) generated watermark constraint = 989999
2018-05-12 23:37:29 INFO  MicroBatchExecution:54 - Starting [id = f81d0864-a505-45c0-aee1-8bd905d13407, runId = cda27f86-f23a-4e61-af81-4993b63777fe]. Use file:///tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f to store the query checkpoint.
2018-05-12 23:37:30 INFO  RateStreamSource:54 - Start time: 1526193449950
2018-05-12 23:37:30 INFO  RateStreamSource:54 - Start time: 1526193450061
2018-05-12 23:37:30 INFO  MicroBatchExecution:54 - Starting new streaming query.
2018-05-12 23:37:30 INFO  MicroBatchExecution:54 - Committed offsets for batch 0. Metadata OffsetSeqMetadata(0,1526193450170,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 23:37:32 INFO  MemoryStore:54 - Block broadcast_0 stored as values in memory (estimated size 277.7 KB, free 366.0 MB)
2018-05-12 23:37:32 INFO  MemoryStore:54 - Block broadcast_0_piece0 stored as bytes in memory (estimated size 23.5 KB, free 366.0 MB)
2018-05-12 23:37:32 INFO  BlockManagerInfo:54 - Added broadcast_0_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.3 MB)
2018-05-12 23:37:32 INFO  SparkContext:54 - Created broadcast 0 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:32 INFO  MemoryStore:54 - Block broadcast_1 stored as values in memory (estimated size 277.7 KB, free 365.7 MB)
2018-05-12 23:37:32 INFO  MemoryStore:54 - Block broadcast_1_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.7 MB)
2018-05-12 23:37:32 INFO  BlockManagerInfo:54 - Added broadcast_1_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.3 MB)
2018-05-12 23:37:32 INFO  SparkContext:54 - Created broadcast 1 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:32 INFO  MemoryStore:54 - Block broadcast_2 stored as values in memory (estimated size 277.7 KB, free 365.4 MB)
2018-05-12 23:37:32 INFO  MemoryStore:54 - Block broadcast_2_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.4 MB)
2018-05-12 23:37:32 INFO  BlockManagerInfo:54 - Added broadcast_2_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.2 MB)
2018-05-12 23:37:32 INFO  SparkContext:54 - Created broadcast 2 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:32 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((0.0 * 1000.0) as double) + -1.0E7)
2018-05-12 23:37:32 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = -10001
2018-05-12 23:37:32 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((0.0 * 1000.0) as double)
2018-05-12 23:37:32 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = -1
2018-05-12 23:37:32 INFO  MemoryStore:54 - Block broadcast_3 stored as values in memory (estimated size 277.7 KB, free 365.1 MB)
2018-05-12 23:37:32 INFO  MemoryStore:54 - Block broadcast_3_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.1 MB)
2018-05-12 23:37:32 INFO  BlockManagerInfo:54 - Added broadcast_3_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.2 MB)
2018-05-12 23:37:32 INFO  SparkContext:54 - Created broadcast 3 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:32 INFO  MemoryStore:54 - Block broadcast_4 stored as values in memory (estimated size 277.7 KB, free 364.9 MB)
2018-05-12 23:37:32 INFO  MemoryStore:54 - Block broadcast_4_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.8 MB)
2018-05-12 23:37:32 INFO  BlockManagerInfo:54 - Added broadcast_4_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.2 MB)
2018-05-12 23:37:32 INFO  SparkContext:54 - Created broadcast 4 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:32 INFO  MemoryStore:54 - Block broadcast_5 stored as values in memory (estimated size 277.7 KB, free 364.6 MB)
2018-05-12 23:37:32 INFO  MemoryStore:54 - Block broadcast_5_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.5 MB)
2018-05-12 23:37:32 INFO  BlockManagerInfo:54 - Added broadcast_5_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.2 MB)
2018-05-12 23:37:32 INFO  SparkContext:54 - Created broadcast 5 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:33 INFO  CodeGenerator:54 - Code generated in 294.937768 ms
2018-05-12 23:37:33 INFO  CodeGenerator:54 - Code generated in 34.989265 ms
2018-05-12 23:37:33 INFO  CodeGenerator:54 - Code generated in 34.615098 ms
2018-05-12 23:37:33 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@5833ef97. The input RDD has 1 partitions.
2018-05-12 23:37:33 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:33 INFO  DAGScheduler:54 - Registering RDD 5 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:37:33 INFO  DAGScheduler:54 - Registering RDD 10 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:37:33 INFO  DAGScheduler:54 - Got job 0 (start at RateStreamStreamJoin.scala:53) with 1 output partitions
2018-05-12 23:37:33 INFO  DAGScheduler:54 - Final stage: ResultStage 2 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:37:33 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 0, ShuffleMapStage 1)
2018-05-12 23:37:33 INFO  DAGScheduler:54 - Missing parents: List()
2018-05-12 23:37:33 INFO  DAGScheduler:54 - Submitting ResultStage 2 (StateStoreAwareZipPartitionsRDD[12] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:37:33 INFO  MemoryStore:54 - Block broadcast_6 stored as values in memory (estimated size 16.2 KB, free 364.5 MB)
2018-05-12 23:37:33 INFO  MemoryStore:54 - Block broadcast_6_piece0 stored as bytes in memory (estimated size 7.9 KB, free 364.5 MB)
2018-05-12 23:37:33 INFO  BlockManagerInfo:54 - Added broadcast_6_piece0 in memory on 192.168.19.162:46196 (size: 7.9 KB, free: 366.2 MB)
2018-05-12 23:37:33 INFO  SparkContext:54 - Created broadcast 6 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:37:33 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 2 (StateStoreAwareZipPartitionsRDD[12] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:37:33 INFO  TaskSchedulerImpl:54 - Adding task set 2.0 with 1 tasks
2018-05-12 23:37:34 INFO  TaskSetManager:54 - Starting task 0.0 in stage 2.0 (TID 0, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 23:37:34 INFO  Executor:54 - Running task 0.0 in stage 2.0 (TID 0)
2018-05-12 23:37:34 INFO  Executor:54 - Fetching spark://192.168.19.162:46572/jars/spark-structured-streaming2-0.0.1-SNAPSHOT.jar with timestamp 1526193444014
2018-05-12 23:37:34 INFO  TransportClientFactory:267 - Successfully created connection to /192.168.19.162:46572 after 61 ms (0 ms spent in bootstraps)
2018-05-12 23:37:34 INFO  Utils:54 - Fetching spark://192.168.19.162:46572/jars/spark-structured-streaming2-0.0.1-SNAPSHOT.jar to /tmp/spark-b0fec0a0-b55a-4041-a3b0-df8abcdec58b/userFiles-4ca6cc39-5e00-4789-a044-3b9dca6927a5/fetchFileTemp4945288277318991889.tmp
2018-05-12 23:37:34 INFO  Executor:54 - Adding file:/tmp/spark-b0fec0a0-b55a-4041-a3b0-df8abcdec58b/userFiles-4ca6cc39-5e00-4789-a044-3b9dca6927a5/spark-structured-streaming2-0.0.1-SNAPSHOT.jar to class loader
2018-05-12 23:37:34 INFO  ShuffleBlockFetcherIterator:54 - Getting 0 non-empty blocks out of 0 blocks
2018-05-12 23:37:34 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 6 ms
2018-05-12 23:37:34 INFO  ShuffleBlockFetcherIterator:54 - Getting 0 non-empty blocks out of 0 blocks
2018-05-12 23:37:34 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2018-05-12 23:37:34 INFO  CodeGenerator:54 - Code generated in 48.755372 ms
2018-05-12 23:37:34 INFO  CodeGenerator:54 - Code generated in 12.568315 ms
2018-05-12 23:37:34 INFO  CodeGenerator:54 - Code generated in 15.268838 ms
2018-05-12 23:37:34 INFO  StateStore:54 - State Store maintenance task started
2018-05-12 23:37:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:37:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:37:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@341a7ef8
2018-05-12 23:37:34 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:37:34 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 0 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] for update
2018-05-12 23:37:34 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues)
2018-05-12 23:37:34 INFO  CodeGenerator:54 - Code generated in 12.883882 ms
2018-05-12 23:37:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:37:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:37:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@48e52c60
2018-05-12 23:37:34 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:37:34 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 0 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 23:37:34 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue)
2018-05-12 23:37:34 INFO  CodeGenerator:54 - Code generated in 8.31738 ms
2018-05-12 23:37:34 INFO  CodeGenerator:54 - Code generated in 11.547416 ms
2018-05-12 23:37:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:37:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:37:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@1c0313e
2018-05-12 23:37:34 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:37:34 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 0 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] for update
2018-05-12 23:37:34 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues)
2018-05-12 23:37:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:37:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:37:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@6c009e4e
2018-05-12 23:37:34 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:37:34 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 0 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 23:37:34 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue)
2018-05-12 23:37:34 INFO  CodeGenerator:54 - Code generated in 10.386841 ms
2018-05-12 23:37:34 INFO  CodeGenerator:54 - Code generated in 11.865125 ms
2018-05-12 23:37:34 INFO  CodeGenerator:54 - Code generated in 23.540671 ms
2018-05-12 23:37:34 INFO  HDFSBackedStateStoreProvider:54 - Committed version 1 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues/1.delta
2018-05-12 23:37:34 INFO  HDFSBackedStateStoreProvider:54 - Committed version 1 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue/1.delta
2018-05-12 23:37:34 INFO  HDFSBackedStateStoreProvider:54 - Committed version 1 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues/1.delta
2018-05-12 23:37:34 INFO  HDFSBackedStateStoreProvider:54 - Committed version 1 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue/1.delta
2018-05-12 23:37:34 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 23:37:34 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 23:37:34 INFO  Executor:54 - Finished task 0.0 in stage 2.0 (TID 0). 3029 bytes result sent to driver
2018-05-12 23:37:34 INFO  TaskSetManager:54 - Finished task 0.0 in stage 2.0 (TID 0) in 812 ms on localhost (executor driver) (1/1)
2018-05-12 23:37:34 INFO  TaskSchedulerImpl:54 - Removed TaskSet 2.0, whose tasks have all completed, from pool 
2018-05-12 23:37:34 INFO  DAGScheduler:54 - ResultStage 2 (start at RateStreamStreamJoin.scala:53) finished in 0.987 s
2018-05-12 23:37:34 INFO  DAGScheduler:54 - Job 0 finished: start at RateStreamStreamJoin.scala:53, took 1.128121 s
2018-05-12 23:37:34 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@5833ef97 is committing.
-------------------------------------------
Batch: 0
-------------------------------------------
2018-05-12 23:37:34 INFO  CodeGenerator:54 - Code generated in 23.128803 ms
+--------------+--------------+---------+---------+
|impressionAdId|impressionTime|clickAdId|clickTime|
+--------------+--------------+---------+---------+
+--------------+--------------+---------+---------+

2018-05-12 23:37:34 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@5833ef97 committed.
2018-05-12 23:37:35 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:35 INFO  DAGScheduler:54 - Job 1 finished: start at RateStreamStreamJoin.scala:53, took 0.000098 s
2018-05-12 23:37:35 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "f81d0864-a505-45c0-aee1-8bd905d13407",
  "runId" : "cda27f86-f23a-4e61-af81-4993b63777fe",
  "name" : null,
  "timestamp" : "2018-05-13T06:37:30.148Z",
  "batchId" : 0,
  "numInputRows" : 0,
  "processedRowsPerSecond" : 0.0,
  "durationMs" : {
    "addBatch" : 2474,
    "getBatch" : 56,
    "getOffset" : 0,
    "queryPlanning" : 2171,
    "triggerExecution" : 4863,
    "walCommit" : 109
  },
  "eventTime" : {
    "watermark" : "1970-01-01T00:00:00.000Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 0,
    "numRowsUpdated" : 0,
    "memoryUsedBytes" : 286
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : null,
    "endOffset" : 0,
    "numInputRows" : 0,
    "processedRowsPerSecond" : 0.0
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : null,
    "endOffset" : 0,
    "numInputRows" : 0,
    "processedRowsPerSecond" : 0.0
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@2736ef4e"
  }
}
2018-05-12 23:37:55 INFO  MicroBatchExecution:54 - Committed offsets for batch 1. Metadata OffsetSeqMetadata(0,1526193475010,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_7 stored as values in memory (estimated size 277.7 KB, free 364.2 MB)
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_7_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.2 MB)
2018-05-12 23:37:55 INFO  BlockManagerInfo:54 - Added broadcast_7_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 23:37:55 INFO  SparkContext:54 - Created broadcast 7 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_8 stored as values in memory (estimated size 277.7 KB, free 363.9 MB)
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_8_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.9 MB)
2018-05-12 23:37:55 INFO  BlockManagerInfo:54 - Added broadcast_8_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 23:37:55 INFO  SparkContext:54 - Created broadcast 8 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_9 stored as values in memory (estimated size 277.7 KB, free 363.7 MB)
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_9_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.6 MB)
2018-05-12 23:37:55 INFO  BlockManagerInfo:54 - Added broadcast_9_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 23:37:55 INFO  SparkContext:54 - Created broadcast 9 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:55 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((0.0 * 1000.0) as double) + -1.0E7)
2018-05-12 23:37:55 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = -10001
2018-05-12 23:37:55 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((0.0 * 1000.0) as double)
2018-05-12 23:37:55 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = -1
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_10 stored as values in memory (estimated size 277.7 KB, free 363.4 MB)
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_10_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.3 MB)
2018-05-12 23:37:55 INFO  BlockManagerInfo:54 - Added broadcast_10_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 23:37:55 INFO  SparkContext:54 - Created broadcast 10 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_11 stored as values in memory (estimated size 277.7 KB, free 363.1 MB)
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_11_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.0 MB)
2018-05-12 23:37:55 INFO  BlockManagerInfo:54 - Added broadcast_11_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:37:55 INFO  SparkContext:54 - Created broadcast 11 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_12 stored as values in memory (estimated size 277.7 KB, free 362.8 MB)
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_12_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.7 MB)
2018-05-12 23:37:55 INFO  BlockManagerInfo:54 - Added broadcast_12_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:37:55 INFO  SparkContext:54 - Created broadcast 12 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:55 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@4ac4950a. The input RDD has 1 partitions.
2018-05-12 23:37:55 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:55 INFO  DAGScheduler:54 - Registering RDD 29 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:37:55 INFO  DAGScheduler:54 - Registering RDD 24 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:37:55 INFO  DAGScheduler:54 - Got job 2 (start at RateStreamStreamJoin.scala:53) with 1 output partitions
2018-05-12 23:37:55 INFO  DAGScheduler:54 - Final stage: ResultStage 5 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:37:55 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 3, ShuffleMapStage 4)
2018-05-12 23:37:55 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 3, ShuffleMapStage 4)
2018-05-12 23:37:55 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 3 (MapPartitionsRDD[29] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_13 stored as values in memory (estimated size 15.5 KB, free 362.7 MB)
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_13_piece0 stored as bytes in memory (estimated size 7.4 KB, free 362.7 MB)
2018-05-12 23:37:55 INFO  BlockManagerInfo:54 - Added broadcast_13_piece0 in memory on 192.168.19.162:46196 (size: 7.4 KB, free: 366.0 MB)
2018-05-12 23:37:55 INFO  SparkContext:54 - Created broadcast 13 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:37:55 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 3 (MapPartitionsRDD[29] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:37:55 INFO  TaskSchedulerImpl:54 - Adding task set 3.0 with 1 tasks
2018-05-12 23:37:55 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 4 (MapPartitionsRDD[24] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_14 stored as values in memory (estimated size 11.8 KB, free 362.7 MB)
2018-05-12 23:37:55 INFO  MemoryStore:54 - Block broadcast_14_piece0 stored as bytes in memory (estimated size 6.0 KB, free 362.7 MB)
2018-05-12 23:37:55 INFO  BlockManagerInfo:54 - Added broadcast_14_piece0 in memory on 192.168.19.162:46196 (size: 6.0 KB, free: 366.0 MB)
2018-05-12 23:37:55 INFO  TaskSetManager:54 - Starting task 0.0 in stage 3.0 (TID 1, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:37:55 INFO  SparkContext:54 - Created broadcast 14 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:37:55 INFO  Executor:54 - Running task 0.0 in stage 3.0 (TID 1)
2018-05-12 23:37:55 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 4 (MapPartitionsRDD[24] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:37:55 INFO  TaskSchedulerImpl:54 - Adding task set 4.0 with 1 tasks
2018-05-12 23:37:55 INFO  TaskSetManager:54 - Starting task 0.0 in stage 4.0 (TID 2, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:37:55 INFO  Executor:54 - Running task 0.0 in stage 4.0 (TID 2)
2018-05-12 23:37:55 INFO  CodeGenerator:54 - Code generated in 31.775519 ms
2018-05-12 23:37:56 INFO  CodeGenerator:54 - Code generated in 32.46381 ms
2018-05-12 23:37:56 INFO  CodeGenerator:54 - Code generated in 28.269911 ms
2018-05-12 23:37:56 INFO  Executor:54 - Finished task 0.0 in stage 4.0 (TID 2). 1696 bytes result sent to driver
2018-05-12 23:37:56 INFO  Executor:54 - Finished task 0.0 in stage 3.0 (TID 1). 1820 bytes result sent to driver
2018-05-12 23:37:56 INFO  TaskSetManager:54 - Finished task 0.0 in stage 3.0 (TID 1) in 285 ms on localhost (executor driver) (1/1)
2018-05-12 23:37:56 INFO  TaskSchedulerImpl:54 - Removed TaskSet 3.0, whose tasks have all completed, from pool 
2018-05-12 23:37:56 INFO  TaskSetManager:54 - Finished task 0.0 in stage 4.0 (TID 2) in 254 ms on localhost (executor driver) (1/1)
2018-05-12 23:37:56 INFO  TaskSchedulerImpl:54 - Removed TaskSet 4.0, whose tasks have all completed, from pool 
2018-05-12 23:37:56 INFO  DAGScheduler:54 - ShuffleMapStage 3 (start at RateStreamStreamJoin.scala:53) finished in 0.327 s
2018-05-12 23:37:56 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:37:56 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 4)
2018-05-12 23:37:56 INFO  DAGScheduler:54 - waiting: Set(ResultStage 5)
2018-05-12 23:37:56 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:37:56 INFO  DAGScheduler:54 - ShuffleMapStage 4 (start at RateStreamStreamJoin.scala:53) finished in 0.299 s
2018-05-12 23:37:56 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:37:56 INFO  DAGScheduler:54 - running: Set()
2018-05-12 23:37:56 INFO  DAGScheduler:54 - waiting: Set(ResultStage 5)
2018-05-12 23:37:56 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:37:56 INFO  DAGScheduler:54 - Submitting ResultStage 5 (StateStoreAwareZipPartitionsRDD[31] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:37:56 INFO  MemoryStore:54 - Block broadcast_15 stored as values in memory (estimated size 18.0 KB, free 362.7 MB)
2018-05-12 23:37:56 INFO  MemoryStore:54 - Block broadcast_15_piece0 stored as bytes in memory (estimated size 8.9 KB, free 362.7 MB)
2018-05-12 23:37:56 INFO  BlockManagerInfo:54 - Added broadcast_15_piece0 in memory on 192.168.19.162:46196 (size: 8.9 KB, free: 366.0 MB)
2018-05-12 23:37:56 INFO  SparkContext:54 - Created broadcast 15 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:37:56 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 5 (StateStoreAwareZipPartitionsRDD[31] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:37:56 INFO  TaskSchedulerImpl:54 - Adding task set 5.0 with 1 tasks
2018-05-12 23:37:56 INFO  TaskSetManager:54 - Starting task 0.0 in stage 5.0 (TID 3, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 23:37:56 INFO  Executor:54 - Running task 0.0 in stage 5.0 (TID 3)
2018-05-12 23:37:56 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:37:56 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 3 ms
2018-05-12 23:37:56 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:37:56 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2018-05-12 23:37:56 INFO  StateStore:54 - Env is not null
2018-05-12 23:37:56 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:37:56 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@4c97e3c5
2018-05-12 23:37:56 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:37:56 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 1 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] for update
2018-05-12 23:37:56 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues)
2018-05-12 23:37:56 INFO  StateStore:54 - Env is not null
2018-05-12 23:37:56 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:37:56 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@51baf565
2018-05-12 23:37:56 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:37:56 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 1 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 23:37:56 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue)
2018-05-12 23:37:56 INFO  StateStore:54 - Env is not null
2018-05-12 23:37:56 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:37:56 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@2eb9fb2f
2018-05-12 23:37:56 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:37:56 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 1 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] for update
2018-05-12 23:37:56 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues)
2018-05-12 23:37:56 INFO  StateStore:54 - Env is not null
2018-05-12 23:37:56 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:37:56 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@42cb5836
2018-05-12 23:37:56 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:37:56 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 1 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 23:37:56 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue)
2018-05-12 23:37:56 INFO  CodeGenerator:54 - Code generated in 34.119349 ms
2018-05-12 23:37:56 INFO  HDFSBackedStateStoreProvider:54 - Committed version 2 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues/2.delta
2018-05-12 23:37:56 INFO  HDFSBackedStateStoreProvider:54 - Committed version 2 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue/2.delta
2018-05-12 23:37:56 INFO  HDFSBackedStateStoreProvider:54 - Committed version 2 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues/2.delta
2018-05-12 23:37:56 INFO  HDFSBackedStateStoreProvider:54 - Committed version 2 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue/2.delta
2018-05-12 23:37:56 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 23:37:56 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 23:37:56 INFO  Executor:54 - Finished task 0.0 in stage 5.0 (TID 3). 5206 bytes result sent to driver
2018-05-12 23:37:56 INFO  TaskSetManager:54 - Finished task 0.0 in stage 5.0 (TID 3) in 254 ms on localhost (executor driver) (1/1)
2018-05-12 23:37:56 INFO  TaskSchedulerImpl:54 - Removed TaskSet 5.0, whose tasks have all completed, from pool 
2018-05-12 23:37:56 INFO  DAGScheduler:54 - ResultStage 5 (start at RateStreamStreamJoin.scala:53) finished in 0.286 s
2018-05-12 23:37:56 INFO  DAGScheduler:54 - Job 2 finished: start at RateStreamStreamJoin.scala:53, took 0.663574 s
2018-05-12 23:37:56 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@4ac4950a is committing.
-------------------------------------------
Batch: 1
-------------------------------------------
2018-05-12 23:37:56 INFO  CodeGenerator:54 - Code generated in 28.481769 ms
+--------------+----------------------+---------+-----------------------+
|impressionAdId|impressionTime        |clickAdId|clickTime              |
+--------------+----------------------+---------+-----------------------+
|27            |2018-05-12 23:37:35.35|27       |2018-05-12 23:37:43.461|
|28            |2018-05-12 23:37:35.55|28       |2018-05-12 23:37:43.661|
|37            |2018-05-12 23:37:37.35|37       |2018-05-12 23:37:45.461|
|40            |2018-05-12 23:37:37.95|40       |2018-05-12 23:37:46.061|
|47            |2018-05-12 23:37:39.35|47       |2018-05-12 23:37:47.461|
|51            |2018-05-12 23:37:40.15|51       |2018-05-12 23:37:48.261|
|64            |2018-05-12 23:37:42.75|64       |2018-05-12 23:37:50.861|
|73            |2018-05-12 23:37:44.55|73       |2018-05-12 23:37:52.661|
|74            |2018-05-12 23:37:44.75|74       |2018-05-12 23:37:52.861|
+--------------+----------------------+---------+-----------------------+

2018-05-12 23:37:56 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@4ac4950a committed.
2018-05-12 23:37:56 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:37:56 INFO  DAGScheduler:54 - Job 3 finished: start at RateStreamStreamJoin.scala:53, took 0.000068 s
2018-05-12 23:37:56 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "f81d0864-a505-45c0-aee1-8bd905d13407",
  "runId" : "cda27f86-f23a-4e61-af81-4993b63777fe",
  "name" : null,
  "timestamp" : "2018-05-13T06:37:55.001Z",
  "batchId" : 1,
  "numInputRows" : 245,
  "inputRowsPerSecond" : 9.857964833219329,
  "processedRowsPerSecond" : 151.4215080346106,
  "durationMs" : {
    "addBatch" : 958,
    "getBatch" : 93,
    "getOffset" : 0,
    "queryPlanning" : 440,
    "triggerExecution" : 1618,
    "walCommit" : 113
  },
  "eventTime" : {
    "avg" : "2018-05-13T06:37:42.350Z",
    "max" : "2018-05-13T06:37:54.750Z",
    "min" : "2018-05-13T06:37:29.950Z",
    "watermark" : "1970-01-01T00:00:00.000Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 134,
    "numRowsUpdated" : 134,
    "memoryUsedBytes" : 51838
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 0,
    "endOffset" : 25,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0295738944996575,
    "processedRowsPerSecond" : 77.2558714462299
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 0,
    "endOffset" : 24,
    "numInputRows" : 120,
    "inputRowsPerSecond" : 4.8283909387196715,
    "processedRowsPerSecond" : 74.1656365883807
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@2736ef4e"
  }
}
2018-05-12 23:38:20 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526193462861 ms
2018-05-12 23:38:20 INFO  MicroBatchExecution:54 - Committed offsets for batch 2. Metadata OffsetSeqMetadata(1526193462861,1526193500026,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 23:38:20 INFO  MemoryStore:54 - Block broadcast_16 stored as values in memory (estimated size 277.7 KB, free 362.4 MB)
2018-05-12 23:38:20 INFO  MemoryStore:54 - Block broadcast_16_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.4 MB)
2018-05-12 23:38:20 INFO  BlockManagerInfo:54 - Added broadcast_16_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:38:20 INFO  SparkContext:54 - Created broadcast 16 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:20 INFO  MemoryStore:54 - Block broadcast_17 stored as values in memory (estimated size 277.7 KB, free 362.1 MB)
2018-05-12 23:38:20 INFO  MemoryStore:54 - Block broadcast_17_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.1 MB)
2018-05-12 23:38:20 INFO  BlockManagerInfo:54 - Added broadcast_17_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:38:20 INFO  SparkContext:54 - Created broadcast 17 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:20 INFO  MemoryStore:54 - Block broadcast_18 stored as values in memory (estimated size 277.7 KB, free 361.8 MB)
2018-05-12 23:38:20 INFO  MemoryStore:54 - Block broadcast_18_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.8 MB)
2018-05-12 23:38:20 INFO  BlockManagerInfo:54 - Added broadcast_18_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:38:20 INFO  SparkContext:54 - Created broadcast 18 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:20 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526193462861E12 * 1000.0) as double) + -1.0E7)
2018-05-12 23:38:20 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526193452860
2018-05-12 23:38:20 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526193462861E12 * 1000.0) as double)
2018-05-12 23:38:20 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526193462860
2018-05-12 23:38:20 INFO  MemoryStore:54 - Block broadcast_19 stored as values in memory (estimated size 277.7 KB, free 361.5 MB)
2018-05-12 23:38:20 INFO  MemoryStore:54 - Block broadcast_19_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.5 MB)
2018-05-12 23:38:20 INFO  BlockManagerInfo:54 - Added broadcast_19_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:38:20 INFO  SparkContext:54 - Created broadcast 19 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:20 INFO  MemoryStore:54 - Block broadcast_20 stored as values in memory (estimated size 277.7 KB, free 361.2 MB)
2018-05-12 23:38:20 INFO  MemoryStore:54 - Block broadcast_20_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.2 MB)
2018-05-12 23:38:20 INFO  BlockManagerInfo:54 - Added broadcast_20_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:38:20 INFO  SparkContext:54 - Created broadcast 20 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:20 INFO  MemoryStore:54 - Block broadcast_21 stored as values in memory (estimated size 277.7 KB, free 360.9 MB)
2018-05-12 23:38:20 INFO  MemoryStore:54 - Block broadcast_21_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.9 MB)
2018-05-12 23:38:20 INFO  BlockManagerInfo:54 - Added broadcast_21_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:38:20 INFO  SparkContext:54 - Created broadcast 21 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:21 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@3343fdfd. The input RDD has 1 partitions.
2018-05-12 23:38:21 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:21 INFO  DAGScheduler:54 - Registering RDD 48 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:38:21 INFO  DAGScheduler:54 - Registering RDD 43 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:38:21 INFO  DAGScheduler:54 - Got job 4 (start at RateStreamStreamJoin.scala:53) with 1 output partitions
2018-05-12 23:38:21 INFO  DAGScheduler:54 - Final stage: ResultStage 8 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:38:21 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 6, ShuffleMapStage 7)
2018-05-12 23:38:21 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 6, ShuffleMapStage 7)
2018-05-12 23:38:21 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 6 (MapPartitionsRDD[48] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:38:21 INFO  MemoryStore:54 - Block broadcast_22 stored as values in memory (estimated size 15.5 KB, free 360.9 MB)
2018-05-12 23:38:21 INFO  MemoryStore:54 - Block broadcast_22_piece0 stored as bytes in memory (estimated size 7.4 KB, free 360.9 MB)
2018-05-12 23:38:21 INFO  BlockManagerInfo:54 - Added broadcast_22_piece0 in memory on 192.168.19.162:46196 (size: 7.4 KB, free: 365.9 MB)
2018-05-12 23:38:21 INFO  SparkContext:54 - Created broadcast 22 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:38:21 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 6 (MapPartitionsRDD[48] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:38:21 INFO  TaskSchedulerImpl:54 - Adding task set 6.0 with 1 tasks
2018-05-12 23:38:21 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 7 (MapPartitionsRDD[43] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:38:21 INFO  TaskSetManager:54 - Starting task 0.0 in stage 6.0 (TID 4, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:38:21 INFO  Executor:54 - Running task 0.0 in stage 6.0 (TID 4)
2018-05-12 23:38:21 INFO  MemoryStore:54 - Block broadcast_23 stored as values in memory (estimated size 11.8 KB, free 360.9 MB)
2018-05-12 23:38:21 INFO  MemoryStore:54 - Block broadcast_23_piece0 stored as bytes in memory (estimated size 6.0 KB, free 360.9 MB)
2018-05-12 23:38:21 INFO  BlockManagerInfo:54 - Added broadcast_23_piece0 in memory on 192.168.19.162:46196 (size: 6.0 KB, free: 365.8 MB)
2018-05-12 23:38:21 INFO  SparkContext:54 - Created broadcast 23 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:38:21 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 7 (MapPartitionsRDD[43] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:38:21 INFO  TaskSchedulerImpl:54 - Adding task set 7.0 with 1 tasks
2018-05-12 23:38:21 INFO  TaskSetManager:54 - Starting task 0.0 in stage 7.0 (TID 5, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:38:21 INFO  Executor:54 - Running task 0.0 in stage 7.0 (TID 5)
2018-05-12 23:38:21 INFO  Executor:54 - Finished task 0.0 in stage 6.0 (TID 4). 1777 bytes result sent to driver
2018-05-12 23:38:21 INFO  TaskSetManager:54 - Finished task 0.0 in stage 6.0 (TID 4) in 30 ms on localhost (executor driver) (1/1)
2018-05-12 23:38:21 INFO  TaskSchedulerImpl:54 - Removed TaskSet 6.0, whose tasks have all completed, from pool 
2018-05-12 23:38:21 INFO  DAGScheduler:54 - ShuffleMapStage 6 (start at RateStreamStreamJoin.scala:53) finished in 0.053 s
2018-05-12 23:38:21 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:38:21 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 7)
2018-05-12 23:38:21 INFO  DAGScheduler:54 - waiting: Set(ResultStage 8)
2018-05-12 23:38:21 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:38:21 INFO  Executor:54 - Finished task 0.0 in stage 7.0 (TID 5). 1653 bytes result sent to driver
2018-05-12 23:38:21 INFO  TaskSetManager:54 - Finished task 0.0 in stage 7.0 (TID 5) in 38 ms on localhost (executor driver) (1/1)
2018-05-12 23:38:21 INFO  TaskSchedulerImpl:54 - Removed TaskSet 7.0, whose tasks have all completed, from pool 
2018-05-12 23:38:21 INFO  DAGScheduler:54 - ShuffleMapStage 7 (start at RateStreamStreamJoin.scala:53) finished in 0.062 s
2018-05-12 23:38:21 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:38:21 INFO  DAGScheduler:54 - running: Set()
2018-05-12 23:38:21 INFO  DAGScheduler:54 - waiting: Set(ResultStage 8)
2018-05-12 23:38:21 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:38:21 INFO  DAGScheduler:54 - Submitting ResultStage 8 (StateStoreAwareZipPartitionsRDD[50] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:38:21 INFO  MemoryStore:54 - Block broadcast_24 stored as values in memory (estimated size 18.0 KB, free 360.9 MB)
2018-05-12 23:38:21 INFO  MemoryStore:54 - Block broadcast_24_piece0 stored as bytes in memory (estimated size 8.9 KB, free 360.8 MB)
2018-05-12 23:38:21 INFO  BlockManagerInfo:54 - Added broadcast_24_piece0 in memory on 192.168.19.162:46196 (size: 8.9 KB, free: 365.8 MB)
2018-05-12 23:38:21 INFO  SparkContext:54 - Created broadcast 24 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:38:21 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 8 (StateStoreAwareZipPartitionsRDD[50] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:38:21 INFO  TaskSchedulerImpl:54 - Adding task set 8.0 with 1 tasks
2018-05-12 23:38:21 INFO  TaskSetManager:54 - Starting task 0.0 in stage 8.0 (TID 6, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 23:38:21 INFO  Executor:54 - Running task 0.0 in stage 8.0 (TID 6)
2018-05-12 23:38:21 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:38:21 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 23:38:21 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:38:21 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 23:38:21 INFO  StateStore:54 - Env is not null
2018-05-12 23:38:21 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:38:21 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@9d85ac
2018-05-12 23:38:21 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:38:21 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 2 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] for update
2018-05-12 23:38:21 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues)
2018-05-12 23:38:21 INFO  StateStore:54 - Env is not null
2018-05-12 23:38:21 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:38:21 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@67f72dea
2018-05-12 23:38:21 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:38:21 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 2 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 23:38:21 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue)
2018-05-12 23:38:21 INFO  CodeGenerator:54 - Code generated in 11.933027 ms
2018-05-12 23:38:21 INFO  StateStore:54 - Env is not null
2018-05-12 23:38:21 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:38:21 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@639f1efe
2018-05-12 23:38:21 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:38:21 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 2 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] for update
2018-05-12 23:38:21 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues)
2018-05-12 23:38:21 INFO  StateStore:54 - Env is not null
2018-05-12 23:38:21 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:38:21 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@18d2dbc8
2018-05-12 23:38:21 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:38:21 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 2 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 23:38:21 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue)
2018-05-12 23:38:21 INFO  CodeGenerator:54 - Code generated in 13.826045 ms
2018-05-12 23:38:21 INFO  CodeGenerator:54 - Code generated in 10.78413 ms
2018-05-12 23:38:21 INFO  HDFSBackedStateStoreProvider:54 - Committed version 3 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues/3.delta
2018-05-12 23:38:21 INFO  HDFSBackedStateStoreProvider:54 - Committed version 3 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue/3.delta
2018-05-12 23:38:21 INFO  HDFSBackedStateStoreProvider:54 - Committed version 3 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues/3.delta
2018-05-12 23:38:21 INFO  HDFSBackedStateStoreProvider:54 - Committed version 3 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue/3.delta
2018-05-12 23:38:21 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 23:38:21 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 23:38:21 INFO  Executor:54 - Finished task 0.0 in stage 8.0 (TID 6). 6408 bytes result sent to driver
2018-05-12 23:38:21 INFO  TaskSetManager:54 - Finished task 0.0 in stage 8.0 (TID 6) in 203 ms on localhost (executor driver) (1/1)
2018-05-12 23:38:21 INFO  TaskSchedulerImpl:54 - Removed TaskSet 8.0, whose tasks have all completed, from pool 
2018-05-12 23:38:21 INFO  DAGScheduler:54 - ResultStage 8 (start at RateStreamStreamJoin.scala:53) finished in 0.228 s
2018-05-12 23:38:21 INFO  DAGScheduler:54 - Job 4 finished: start at RateStreamStreamJoin.scala:53, took 0.334313 s
2018-05-12 23:38:21 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@3343fdfd is committing.
-------------------------------------------
Batch: 2
-------------------------------------------
+--------------+----------------------+---------+-----------------------+
|impressionAdId|impressionTime        |clickAdId|clickTime              |
+--------------+----------------------+---------+-----------------------+
|81            |2018-05-12 23:37:46.15|81       |2018-05-12 23:37:54.261|
|84            |2018-05-12 23:37:46.75|84       |2018-05-12 23:37:54.861|
|111           |2018-05-12 23:37:52.15|111      |2018-05-12 23:38:00.261|
|147           |2018-05-12 23:37:59.35|147      |2018-05-12 23:38:07.461|
|148           |2018-05-12 23:37:59.55|148      |2018-05-12 23:38:07.661|
|157           |2018-05-12 23:38:01.35|157      |2018-05-12 23:38:09.461|
|160           |2018-05-12 23:38:01.95|160      |2018-05-12 23:38:10.061|
|167           |2018-05-12 23:38:03.35|167      |2018-05-12 23:38:11.461|
|171           |2018-05-12 23:38:04.15|171      |2018-05-12 23:38:12.261|
|184           |2018-05-12 23:38:06.75|184      |2018-05-12 23:38:14.861|
|193           |2018-05-12 23:38:08.55|193      |2018-05-12 23:38:16.661|
|194           |2018-05-12 23:38:08.75|194      |2018-05-12 23:38:16.861|
|8             |2018-05-12 23:37:31.55|null     |null                   |
|2             |2018-05-12 23:37:30.35|null     |null                   |
|12            |2018-05-12 23:37:32.35|null     |null                   |
|4             |2018-05-12 23:37:30.75|null     |null                   |
|0             |2018-05-12 23:37:29.95|null     |null                   |
|1             |2018-05-12 23:37:30.15|null     |null                   |
|13            |2018-05-12 23:37:32.55|null     |null                   |
|11            |2018-05-12 23:37:32.15|null     |null                   |
|14            |2018-05-12 23:37:32.75|null     |null                   |
|10            |2018-05-12 23:37:31.95|null     |null                   |
|7             |2018-05-12 23:37:31.35|null     |null                   |
|3             |2018-05-12 23:37:30.55|null     |null                   |
|9             |2018-05-12 23:37:31.75|null     |null                   |
|5             |2018-05-12 23:37:30.95|null     |null                   |
|6             |2018-05-12 23:37:31.15|null     |null                   |
+--------------+----------------------+---------+-----------------------+

2018-05-12 23:38:21 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@3343fdfd committed.
2018-05-12 23:38:21 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:21 INFO  DAGScheduler:54 - Job 5 finished: start at RateStreamStreamJoin.scala:53, took 0.001085 s
2018-05-12 23:38:21 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "f81d0864-a505-45c0-aee1-8bd905d13407",
  "runId" : "cda27f86-f23a-4e61-af81-4993b63777fe",
  "name" : null,
  "timestamp" : "2018-05-13T06:38:20.005Z",
  "batchId" : 2,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 9.998400255959046,
  "processedRowsPerSecond" : 170.06802721088437,
  "durationMs" : {
    "addBatch" : 745,
    "getBatch" : 63,
    "getOffset" : 0,
    "queryPlanning" : 529,
    "triggerExecution" : 1470,
    "walCommit" : 107
  },
  "eventTime" : {
    "avg" : "2018-05-13T06:38:07.350Z",
    "max" : "2018-05-13T06:38:19.750Z",
    "min" : "2018-05-13T06:37:54.950Z",
    "watermark" : "2018-05-13T06:37:42.861Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 256,
    "numRowsUpdated" : 137,
    "memoryUsedBytes" : 97598
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 25,
    "endOffset" : 50,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 4.999200127979523,
    "processedRowsPerSecond" : 85.03401360544218
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 24,
    "endOffset" : 49,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 4.999200127979523,
    "processedRowsPerSecond" : 85.03401360544218
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@2736ef4e"
  }
}
2018-05-12 23:38:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:38:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:38:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@6e7f931d
2018-05-12 23:38:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:38:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:38:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@4a050f8e
2018-05-12 23:38:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:38:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:38:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@54acdedc
2018-05-12 23:38:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:38:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:38:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@1e1048f8
2018-05-12 23:38:45 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526193486861 ms
2018-05-12 23:38:45 INFO  MicroBatchExecution:54 - Committed offsets for batch 3. Metadata OffsetSeqMetadata(1526193486861,1526193525013,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_25 stored as values in memory (estimated size 277.7 KB, free 360.6 MB)
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_25_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.6 MB)
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Added broadcast_25_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:38:45 INFO  SparkContext:54 - Created broadcast 25 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_26 stored as values in memory (estimated size 277.7 KB, free 360.3 MB)
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_26_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.3 MB)
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Added broadcast_26_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:38:45 INFO  SparkContext:54 - Created broadcast 26 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_27 stored as values in memory (estimated size 277.7 KB, free 360.0 MB)
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_27_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.0 MB)
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Added broadcast_27_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:38:45 INFO  SparkContext:54 - Created broadcast 27 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:45 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526193486861E12 * 1000.0) as double) + -1.0E7)
2018-05-12 23:38:45 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526193476860
2018-05-12 23:38:45 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526193486861E12 * 1000.0) as double)
2018-05-12 23:38:45 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526193486860
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_28 stored as values in memory (estimated size 277.7 KB, free 359.7 MB)
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_28_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.7 MB)
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Added broadcast_28_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 23:38:45 INFO  SparkContext:54 - Created broadcast 28 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 135
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_29 stored as values in memory (estimated size 277.7 KB, free 359.4 MB)
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_29_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.4 MB)
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Added broadcast_29_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 23:38:45 INFO  SparkContext:54 - Created broadcast 29 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_24_piece0 on 192.168.19.162:46196 in memory (size: 8.9 KB, free: 365.7 MB)
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_30 stored as values in memory (estimated size 277.7 KB, free 359.1 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 159
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 161
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 193
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 131
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 63
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 155
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 91
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 227
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 150
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 154
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 73
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 158
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned shuffle 4
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 98
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 212
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 208
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 94
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_30_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.1 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 247
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 223
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 244
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 172
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Added broadcast_30_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 114
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 229
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 142
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 198
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 56
2018-05-12 23:38:45 INFO  SparkContext:54 - Created broadcast 30 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 110
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 152
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 196
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 165
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 53
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 149
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 183
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 92
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 80
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 69
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 49
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 77
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 220
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_18_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.7 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 167
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned shuffle 5
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 86
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 125
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 130
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 209
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 180
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 214
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 104
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 234
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 213
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 108
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_23_piece0 on 192.168.19.162:46196 in memory (size: 6.0 KB, free: 365.7 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 59
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 221
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_15_piece0 on 192.168.19.162:46196 in memory (size: 8.9 KB, free: 365.7 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 224
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 97
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_26_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 127
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 134
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 192
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_25_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 215
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 118
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 246
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 148
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 83
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 186
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 151
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 237
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 217
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 238
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 121
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 174
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 182
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 242
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 57
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 115
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 241
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 50
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 188
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 235
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_12_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 88
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 218
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 124
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_20_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 60
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 111
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 147
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 89
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_7_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 222
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 202
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 176
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 243
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 64
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 178
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 236
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 160
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 184
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 72
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 129
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 177
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 197
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 146
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_8_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 103
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 123
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 79
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_22_piece0 on 192.168.19.162:46196 in memory (size: 7.4 KB, free: 365.9 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 113
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 101
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 126
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 225
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 136
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 195
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 117
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 116
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned shuffle 3
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_21_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 139
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 76
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 66
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 78
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 74
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 109
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_9_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 75
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 163
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 67
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 119
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 199
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 203
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 175
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 128
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 171
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 70
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 187
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_13_piece0 on 192.168.19.162:46196 in memory (size: 7.4 KB, free: 365.9 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 54
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 190
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 112
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 194
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 61
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 170
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 232
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 85
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 68
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 230
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 106
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 179
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 82
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 207
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 216
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 239
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 120
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 144
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 143
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 204
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 191
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 240
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 137
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 102
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 122
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 141
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 169
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 58
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 71
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 157
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 181
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 100
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 228
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 52
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 205
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 185
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 200
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 107
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 133
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 248
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_14_piece0 on 192.168.19.162:46196 in memory (size: 6.0 KB, free: 365.9 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 84
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 168
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned shuffle 2
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 210
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 211
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 231
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 140
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 233
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 81
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_11_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 166
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 189
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 99
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 206
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 138
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 156
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 55
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 65
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 153
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 145
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 96
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 219
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_17_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 51
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 105
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 90
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 245
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 162
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 201
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 93
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_10_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 164
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 226
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 62
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_16_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 87
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Removed broadcast_19_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 366.1 MB)
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 95
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 173
2018-05-12 23:38:45 INFO  ContextCleaner:54 - Cleaned accumulator 132
2018-05-12 23:38:45 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@61685874. The input RDD has 1 partitions.
2018-05-12 23:38:45 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:45 INFO  DAGScheduler:54 - Registering RDD 62 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:38:45 INFO  DAGScheduler:54 - Registering RDD 67 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:38:45 INFO  DAGScheduler:54 - Got job 6 (start at RateStreamStreamJoin.scala:53) with 1 output partitions
2018-05-12 23:38:45 INFO  DAGScheduler:54 - Final stage: ResultStage 11 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:38:45 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 9, ShuffleMapStage 10)
2018-05-12 23:38:45 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 9, ShuffleMapStage 10)
2018-05-12 23:38:45 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 9 (MapPartitionsRDD[62] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_31 stored as values in memory (estimated size 11.8 KB, free 363.3 MB)
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_31_piece0 stored as bytes in memory (estimated size 6.0 KB, free 363.3 MB)
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Added broadcast_31_piece0 in memory on 192.168.19.162:46196 (size: 6.0 KB, free: 366.1 MB)
2018-05-12 23:38:45 INFO  SparkContext:54 - Created broadcast 31 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:38:45 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 9 (MapPartitionsRDD[62] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:38:45 INFO  TaskSchedulerImpl:54 - Adding task set 9.0 with 1 tasks
2018-05-12 23:38:45 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 10 (MapPartitionsRDD[67] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:38:45 INFO  TaskSetManager:54 - Starting task 0.0 in stage 9.0 (TID 7, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:38:45 INFO  Executor:54 - Running task 0.0 in stage 9.0 (TID 7)
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_32 stored as values in memory (estimated size 15.5 KB, free 363.3 MB)
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_32_piece0 stored as bytes in memory (estimated size 7.4 KB, free 363.3 MB)
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Added broadcast_32_piece0 in memory on 192.168.19.162:46196 (size: 7.4 KB, free: 366.0 MB)
2018-05-12 23:38:45 INFO  SparkContext:54 - Created broadcast 32 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:38:45 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 10 (MapPartitionsRDD[67] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:38:45 INFO  TaskSchedulerImpl:54 - Adding task set 10.0 with 1 tasks
2018-05-12 23:38:45 INFO  TaskSetManager:54 - Starting task 0.0 in stage 10.0 (TID 8, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:38:45 INFO  Executor:54 - Running task 0.0 in stage 10.0 (TID 8)
2018-05-12 23:38:45 INFO  Executor:54 - Finished task 0.0 in stage 9.0 (TID 7). 1653 bytes result sent to driver
2018-05-12 23:38:45 INFO  TaskSetManager:54 - Finished task 0.0 in stage 9.0 (TID 7) in 40 ms on localhost (executor driver) (1/1)
2018-05-12 23:38:45 INFO  TaskSchedulerImpl:54 - Removed TaskSet 9.0, whose tasks have all completed, from pool 
2018-05-12 23:38:45 INFO  Executor:54 - Finished task 0.0 in stage 10.0 (TID 8). 1777 bytes result sent to driver
2018-05-12 23:38:45 INFO  DAGScheduler:54 - ShuffleMapStage 9 (start at RateStreamStreamJoin.scala:53) finished in 0.056 s
2018-05-12 23:38:45 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:38:45 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 10)
2018-05-12 23:38:45 INFO  DAGScheduler:54 - waiting: Set(ResultStage 11)
2018-05-12 23:38:45 INFO  TaskSetManager:54 - Finished task 0.0 in stage 10.0 (TID 8) in 28 ms on localhost (executor driver) (1/1)
2018-05-12 23:38:45 INFO  TaskSchedulerImpl:54 - Removed TaskSet 10.0, whose tasks have all completed, from pool 
2018-05-12 23:38:45 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:38:45 INFO  DAGScheduler:54 - ShuffleMapStage 10 (start at RateStreamStreamJoin.scala:53) finished in 0.045 s
2018-05-12 23:38:45 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:38:45 INFO  DAGScheduler:54 - running: Set()
2018-05-12 23:38:45 INFO  DAGScheduler:54 - waiting: Set(ResultStage 11)
2018-05-12 23:38:45 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:38:45 INFO  DAGScheduler:54 - Submitting ResultStage 11 (StateStoreAwareZipPartitionsRDD[69] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_33 stored as values in memory (estimated size 18.0 KB, free 363.3 MB)
2018-05-12 23:38:45 INFO  MemoryStore:54 - Block broadcast_33_piece0 stored as bytes in memory (estimated size 8.9 KB, free 363.3 MB)
2018-05-12 23:38:45 INFO  BlockManagerInfo:54 - Added broadcast_33_piece0 in memory on 192.168.19.162:46196 (size: 8.9 KB, free: 366.0 MB)
2018-05-12 23:38:45 INFO  SparkContext:54 - Created broadcast 33 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:38:45 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 11 (StateStoreAwareZipPartitionsRDD[69] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:38:45 INFO  TaskSchedulerImpl:54 - Adding task set 11.0 with 1 tasks
2018-05-12 23:38:45 INFO  TaskSetManager:54 - Starting task 0.0 in stage 11.0 (TID 9, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 23:38:45 INFO  Executor:54 - Running task 0.0 in stage 11.0 (TID 9)
2018-05-12 23:38:45 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:38:45 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 23:38:45 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:38:45 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 23:38:45 INFO  StateStore:54 - Env is not null
2018-05-12 23:38:45 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:38:45 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@82b0cc3
2018-05-12 23:38:45 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:38:45 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 3 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] for update
2018-05-12 23:38:45 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues)
2018-05-12 23:38:45 INFO  StateStore:54 - Env is not null
2018-05-12 23:38:45 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:38:45 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@5c574b0b
2018-05-12 23:38:45 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:38:45 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 3 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 23:38:45 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue)
2018-05-12 23:38:45 INFO  CodeGenerator:54 - Code generated in 15.574034 ms
2018-05-12 23:38:45 INFO  StateStore:54 - Env is not null
2018-05-12 23:38:45 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:38:45 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@2f2999ed
2018-05-12 23:38:45 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:38:45 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 3 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] for update
2018-05-12 23:38:45 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues)
2018-05-12 23:38:45 INFO  StateStore:54 - Env is not null
2018-05-12 23:38:45 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:38:45 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@638d79fe
2018-05-12 23:38:45 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:38:45 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 3 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 23:38:45 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue)
2018-05-12 23:38:45 INFO  CodeGenerator:54 - Code generated in 21.574761 ms
2018-05-12 23:38:45 INFO  CodeGenerator:54 - Code generated in 8.89185 ms
2018-05-12 23:38:46 INFO  HDFSBackedStateStoreProvider:54 - Committed version 4 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues/4.delta
2018-05-12 23:38:46 INFO  HDFSBackedStateStoreProvider:54 - Committed version 4 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue/4.delta
2018-05-12 23:38:46 INFO  HDFSBackedStateStoreProvider:54 - Committed version 4 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues/4.delta
2018-05-12 23:38:46 INFO  HDFSBackedStateStoreProvider:54 - Committed version 4 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue/4.delta
2018-05-12 23:38:46 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 23:38:46 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 23:38:46 INFO  Executor:54 - Finished task 0.0 in stage 11.0 (TID 9). 11854 bytes result sent to driver
2018-05-12 23:38:46 INFO  TaskSetManager:54 - Finished task 0.0 in stage 11.0 (TID 9) in 212 ms on localhost (executor driver) (1/1)
2018-05-12 23:38:46 INFO  TaskSchedulerImpl:54 - Removed TaskSet 11.0, whose tasks have all completed, from pool 
2018-05-12 23:38:46 INFO  DAGScheduler:54 - ResultStage 11 (start at RateStreamStreamJoin.scala:53) finished in 0.237 s
2018-05-12 23:38:46 INFO  DAGScheduler:54 - Job 6 finished: start at RateStreamStreamJoin.scala:53, took 0.311887 s
2018-05-12 23:38:46 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@61685874 is committing.
-------------------------------------------
Batch: 3
-------------------------------------------
+--------------+----------------------+---------+-----------------------+
|impressionAdId|impressionTime        |clickAdId|clickTime              |
+--------------+----------------------+---------+-----------------------+
|206           |2018-05-12 23:38:11.15|206      |2018-05-12 23:38:19.261|
|209           |2018-05-12 23:38:11.75|209      |2018-05-12 23:38:19.861|
|236           |2018-05-12 23:38:17.15|236      |2018-05-12 23:38:25.261|
|272           |2018-05-12 23:38:24.35|272      |2018-05-12 23:38:32.461|
|273           |2018-05-12 23:38:24.55|273      |2018-05-12 23:38:32.661|
|282           |2018-05-12 23:38:26.35|282      |2018-05-12 23:38:34.461|
|285           |2018-05-12 23:38:26.95|285      |2018-05-12 23:38:35.061|
|292           |2018-05-12 23:38:28.35|292      |2018-05-12 23:38:36.461|
|296           |2018-05-12 23:38:29.15|296      |2018-05-12 23:38:37.261|
|309           |2018-05-12 23:38:31.75|309      |2018-05-12 23:38:39.861|
|318           |2018-05-12 23:38:33.55|318      |2018-05-12 23:38:41.661|
|319           |2018-05-12 23:38:33.75|319      |2018-05-12 23:38:41.861|
|70            |2018-05-12 23:37:43.95|null     |null                   |
|63            |2018-05-12 23:37:42.55|null     |null                   |
|113           |2018-05-12 23:37:52.55|null     |null                   |
|54            |2018-05-12 23:37:40.75|null     |null                   |
|127           |2018-05-12 23:37:55.35|null     |null                   |
|21            |2018-05-12 23:37:34.15|null     |null                   |
|114           |2018-05-12 23:37:52.75|null     |null                   |
|133           |2018-05-12 23:37:56.55|null     |null                   |
|100           |2018-05-12 23:37:49.95|null     |null                   |
|57            |2018-05-12 23:37:41.35|null     |null                   |
|24            |2018-05-12 23:37:34.75|null     |null                   |
|25            |2018-05-12 23:37:34.95|null     |null                   |
|95            |2018-05-12 23:37:48.95|null     |null                   |
|82            |2018-05-12 23:37:46.35|null     |null                   |
|60            |2018-05-12 23:37:41.95|null     |null                   |
|109           |2018-05-12 23:37:51.75|null     |null                   |
|123           |2018-05-12 23:37:54.55|null     |null                   |
|32            |2018-05-12 23:37:36.35|null     |null                   |
|68            |2018-05-12 23:37:43.55|null     |null                   |
|65            |2018-05-12 23:37:42.95|null     |null                   |
|56            |2018-05-12 23:37:41.15|null     |null                   |
|99            |2018-05-12 23:37:49.75|null     |null                   |
|35            |2018-05-12 23:37:36.95|null     |null                   |
|20            |2018-05-12 23:37:33.95|null     |null                   |
|104           |2018-05-12 23:37:50.75|null     |null                   |
|128           |2018-05-12 23:37:55.55|null     |null                   |
|86            |2018-05-12 23:37:47.15|null     |null                   |
|15            |2018-05-12 23:37:32.95|null     |null                   |
|124           |2018-05-12 23:37:54.75|null     |null                   |
|66            |2018-05-12 23:37:43.15|null     |null                   |
|126           |2018-05-12 23:37:55.15|null     |null                   |
|79            |2018-05-12 23:37:45.75|null     |null                   |
|120           |2018-05-12 23:37:53.95|null     |null                   |
|121           |2018-05-12 23:37:54.15|null     |null                   |
|30            |2018-05-12 23:37:35.95|null     |null                   |
|76            |2018-05-12 23:37:45.15|null     |null                   |
|103           |2018-05-12 23:37:50.55|null     |null                   |
|129           |2018-05-12 23:37:55.75|null     |null                   |
+--------------+----------------------+---------+-----------------------+
only showing top 50 rows

2018-05-12 23:38:46 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@61685874 committed.
2018-05-12 23:38:46 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:38:46 INFO  DAGScheduler:54 - Job 7 finished: start at RateStreamStreamJoin.scala:53, took 0.000054 s
2018-05-12 23:38:46 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "f81d0864-a505-45c0-aee1-8bd905d13407",
  "runId" : "cda27f86-f23a-4e61-af81-4993b63777fe",
  "name" : null,
  "timestamp" : "2018-05-13T06:38:45.002Z",
  "batchId" : 3,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 10.001200144017282,
  "processedRowsPerSecond" : 217.58050478677112,
  "durationMs" : {
    "addBatch" : 517,
    "getBatch" : 57,
    "getOffset" : 1,
    "queryPlanning" : 398,
    "triggerExecution" : 1149,
    "walCommit" : 161
  },
  "eventTime" : {
    "avg" : "2018-05-13T06:38:32.350Z",
    "max" : "2018-05-13T06:38:44.750Z",
    "min" : "2018-05-13T06:38:19.950Z",
    "watermark" : "2018-05-13T06:38:06.861Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 261,
    "numRowsUpdated" : 137,
    "memoryUsedBytes" : 98766
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 50,
    "endOffset" : 75,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.000600072008641,
    "processedRowsPerSecond" : 108.79025239338556
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 49,
    "endOffset" : 74,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.000600072008641,
    "processedRowsPerSecond" : 108.79025239338556
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@2736ef4e"
  }
}
2018-05-12 23:39:10 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526193511861 ms
2018-05-12 23:39:10 INFO  MicroBatchExecution:54 - Committed offsets for batch 4. Metadata OffsetSeqMetadata(1526193511861,1526193550002,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_34 stored as values in memory (estimated size 277.7 KB, free 363.0 MB)
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_34_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.0 MB)
2018-05-12 23:39:10 INFO  BlockManagerInfo:54 - Added broadcast_34_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:39:10 INFO  SparkContext:54 - Created broadcast 34 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_35 stored as values in memory (estimated size 277.7 KB, free 362.7 MB)
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_35_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.7 MB)
2018-05-12 23:39:10 INFO  BlockManagerInfo:54 - Added broadcast_35_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:39:10 INFO  SparkContext:54 - Created broadcast 35 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_36 stored as values in memory (estimated size 277.7 KB, free 362.4 MB)
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_36_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.4 MB)
2018-05-12 23:39:10 INFO  BlockManagerInfo:54 - Added broadcast_36_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:39:10 INFO  SparkContext:54 - Created broadcast 36 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:10 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526193511861E12 * 1000.0) as double) + -1.0E7)
2018-05-12 23:39:10 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526193501860
2018-05-12 23:39:10 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526193511861E12 * 1000.0) as double)
2018-05-12 23:39:10 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526193511860
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_37 stored as values in memory (estimated size 277.7 KB, free 362.1 MB)
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_37_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.1 MB)
2018-05-12 23:39:10 INFO  BlockManagerInfo:54 - Added broadcast_37_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:39:10 INFO  SparkContext:54 - Created broadcast 37 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_38 stored as values in memory (estimated size 277.7 KB, free 361.8 MB)
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_38_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.8 MB)
2018-05-12 23:39:10 INFO  BlockManagerInfo:54 - Added broadcast_38_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:39:10 INFO  SparkContext:54 - Created broadcast 38 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_39 stored as values in memory (estimated size 277.7 KB, free 361.5 MB)
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_39_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.5 MB)
2018-05-12 23:39:10 INFO  BlockManagerInfo:54 - Added broadcast_39_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:39:10 INFO  SparkContext:54 - Created broadcast 39 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:10 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@3ed8c3de. The input RDD has 1 partitions.
2018-05-12 23:39:10 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:10 INFO  DAGScheduler:54 - Registering RDD 86 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:39:10 INFO  DAGScheduler:54 - Registering RDD 81 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:39:10 INFO  DAGScheduler:54 - Got job 8 (start at RateStreamStreamJoin.scala:53) with 1 output partitions
2018-05-12 23:39:10 INFO  DAGScheduler:54 - Final stage: ResultStage 14 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:39:10 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 12, ShuffleMapStage 13)
2018-05-12 23:39:10 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 12, ShuffleMapStage 13)
2018-05-12 23:39:10 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 12 (MapPartitionsRDD[86] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_40 stored as values in memory (estimated size 15.5 KB, free 361.5 MB)
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_40_piece0 stored as bytes in memory (estimated size 7.4 KB, free 361.5 MB)
2018-05-12 23:39:10 INFO  BlockManagerInfo:54 - Added broadcast_40_piece0 in memory on 192.168.19.162:46196 (size: 7.4 KB, free: 365.9 MB)
2018-05-12 23:39:10 INFO  SparkContext:54 - Created broadcast 40 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:39:10 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 12 (MapPartitionsRDD[86] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:39:10 INFO  TaskSchedulerImpl:54 - Adding task set 12.0 with 1 tasks
2018-05-12 23:39:10 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 13 (MapPartitionsRDD[81] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:39:10 INFO  TaskSetManager:54 - Starting task 0.0 in stage 12.0 (TID 10, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:39:10 INFO  Executor:54 - Running task 0.0 in stage 12.0 (TID 10)
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_41 stored as values in memory (estimated size 11.8 KB, free 361.5 MB)
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_41_piece0 stored as bytes in memory (estimated size 6.0 KB, free 361.5 MB)
2018-05-12 23:39:10 INFO  BlockManagerInfo:54 - Added broadcast_41_piece0 in memory on 192.168.19.162:46196 (size: 6.0 KB, free: 365.9 MB)
2018-05-12 23:39:10 INFO  SparkContext:54 - Created broadcast 41 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:39:10 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 13 (MapPartitionsRDD[81] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:39:10 INFO  TaskSchedulerImpl:54 - Adding task set 13.0 with 1 tasks
2018-05-12 23:39:10 INFO  TaskSetManager:54 - Starting task 0.0 in stage 13.0 (TID 11, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:39:10 INFO  Executor:54 - Running task 0.0 in stage 13.0 (TID 11)
2018-05-12 23:39:10 INFO  Executor:54 - Finished task 0.0 in stage 12.0 (TID 10). 1777 bytes result sent to driver
2018-05-12 23:39:10 INFO  Executor:54 - Finished task 0.0 in stage 13.0 (TID 11). 1653 bytes result sent to driver
2018-05-12 23:39:10 INFO  TaskSetManager:54 - Finished task 0.0 in stage 12.0 (TID 10) in 71 ms on localhost (executor driver) (1/1)
2018-05-12 23:39:10 INFO  TaskSchedulerImpl:54 - Removed TaskSet 12.0, whose tasks have all completed, from pool 
2018-05-12 23:39:10 INFO  DAGScheduler:54 - ShuffleMapStage 12 (start at RateStreamStreamJoin.scala:53) finished in 0.113 s
2018-05-12 23:39:10 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:39:10 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 13)
2018-05-12 23:39:10 INFO  DAGScheduler:54 - waiting: Set(ResultStage 14)
2018-05-12 23:39:10 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:39:10 INFO  TaskSetManager:54 - Finished task 0.0 in stage 13.0 (TID 11) in 67 ms on localhost (executor driver) (1/1)
2018-05-12 23:39:10 INFO  TaskSchedulerImpl:54 - Removed TaskSet 13.0, whose tasks have all completed, from pool 
2018-05-12 23:39:10 INFO  DAGScheduler:54 - ShuffleMapStage 13 (start at RateStreamStreamJoin.scala:53) finished in 0.101 s
2018-05-12 23:39:10 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:39:10 INFO  DAGScheduler:54 - running: Set()
2018-05-12 23:39:10 INFO  DAGScheduler:54 - waiting: Set(ResultStage 14)
2018-05-12 23:39:10 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:39:10 INFO  DAGScheduler:54 - Submitting ResultStage 14 (StateStoreAwareZipPartitionsRDD[88] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_42 stored as values in memory (estimated size 18.0 KB, free 361.4 MB)
2018-05-12 23:39:10 INFO  MemoryStore:54 - Block broadcast_42_piece0 stored as bytes in memory (estimated size 8.9 KB, free 361.4 MB)
2018-05-12 23:39:10 INFO  BlockManagerInfo:54 - Added broadcast_42_piece0 in memory on 192.168.19.162:46196 (size: 8.9 KB, free: 365.9 MB)
2018-05-12 23:39:10 INFO  SparkContext:54 - Created broadcast 42 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:39:10 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 14 (StateStoreAwareZipPartitionsRDD[88] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:39:10 INFO  TaskSchedulerImpl:54 - Adding task set 14.0 with 1 tasks
2018-05-12 23:39:10 INFO  TaskSetManager:54 - Starting task 0.0 in stage 14.0 (TID 12, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 23:39:10 INFO  Executor:54 - Running task 0.0 in stage 14.0 (TID 12)
2018-05-12 23:39:10 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:39:10 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 23:39:10 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:39:10 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2018-05-12 23:39:10 INFO  StateStore:54 - Env is not null
2018-05-12 23:39:10 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:39:10 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@16e1d360
2018-05-12 23:39:10 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:39:10 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 4 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] for update
2018-05-12 23:39:10 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues)
2018-05-12 23:39:10 INFO  StateStore:54 - Env is not null
2018-05-12 23:39:10 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:39:10 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@ab5c406
2018-05-12 23:39:10 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:39:10 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 4 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 23:39:10 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue)
2018-05-12 23:39:10 INFO  CodeGenerator:54 - Code generated in 15.393964 ms
2018-05-12 23:39:10 INFO  StateStore:54 - Env is not null
2018-05-12 23:39:10 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:39:10 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@7573cf88
2018-05-12 23:39:10 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:39:10 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 4 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] for update
2018-05-12 23:39:10 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues)
2018-05-12 23:39:10 INFO  StateStore:54 - Env is not null
2018-05-12 23:39:10 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:39:10 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@1a0de5f6
2018-05-12 23:39:10 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:39:10 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 4 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 23:39:10 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue)
2018-05-12 23:39:10 INFO  CodeGenerator:54 - Code generated in 16.49761 ms
2018-05-12 23:39:10 INFO  CodeGenerator:54 - Code generated in 13.826663 ms
2018-05-12 23:39:10 INFO  HDFSBackedStateStoreProvider:54 - Committed version 5 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues/5.delta
2018-05-12 23:39:10 INFO  HDFSBackedStateStoreProvider:54 - Committed version 5 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue/5.delta
2018-05-12 23:39:10 INFO  HDFSBackedStateStoreProvider:54 - Committed version 5 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues/5.delta
2018-05-12 23:39:10 INFO  HDFSBackedStateStoreProvider:54 - Committed version 5 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue/5.delta
2018-05-12 23:39:10 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 23:39:10 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 23:39:10 INFO  Executor:54 - Finished task 0.0 in stage 14.0 (TID 12). 12146 bytes result sent to driver
2018-05-12 23:39:10 INFO  TaskSetManager:54 - Finished task 0.0 in stage 14.0 (TID 12) in 239 ms on localhost (executor driver) (1/1)
2018-05-12 23:39:10 INFO  TaskSchedulerImpl:54 - Removed TaskSet 14.0, whose tasks have all completed, from pool 
2018-05-12 23:39:10 INFO  DAGScheduler:54 - ResultStage 14 (start at RateStreamStreamJoin.scala:53) finished in 0.267 s
2018-05-12 23:39:10 INFO  DAGScheduler:54 - Job 8 finished: start at RateStreamStreamJoin.scala:53, took 0.411261 s
2018-05-12 23:39:10 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@3ed8c3de is committing.
-------------------------------------------
Batch: 4
-------------------------------------------
+--------------+----------------------+---------+-----------------------+
|impressionAdId|impressionTime        |clickAdId|clickTime              |
+--------------+----------------------+---------+-----------------------+
|331           |2018-05-12 23:38:36.15|331      |2018-05-12 23:38:44.261|
|334           |2018-05-12 23:38:36.75|334      |2018-05-12 23:38:44.861|
|361           |2018-05-12 23:38:42.15|361      |2018-05-12 23:38:50.261|
|397           |2018-05-12 23:38:49.35|397      |2018-05-12 23:38:57.461|
|398           |2018-05-12 23:38:49.55|398      |2018-05-12 23:38:57.661|
|407           |2018-05-12 23:38:51.35|407      |2018-05-12 23:38:59.461|
|410           |2018-05-12 23:38:51.95|410      |2018-05-12 23:39:00.061|
|417           |2018-05-12 23:38:53.35|417      |2018-05-12 23:39:01.461|
|421           |2018-05-12 23:38:54.15|421      |2018-05-12 23:39:02.261|
|434           |2018-05-12 23:38:56.75|434      |2018-05-12 23:39:04.861|
|443           |2018-05-12 23:38:58.55|443      |2018-05-12 23:39:06.661|
|444           |2018-05-12 23:38:58.75|444      |2018-05-12 23:39:06.861|
|179           |2018-05-12 23:38:05.75|null     |null                   |
|162           |2018-05-12 23:38:02.35|null     |null                   |
|213           |2018-05-12 23:38:12.55|null     |null                   |
|180           |2018-05-12 23:38:05.95|null     |null                   |
|142           |2018-05-12 23:37:58.35|null     |null                   |
|245           |2018-05-12 23:38:18.95|null     |null                   |
|224           |2018-05-12 23:38:14.75|null     |null                   |
|219           |2018-05-12 23:38:13.75|null     |null                   |
|215           |2018-05-12 23:38:12.95|null     |null                   |
|253           |2018-05-12 23:38:20.55|null     |null                   |
|202           |2018-05-12 23:38:10.35|null     |null                   |
|225           |2018-05-12 23:38:14.95|null     |null                   |
|198           |2018-05-12 23:38:09.55|null     |null                   |
|232           |2018-05-12 23:38:16.35|null     |null                   |
|165           |2018-05-12 23:38:02.95|null     |null                   |
|257           |2018-05-12 23:38:21.35|null     |null                   |
|247           |2018-05-12 23:38:19.35|null     |null                   |
|233           |2018-05-12 23:38:16.55|null     |null                   |
|150           |2018-05-12 23:37:59.95|null     |null                   |
|235           |2018-05-12 23:38:16.95|null     |null                   |
|212           |2018-05-12 23:38:12.35|null     |null                   |
|152           |2018-05-12 23:38:00.35|null     |null                   |
|151           |2018-05-12 23:38:00.15|null     |null                   |
|177           |2018-05-12 23:38:05.35|null     |null                   |
|183           |2018-05-12 23:38:06.55|null     |null                   |
|252           |2018-05-12 23:38:20.35|null     |null                   |
|248           |2018-05-12 23:38:19.55|null     |null                   |
|237           |2018-05-12 23:38:17.35|null     |null                   |
|207           |2018-05-12 23:38:11.35|null     |null                   |
|153           |2018-05-12 23:38:00.55|null     |null                   |
|172           |2018-05-12 23:38:04.35|null     |null                   |
|238           |2018-05-12 23:38:17.55|null     |null                   |
|227           |2018-05-12 23:38:15.35|null     |null                   |
|145           |2018-05-12 23:37:58.95|null     |null                   |
|182           |2018-05-12 23:38:06.35|null     |null                   |
|144           |2018-05-12 23:37:58.75|null     |null                   |
|170           |2018-05-12 23:38:03.95|null     |null                   |
|164           |2018-05-12 23:38:02.75|null     |null                   |
+--------------+----------------------+---------+-----------------------+
only showing top 50 rows

2018-05-12 23:39:11 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@3ed8c3de committed.
2018-05-12 23:39:11 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:11 INFO  DAGScheduler:54 - Job 9 finished: start at RateStreamStreamJoin.scala:53, took 0.000061 s
2018-05-12 23:39:11 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "f81d0864-a505-45c0-aee1-8bd905d13407",
  "runId" : "cda27f86-f23a-4e61-af81-4993b63777fe",
  "name" : null,
  "timestamp" : "2018-05-13T06:39:10.001Z",
  "batchId" : 4,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 10.00040001600064,
  "processedRowsPerSecond" : 242.48302618816686,
  "durationMs" : {
    "addBatch" : 644,
    "getBatch" : 41,
    "getOffset" : 0,
    "queryPlanning" : 300,
    "triggerExecution" : 1031,
    "walCommit" : 43
  },
  "eventTime" : {
    "avg" : "2018-05-13T06:38:57.350Z",
    "max" : "2018-05-13T06:39:09.750Z",
    "min" : "2018-05-13T06:38:44.950Z",
    "watermark" : "2018-05-13T06:38:31.861Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 261,
    "numRowsUpdated" : 137,
    "memoryUsedBytes" : 103806
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 75,
    "endOffset" : 100,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.00020000800032,
    "processedRowsPerSecond" : 121.24151309408343
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 74,
    "endOffset" : 99,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.00020000800032,
    "processedRowsPerSecond" : 121.24151309408343
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@2736ef4e"
  }
}
2018-05-12 23:39:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:39:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:39:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@4c12540e
2018-05-12 23:39:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:39:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:39:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@2e894b7d
2018-05-12 23:39:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:39:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:39:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@1c612a4e
2018-05-12 23:39:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:39:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:39:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@2ae6b2
2018-05-12 23:39:35 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526193536861 ms
2018-05-12 23:39:35 INFO  MicroBatchExecution:54 - Committed offsets for batch 5. Metadata OffsetSeqMetadata(1526193536861,1526193575002,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_43 stored as values in memory (estimated size 277.7 KB, free 361.2 MB)
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_43_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.1 MB)
2018-05-12 23:39:35 INFO  BlockManagerInfo:54 - Added broadcast_43_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:39:35 INFO  SparkContext:54 - Created broadcast 43 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_44 stored as values in memory (estimated size 277.7 KB, free 360.9 MB)
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_44_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.8 MB)
2018-05-12 23:39:35 INFO  BlockManagerInfo:54 - Added broadcast_44_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:39:35 INFO  SparkContext:54 - Created broadcast 44 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_45 stored as values in memory (estimated size 277.7 KB, free 360.6 MB)
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_45_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.6 MB)
2018-05-12 23:39:35 INFO  BlockManagerInfo:54 - Added broadcast_45_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:39:35 INFO  SparkContext:54 - Created broadcast 45 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:35 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526193536861E12 * 1000.0) as double) + -1.0E7)
2018-05-12 23:39:35 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526193526860
2018-05-12 23:39:35 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526193536861E12 * 1000.0) as double)
2018-05-12 23:39:35 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526193536860
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_46 stored as values in memory (estimated size 277.7 KB, free 360.3 MB)
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_46_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.3 MB)
2018-05-12 23:39:35 INFO  BlockManagerInfo:54 - Added broadcast_46_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:39:35 INFO  SparkContext:54 - Created broadcast 46 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_47 stored as values in memory (estimated size 277.7 KB, free 360.0 MB)
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_47_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.0 MB)
2018-05-12 23:39:35 INFO  BlockManagerInfo:54 - Added broadcast_47_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:39:35 INFO  SparkContext:54 - Created broadcast 47 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_48 stored as values in memory (estimated size 277.7 KB, free 359.7 MB)
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_48_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.7 MB)
2018-05-12 23:39:35 INFO  BlockManagerInfo:54 - Added broadcast_48_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 23:39:35 INFO  SparkContext:54 - Created broadcast 48 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:35 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@28f1485b. The input RDD has 1 partitions.
2018-05-12 23:39:35 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:35 INFO  DAGScheduler:54 - Registering RDD 105 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:39:35 INFO  DAGScheduler:54 - Registering RDD 100 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:39:35 INFO  DAGScheduler:54 - Got job 10 (start at RateStreamStreamJoin.scala:53) with 1 output partitions
2018-05-12 23:39:35 INFO  DAGScheduler:54 - Final stage: ResultStage 17 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:39:35 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 15, ShuffleMapStage 16)
2018-05-12 23:39:35 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 15, ShuffleMapStage 16)
2018-05-12 23:39:35 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 15 (MapPartitionsRDD[105] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_49 stored as values in memory (estimated size 15.5 KB, free 359.7 MB)
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_49_piece0 stored as bytes in memory (estimated size 7.4 KB, free 359.7 MB)
2018-05-12 23:39:35 INFO  BlockManagerInfo:54 - Added broadcast_49_piece0 in memory on 192.168.19.162:46196 (size: 7.4 KB, free: 365.7 MB)
2018-05-12 23:39:35 INFO  SparkContext:54 - Created broadcast 49 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:39:35 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 15 (MapPartitionsRDD[105] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:39:35 INFO  TaskSchedulerImpl:54 - Adding task set 15.0 with 1 tasks
2018-05-12 23:39:35 INFO  TaskSetManager:54 - Starting task 0.0 in stage 15.0 (TID 13, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:39:35 INFO  Executor:54 - Running task 0.0 in stage 15.0 (TID 13)
2018-05-12 23:39:35 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 16 (MapPartitionsRDD[100] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_50 stored as values in memory (estimated size 11.8 KB, free 359.6 MB)
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_50_piece0 stored as bytes in memory (estimated size 6.0 KB, free 359.6 MB)
2018-05-12 23:39:35 INFO  BlockManagerInfo:54 - Added broadcast_50_piece0 in memory on 192.168.19.162:46196 (size: 6.0 KB, free: 365.7 MB)
2018-05-12 23:39:35 INFO  SparkContext:54 - Created broadcast 50 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:39:35 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 16 (MapPartitionsRDD[100] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:39:35 INFO  TaskSchedulerImpl:54 - Adding task set 16.0 with 1 tasks
2018-05-12 23:39:35 INFO  Executor:54 - Finished task 0.0 in stage 15.0 (TID 13). 1777 bytes result sent to driver
2018-05-12 23:39:35 INFO  TaskSetManager:54 - Starting task 0.0 in stage 16.0 (TID 14, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:39:35 INFO  Executor:54 - Running task 0.0 in stage 16.0 (TID 14)
2018-05-12 23:39:35 INFO  TaskSetManager:54 - Finished task 0.0 in stage 15.0 (TID 13) in 47 ms on localhost (executor driver) (1/1)
2018-05-12 23:39:35 INFO  TaskSchedulerImpl:54 - Removed TaskSet 15.0, whose tasks have all completed, from pool 
2018-05-12 23:39:35 INFO  DAGScheduler:54 - ShuffleMapStage 15 (start at RateStreamStreamJoin.scala:53) finished in 0.065 s
2018-05-12 23:39:35 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:39:35 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 16)
2018-05-12 23:39:35 INFO  DAGScheduler:54 - waiting: Set(ResultStage 17)
2018-05-12 23:39:35 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:39:35 INFO  Executor:54 - Finished task 0.0 in stage 16.0 (TID 14). 1653 bytes result sent to driver
2018-05-12 23:39:35 INFO  TaskSetManager:54 - Finished task 0.0 in stage 16.0 (TID 14) in 57 ms on localhost (executor driver) (1/1)
2018-05-12 23:39:35 INFO  TaskSchedulerImpl:54 - Removed TaskSet 16.0, whose tasks have all completed, from pool 
2018-05-12 23:39:35 INFO  DAGScheduler:54 - ShuffleMapStage 16 (start at RateStreamStreamJoin.scala:53) finished in 0.089 s
2018-05-12 23:39:35 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:39:35 INFO  DAGScheduler:54 - running: Set()
2018-05-12 23:39:35 INFO  DAGScheduler:54 - waiting: Set(ResultStage 17)
2018-05-12 23:39:35 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:39:35 INFO  DAGScheduler:54 - Submitting ResultStage 17 (StateStoreAwareZipPartitionsRDD[107] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_51 stored as values in memory (estimated size 18.0 KB, free 359.6 MB)
2018-05-12 23:39:35 INFO  MemoryStore:54 - Block broadcast_51_piece0 stored as bytes in memory (estimated size 8.9 KB, free 359.6 MB)
2018-05-12 23:39:35 INFO  BlockManagerInfo:54 - Added broadcast_51_piece0 in memory on 192.168.19.162:46196 (size: 8.9 KB, free: 365.7 MB)
2018-05-12 23:39:35 INFO  SparkContext:54 - Created broadcast 51 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:39:35 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 17 (StateStoreAwareZipPartitionsRDD[107] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:39:35 INFO  TaskSchedulerImpl:54 - Adding task set 17.0 with 1 tasks
2018-05-12 23:39:35 INFO  TaskSetManager:54 - Starting task 0.0 in stage 17.0 (TID 15, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 23:39:35 INFO  Executor:54 - Running task 0.0 in stage 17.0 (TID 15)
2018-05-12 23:39:35 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:39:35 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 23:39:35 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:39:35 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 23:39:35 INFO  StateStore:54 - Env is not null
2018-05-12 23:39:35 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:39:35 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@66fe1218
2018-05-12 23:39:35 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:39:35 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 5 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] for update
2018-05-12 23:39:35 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues)
2018-05-12 23:39:35 INFO  StateStore:54 - Env is not null
2018-05-12 23:39:35 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:39:35 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@5981a2fa
2018-05-12 23:39:35 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:39:35 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 5 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 23:39:35 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue)
2018-05-12 23:39:35 INFO  CodeGenerator:54 - Code generated in 15.467123 ms
2018-05-12 23:39:35 INFO  StateStore:54 - Env is not null
2018-05-12 23:39:35 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:39:35 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@797428ef
2018-05-12 23:39:35 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:39:35 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 5 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] for update
2018-05-12 23:39:35 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues)
2018-05-12 23:39:35 INFO  StateStore:54 - Env is not null
2018-05-12 23:39:35 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:39:35 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@6b90ebf4
2018-05-12 23:39:35 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:39:35 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 5 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 23:39:35 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue)
2018-05-12 23:39:35 INFO  CodeGenerator:54 - Code generated in 12.242284 ms
2018-05-12 23:39:35 INFO  CodeGenerator:54 - Code generated in 15.173569 ms
2018-05-12 23:39:35 INFO  HDFSBackedStateStoreProvider:54 - Committed version 6 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues/6.delta
2018-05-12 23:39:35 INFO  HDFSBackedStateStoreProvider:54 - Committed version 6 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue/6.delta
2018-05-12 23:39:35 INFO  HDFSBackedStateStoreProvider:54 - Committed version 6 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues/6.delta
2018-05-12 23:39:35 INFO  HDFSBackedStateStoreProvider:54 - Committed version 6 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue/6.delta
2018-05-12 23:39:35 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 23:39:35 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 23:39:35 INFO  Executor:54 - Finished task 0.0 in stage 17.0 (TID 15). 12146 bytes result sent to driver
2018-05-12 23:39:35 INFO  TaskSetManager:54 - Finished task 0.0 in stage 17.0 (TID 15) in 256 ms on localhost (executor driver) (1/1)
2018-05-12 23:39:35 INFO  TaskSchedulerImpl:54 - Removed TaskSet 17.0, whose tasks have all completed, from pool 
2018-05-12 23:39:35 INFO  DAGScheduler:54 - ResultStage 17 (start at RateStreamStreamJoin.scala:53) finished in 0.293 s
2018-05-12 23:39:35 INFO  DAGScheduler:54 - Job 10 finished: start at RateStreamStreamJoin.scala:53, took 0.438459 s
2018-05-12 23:39:35 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@28f1485b is committing.
-------------------------------------------
Batch: 5
-------------------------------------------
+--------------+----------------------+---------+-----------------------+
|impressionAdId|impressionTime        |clickAdId|clickTime              |
+--------------+----------------------+---------+-----------------------+
|456           |2018-05-12 23:39:01.15|456      |2018-05-12 23:39:09.261|
|459           |2018-05-12 23:39:01.75|459      |2018-05-12 23:39:09.861|
|486           |2018-05-12 23:39:07.15|486      |2018-05-12 23:39:15.261|
|522           |2018-05-12 23:39:14.35|522      |2018-05-12 23:39:22.461|
|523           |2018-05-12 23:39:14.55|523      |2018-05-12 23:39:22.661|
|532           |2018-05-12 23:39:16.35|532      |2018-05-12 23:39:24.461|
|535           |2018-05-12 23:39:16.95|535      |2018-05-12 23:39:25.061|
|542           |2018-05-12 23:39:18.35|542      |2018-05-12 23:39:26.461|
|546           |2018-05-12 23:39:19.15|546      |2018-05-12 23:39:27.261|
|559           |2018-05-12 23:39:21.75|559      |2018-05-12 23:39:29.861|
|568           |2018-05-12 23:39:23.55|568      |2018-05-12 23:39:31.661|
|569           |2018-05-12 23:39:23.75|569      |2018-05-12 23:39:31.861|
|294           |2018-05-12 23:38:28.75|null     |null                   |
|358           |2018-05-12 23:38:41.55|null     |null                   |
|372           |2018-05-12 23:38:44.35|null     |null                   |
|322           |2018-05-12 23:38:34.35|null     |null                   |
|335           |2018-05-12 23:38:36.95|null     |null                   |
|287           |2018-05-12 23:38:27.35|null     |null                   |
|376           |2018-05-12 23:38:45.15|null     |null                   |
|283           |2018-05-12 23:38:26.55|null     |null                   |
|352           |2018-05-12 23:38:40.35|null     |null                   |
|365           |2018-05-12 23:38:42.95|null     |null                   |
|381           |2018-05-12 23:38:46.15|null     |null                   |
|299           |2018-05-12 23:38:29.75|null     |null                   |
|293           |2018-05-12 23:38:28.55|null     |null                   |
|270           |2018-05-12 23:38:23.95|null     |null                   |
|360           |2018-05-12 23:38:41.95|null     |null                   |
|262           |2018-05-12 23:38:22.35|null     |null                   |
|340           |2018-05-12 23:38:37.95|null     |null                   |
|265           |2018-05-12 23:38:22.95|null     |null                   |
|288           |2018-05-12 23:38:27.55|null     |null                   |
|306           |2018-05-12 23:38:31.15|null     |null                   |
|264           |2018-05-12 23:38:22.75|null     |null                   |
|301           |2018-05-12 23:38:30.15|null     |null                   |
|341           |2018-05-12 23:38:38.15|null     |null                   |
|274           |2018-05-12 23:38:24.75|null     |null                   |
|363           |2018-05-12 23:38:42.55|null     |null                   |
|362           |2018-05-12 23:38:42.35|null     |null                   |
|271           |2018-05-12 23:38:24.15|null     |null                   |
|345           |2018-05-12 23:38:38.95|null     |null                   |
|359           |2018-05-12 23:38:41.75|null     |null                   |
|303           |2018-05-12 23:38:30.55|null     |null                   |
|349           |2018-05-12 23:38:39.75|null     |null                   |
|330           |2018-05-12 23:38:35.95|null     |null                   |
|336           |2018-05-12 23:38:37.15|null     |null                   |
|280           |2018-05-12 23:38:25.95|null     |null                   |
|364           |2018-05-12 23:38:42.75|null     |null                   |
|284           |2018-05-12 23:38:26.75|null     |null                   |
|342           |2018-05-12 23:38:38.35|null     |null                   |
|337           |2018-05-12 23:38:37.35|null     |null                   |
+--------------+----------------------+---------+-----------------------+
only showing top 50 rows

2018-05-12 23:39:36 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@28f1485b committed.
2018-05-12 23:39:36 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:39:36 INFO  DAGScheduler:54 - Job 11 finished: start at RateStreamStreamJoin.scala:53, took 0.000065 s
2018-05-12 23:39:36 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "f81d0864-a505-45c0-aee1-8bd905d13407",
  "runId" : "cda27f86-f23a-4e61-af81-4993b63777fe",
  "name" : null,
  "timestamp" : "2018-05-13T06:39:35.000Z",
  "batchId" : 5,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 10.00040001600064,
  "processedRowsPerSecond" : 235.62676720075402,
  "durationMs" : {
    "addBatch" : 666,
    "getBatch" : 46,
    "getOffset" : 0,
    "queryPlanning" : 308,
    "triggerExecution" : 1061,
    "walCommit" : 37
  },
  "eventTime" : {
    "avg" : "2018-05-13T06:39:22.350Z",
    "max" : "2018-05-13T06:39:34.750Z",
    "min" : "2018-05-13T06:39:09.950Z",
    "watermark" : "2018-05-13T06:38:56.861Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 261,
    "numRowsUpdated" : 137,
    "memoryUsedBytes" : 89118
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 100,
    "endOffset" : 125,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.00020000800032,
    "processedRowsPerSecond" : 117.81338360037701
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 99,
    "endOffset" : 124,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.00020000800032,
    "processedRowsPerSecond" : 117.81338360037701
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@2736ef4e"
  }
}
2018-05-12 23:40:00 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526193561861 ms
2018-05-12 23:40:00 INFO  MicroBatchExecution:54 - Committed offsets for batch 6. Metadata OffsetSeqMetadata(1526193561861,1526193600001,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 300
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 280
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 297
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 346
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 426
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 294
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 516
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 393
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_36_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.7 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 411
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 441
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 318
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 513
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 527
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_32_piece0 on 192.168.19.162:46196 in memory (size: 7.4 KB, free: 365.8 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 389
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 260
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 308
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 285
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 482
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_42_piece0 on 192.168.19.162:46196 in memory (size: 8.9 KB, free: 365.8 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 291
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 328
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_51_piece0 on 192.168.19.162:46196 in memory (size: 8.9 KB, free: 365.8 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 335
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 470
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 259
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 398
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 503
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 319
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 392
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 432
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 265
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 354
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_41_piece0 on 192.168.19.162:46196 in memory (size: 6.0 KB, free: 365.8 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 399
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 487
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 370
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 390
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 492
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 349
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 424
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 272
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 437
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 396
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 347
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 275
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 286
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 397
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 339
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 530
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 358
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 372
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 350
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 295
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 500
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 287
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 421
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 431
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 378
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 495
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 381
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 307
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 363
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 331
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 436
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 276
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_31_piece0 on 192.168.19.162:46196 in memory (size: 6.0 KB, free: 365.8 MB)
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_49_piece0 on 192.168.19.162:46196 in memory (size: 7.4 KB, free: 365.8 MB)
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_52 stored as values in memory (estimated size 277.7 KB, free 359.8 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 506
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 509
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 298
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 327
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 264
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 416
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 306
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 253
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 497
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 250
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_39_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 525
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 314
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 534
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 391
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 361
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 325
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 341
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 315
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 359
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 479
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 311
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned shuffle 9
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 521
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 383
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 539
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 481
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 355
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 338
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 254
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 468
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 251
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 406
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 277
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 435
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 517
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 473
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 413
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 377
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 329
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_30_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 266
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 313
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_52_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.4 MB)
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_43_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Added broadcast_52_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:40:00 INFO  SparkContext:54 - Created broadcast 52 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned shuffle 8
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 471
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 491
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 514
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 523
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 430
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 252
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 478
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_37_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_53 stored as values in memory (estimated size 277.7 KB, free 360.6 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 480
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 352
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_28_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 309
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 496
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 440
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_47_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 262
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 312
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 538
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 348
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 419
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 274
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 484
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 271
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 408
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 326
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 508
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 394
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 504
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned shuffle 7
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 485
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 345
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 524
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 336
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 384
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 502
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 474
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 486
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 395
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 528
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 343
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 334
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 281
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 284
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 532
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 362
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 418
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 498
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 420
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 388
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 529
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 434
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 278
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 433
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 423
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 367
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 522
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 303
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 330
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 324
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 537
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 427
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 533
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 269
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 374
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 490
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 299
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 369
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 316
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 536
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_29_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_53_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.2 MB)
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Added broadcast_53_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 414
2018-05-12 23:40:00 INFO  SparkContext:54 - Created broadcast 53 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned shuffle 6
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 445
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 353
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 356
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 322
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 289
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 321
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 415
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 332
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 360
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 273
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 501
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 444
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 407
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 439
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 302
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_54 stored as values in memory (estimated size 277.7 KB, free 361.2 MB)
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_50_piece0 on 192.168.19.162:46196 in memory (size: 6.0 KB, free: 365.9 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 540
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 282
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 267
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 443
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_27_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 320
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 417
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 412
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 288
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 483
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 472
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 293
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 270
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 290
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 494
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 446
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 380
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 401
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_54_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.5 MB)
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_46_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Added broadcast_54_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 493
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 499
2018-05-12 23:40:00 INFO  SparkContext:54 - Created broadcast 54 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 425
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 442
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 489
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 351
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 317
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 475
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 371
2018-05-12 23:40:00 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526193561861E12 * 1000.0) as double) + -1.0E7)
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_38_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:40:00 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526193551860
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 477
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 512
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 409
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 368
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 405
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 520
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 519
2018-05-12 23:40:00 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526193561861E12 * 1000.0) as double)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 292
2018-05-12 23:40:00 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526193561860
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 340
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 526
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 400
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 268
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 403
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 511
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 438
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 296
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 404
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 505
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 263
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 249
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 364
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 301
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 510
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 373
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 257
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 375
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 337
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 305
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 366
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 542
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 261
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_55 stored as values in memory (estimated size 277.7 KB, free 361.8 MB)
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_33_piece0 on 192.168.19.162:46196 in memory (size: 8.9 KB, free: 366.0 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 344
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 543
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 386
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 382
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 518
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 256
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 376
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 488
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 279
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_44_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 365
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 449
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_40_piece0 on 192.168.19.162:46196 in memory (size: 7.4 KB, free: 366.0 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 422
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 304
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 428
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 469
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 342
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 323
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_35_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 387
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 410
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 385
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 429
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 333
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Removed broadcast_34_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 258
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 535
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 379
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 283
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 357
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 515
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 476
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 507
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 255
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 402
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 531
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 310
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 541
2018-05-12 23:40:00 INFO  ContextCleaner:54 - Cleaned accumulator 450
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_55_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.7 MB)
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Added broadcast_55_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:40:00 INFO  SparkContext:54 - Created broadcast 55 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_56 stored as values in memory (estimated size 277.7 KB, free 362.5 MB)
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_56_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.5 MB)
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Added broadcast_56_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:40:00 INFO  SparkContext:54 - Created broadcast 56 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_57 stored as values in memory (estimated size 277.7 KB, free 362.2 MB)
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_57_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.2 MB)
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Added broadcast_57_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:40:00 INFO  SparkContext:54 - Created broadcast 57 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:00 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@6f0351d0. The input RDD has 1 partitions.
2018-05-12 23:40:00 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:00 INFO  DAGScheduler:54 - Registering RDD 124 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:40:00 INFO  DAGScheduler:54 - Registering RDD 119 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:40:00 INFO  DAGScheduler:54 - Got job 12 (start at RateStreamStreamJoin.scala:53) with 1 output partitions
2018-05-12 23:40:00 INFO  DAGScheduler:54 - Final stage: ResultStage 20 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:40:00 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 19, ShuffleMapStage 18)
2018-05-12 23:40:00 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 19, ShuffleMapStage 18)
2018-05-12 23:40:00 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 18 (MapPartitionsRDD[124] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_58 stored as values in memory (estimated size 15.5 KB, free 362.1 MB)
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_58_piece0 stored as bytes in memory (estimated size 7.4 KB, free 362.1 MB)
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Added broadcast_58_piece0 in memory on 192.168.19.162:46196 (size: 7.4 KB, free: 366.0 MB)
2018-05-12 23:40:00 INFO  SparkContext:54 - Created broadcast 58 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:40:00 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 18 (MapPartitionsRDD[124] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:40:00 INFO  TaskSchedulerImpl:54 - Adding task set 18.0 with 1 tasks
2018-05-12 23:40:00 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 19 (MapPartitionsRDD[119] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:40:00 INFO  TaskSetManager:54 - Starting task 0.0 in stage 18.0 (TID 16, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:40:00 INFO  Executor:54 - Running task 0.0 in stage 18.0 (TID 16)
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_59 stored as values in memory (estimated size 11.8 KB, free 362.1 MB)
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_59_piece0 stored as bytes in memory (estimated size 6.0 KB, free 362.1 MB)
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Added broadcast_59_piece0 in memory on 192.168.19.162:46196 (size: 6.0 KB, free: 366.0 MB)
2018-05-12 23:40:00 INFO  SparkContext:54 - Created broadcast 59 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:40:00 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 19 (MapPartitionsRDD[119] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:40:00 INFO  TaskSchedulerImpl:54 - Adding task set 19.0 with 1 tasks
2018-05-12 23:40:00 INFO  TaskSetManager:54 - Starting task 0.0 in stage 19.0 (TID 17, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:40:00 INFO  Executor:54 - Running task 0.0 in stage 19.0 (TID 17)
2018-05-12 23:40:00 INFO  Executor:54 - Finished task 0.0 in stage 18.0 (TID 16). 1777 bytes result sent to driver
2018-05-12 23:40:00 INFO  TaskSetManager:54 - Finished task 0.0 in stage 18.0 (TID 16) in 30 ms on localhost (executor driver) (1/1)
2018-05-12 23:40:00 INFO  TaskSchedulerImpl:54 - Removed TaskSet 18.0, whose tasks have all completed, from pool 
2018-05-12 23:40:00 INFO  DAGScheduler:54 - ShuffleMapStage 18 (start at RateStreamStreamJoin.scala:53) finished in 0.044 s
2018-05-12 23:40:00 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:40:00 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 19)
2018-05-12 23:40:00 INFO  DAGScheduler:54 - waiting: Set(ResultStage 20)
2018-05-12 23:40:00 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:40:00 INFO  Executor:54 - Finished task 0.0 in stage 19.0 (TID 17). 1653 bytes result sent to driver
2018-05-12 23:40:00 INFO  TaskSetManager:54 - Finished task 0.0 in stage 19.0 (TID 17) in 23 ms on localhost (executor driver) (1/1)
2018-05-12 23:40:00 INFO  TaskSchedulerImpl:54 - Removed TaskSet 19.0, whose tasks have all completed, from pool 
2018-05-12 23:40:00 INFO  DAGScheduler:54 - ShuffleMapStage 19 (start at RateStreamStreamJoin.scala:53) finished in 0.039 s
2018-05-12 23:40:00 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:40:00 INFO  DAGScheduler:54 - running: Set()
2018-05-12 23:40:00 INFO  DAGScheduler:54 - waiting: Set(ResultStage 20)
2018-05-12 23:40:00 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:40:00 INFO  DAGScheduler:54 - Submitting ResultStage 20 (StateStoreAwareZipPartitionsRDD[126] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_60 stored as values in memory (estimated size 18.0 KB, free 362.1 MB)
2018-05-12 23:40:00 INFO  MemoryStore:54 - Block broadcast_60_piece0 stored as bytes in memory (estimated size 8.9 KB, free 362.1 MB)
2018-05-12 23:40:00 INFO  BlockManagerInfo:54 - Added broadcast_60_piece0 in memory on 192.168.19.162:46196 (size: 8.9 KB, free: 365.9 MB)
2018-05-12 23:40:00 INFO  SparkContext:54 - Created broadcast 60 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:40:00 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 20 (StateStoreAwareZipPartitionsRDD[126] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:40:00 INFO  TaskSchedulerImpl:54 - Adding task set 20.0 with 1 tasks
2018-05-12 23:40:00 INFO  TaskSetManager:54 - Starting task 0.0 in stage 20.0 (TID 18, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 23:40:00 INFO  Executor:54 - Running task 0.0 in stage 20.0 (TID 18)
2018-05-12 23:40:00 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:40:00 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 23:40:00 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:40:00 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 23:40:00 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:00 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:00 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@15df342
2018-05-12 23:40:00 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:40:00 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 6 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] for update
2018-05-12 23:40:00 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues)
2018-05-12 23:40:00 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:00 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:00 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@215591ae
2018-05-12 23:40:00 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:40:00 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 6 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 23:40:00 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue)
2018-05-12 23:40:00 INFO  CodeGenerator:54 - Code generated in 13.711354 ms
2018-05-12 23:40:00 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:00 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:00 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@4d42c75b
2018-05-12 23:40:00 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:40:00 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 6 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] for update
2018-05-12 23:40:00 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues)
2018-05-12 23:40:00 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:00 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:00 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@2cdb1e58
2018-05-12 23:40:00 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:40:00 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 6 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 23:40:00 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue)
2018-05-12 23:40:00 INFO  CodeGenerator:54 - Code generated in 10.991609 ms
2018-05-12 23:40:00 INFO  CodeGenerator:54 - Code generated in 12.333876 ms
2018-05-12 23:40:00 INFO  HDFSBackedStateStoreProvider:54 - Committed version 7 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues/7.delta
2018-05-12 23:40:00 INFO  HDFSBackedStateStoreProvider:54 - Committed version 7 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue/7.delta
2018-05-12 23:40:00 INFO  HDFSBackedStateStoreProvider:54 - Committed version 7 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues/7.delta
2018-05-12 23:40:00 INFO  HDFSBackedStateStoreProvider:54 - Committed version 7 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue/7.delta
2018-05-12 23:40:00 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 23:40:00 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 23:40:00 INFO  Executor:54 - Finished task 0.0 in stage 20.0 (TID 18). 12146 bytes result sent to driver
2018-05-12 23:40:00 INFO  TaskSetManager:54 - Finished task 0.0 in stage 20.0 (TID 18) in 159 ms on localhost (executor driver) (1/1)
2018-05-12 23:40:00 INFO  TaskSchedulerImpl:54 - Removed TaskSet 20.0, whose tasks have all completed, from pool 
2018-05-12 23:40:00 INFO  DAGScheduler:54 - ResultStage 20 (start at RateStreamStreamJoin.scala:53) finished in 0.179 s
2018-05-12 23:40:00 INFO  DAGScheduler:54 - Job 12 finished: start at RateStreamStreamJoin.scala:53, took 0.243445 s
2018-05-12 23:40:00 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@6f0351d0 is committing.
-------------------------------------------
Batch: 6
-------------------------------------------
+--------------+----------------------+---------+-----------------------+
|impressionAdId|impressionTime        |clickAdId|clickTime              |
+--------------+----------------------+---------+-----------------------+
|581           |2018-05-12 23:39:26.15|581      |2018-05-12 23:39:34.261|
|584           |2018-05-12 23:39:26.75|584      |2018-05-12 23:39:34.861|
|611           |2018-05-12 23:39:32.15|611      |2018-05-12 23:39:40.261|
|647           |2018-05-12 23:39:39.35|647      |2018-05-12 23:39:47.461|
|648           |2018-05-12 23:39:39.55|648      |2018-05-12 23:39:47.661|
|657           |2018-05-12 23:39:41.35|657      |2018-05-12 23:39:49.461|
|660           |2018-05-12 23:39:41.95|660      |2018-05-12 23:39:50.061|
|667           |2018-05-12 23:39:43.35|667      |2018-05-12 23:39:51.461|
|671           |2018-05-12 23:39:44.15|671      |2018-05-12 23:39:52.261|
|684           |2018-05-12 23:39:46.75|684      |2018-05-12 23:39:54.861|
|693           |2018-05-12 23:39:48.55|693      |2018-05-12 23:39:56.661|
|694           |2018-05-12 23:39:48.75|694      |2018-05-12 23:39:56.861|
|389           |2018-05-12 23:38:47.75|null     |null                   |
|471           |2018-05-12 23:39:04.15|null     |null                   |
|453           |2018-05-12 23:39:00.55|null     |null                   |
|387           |2018-05-12 23:38:47.35|null     |null                   |
|411           |2018-05-12 23:38:52.15|null     |null                   |
|498           |2018-05-12 23:39:09.55|null     |null                   |
|429           |2018-05-12 23:38:55.75|null     |null                   |
|394           |2018-05-12 23:38:48.75|null     |null                   |
|445           |2018-05-12 23:38:58.95|null     |null                   |
|479           |2018-05-12 23:39:05.75|null     |null                   |
|422           |2018-05-12 23:38:54.35|null     |null                   |
|430           |2018-05-12 23:38:55.95|null     |null                   |
|388           |2018-05-12 23:38:47.55|null     |null                   |
|446           |2018-05-12 23:38:59.15|null     |null                   |
|478           |2018-05-12 23:39:05.55|null     |null                   |
|435           |2018-05-12 23:38:56.95|null     |null                   |
|392           |2018-05-12 23:38:48.35|null     |null                   |
|481           |2018-05-12 23:39:06.15|null     |null                   |
|431           |2018-05-12 23:38:56.15|null     |null                   |
|501           |2018-05-12 23:39:10.15|null     |null                   |
|409           |2018-05-12 23:38:51.75|null     |null                   |
|448           |2018-05-12 23:38:59.55|null     |null                   |
|506           |2018-05-12 23:39:11.15|null     |null                   |
|408           |2018-05-12 23:38:51.55|null     |null                   |
|472           |2018-05-12 23:39:04.35|null     |null                   |
|395           |2018-05-12 23:38:48.95|null     |null                   |
|418           |2018-05-12 23:38:53.55|null     |null                   |
|504           |2018-05-12 23:39:10.75|null     |null                   |
|403           |2018-05-12 23:38:50.55|null     |null                   |
|494           |2018-05-12 23:39:08.75|null     |null                   |
|424           |2018-05-12 23:38:54.75|null     |null                   |
|458           |2018-05-12 23:39:01.55|null     |null                   |
|460           |2018-05-12 23:39:01.95|null     |null                   |
|467           |2018-05-12 23:39:03.35|null     |null                   |
|413           |2018-05-12 23:38:52.55|null     |null                   |
|507           |2018-05-12 23:39:11.35|null     |null                   |
|492           |2018-05-12 23:39:08.35|null     |null                   |
|480           |2018-05-12 23:39:05.95|null     |null                   |
+--------------+----------------------+---------+-----------------------+
only showing top 50 rows

2018-05-12 23:40:00 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@6f0351d0 committed.
2018-05-12 23:40:00 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:00 INFO  DAGScheduler:54 - Job 13 finished: start at RateStreamStreamJoin.scala:53, took 0.000058 s
2018-05-12 23:40:00 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "f81d0864-a505-45c0-aee1-8bd905d13407",
  "runId" : "cda27f86-f23a-4e61-af81-4993b63777fe",
  "name" : null,
  "timestamp" : "2018-05-13T06:40:00.000Z",
  "batchId" : 6,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 10.0,
  "processedRowsPerSecond" : 260.4166666666667,
  "durationMs" : {
    "addBatch" : 404,
    "getBatch" : 70,
    "getOffset" : 0,
    "queryPlanning" : 320,
    "triggerExecution" : 960,
    "walCommit" : 163
  },
  "eventTime" : {
    "avg" : "2018-05-13T06:39:47.350Z",
    "max" : "2018-05-13T06:39:59.750Z",
    "min" : "2018-05-13T06:39:34.950Z",
    "watermark" : "2018-05-13T06:39:21.861Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 261,
    "numRowsUpdated" : 137,
    "memoryUsedBytes" : 84558
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 125,
    "endOffset" : 150,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 130.20833333333334
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 124,
    "endOffset" : 149,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 130.20833333333334
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@2736ef4e"
  }
}
2018-05-12 23:40:25 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526193586861 ms
2018-05-12 23:40:25 INFO  MicroBatchExecution:54 - Committed offsets for batch 7. Metadata OffsetSeqMetadata(1526193586861,1526193625004,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_61 stored as values in memory (estimated size 277.7 KB, free 361.8 MB)
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_61_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.8 MB)
2018-05-12 23:40:25 INFO  BlockManagerInfo:54 - Added broadcast_61_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:25 INFO  SparkContext:54 - Created broadcast 61 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_62 stored as values in memory (estimated size 277.7 KB, free 361.5 MB)
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_62_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.5 MB)
2018-05-12 23:40:25 INFO  BlockManagerInfo:54 - Added broadcast_62_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:25 INFO  SparkContext:54 - Created broadcast 62 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_63 stored as values in memory (estimated size 277.7 KB, free 361.2 MB)
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_63_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.2 MB)
2018-05-12 23:40:25 INFO  BlockManagerInfo:54 - Added broadcast_63_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:25 INFO  SparkContext:54 - Created broadcast 63 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:25 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526193586861E12 * 1000.0) as double) + -1.0E7)
2018-05-12 23:40:25 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526193576860
2018-05-12 23:40:25 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526193586861E12 * 1000.0) as double)
2018-05-12 23:40:25 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526193586860
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_64 stored as values in memory (estimated size 277.7 KB, free 360.9 MB)
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_64_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.9 MB)
2018-05-12 23:40:25 INFO  BlockManagerInfo:54 - Added broadcast_64_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:25 INFO  SparkContext:54 - Created broadcast 64 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_65 stored as values in memory (estimated size 277.7 KB, free 360.6 MB)
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_65_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.6 MB)
2018-05-12 23:40:25 INFO  BlockManagerInfo:54 - Added broadcast_65_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:40:25 INFO  SparkContext:54 - Created broadcast 65 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_66 stored as values in memory (estimated size 277.7 KB, free 360.4 MB)
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_66_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.3 MB)
2018-05-12 23:40:25 INFO  BlockManagerInfo:54 - Added broadcast_66_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:40:25 INFO  SparkContext:54 - Created broadcast 66 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:25 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@433db401. The input RDD has 1 partitions.
2018-05-12 23:40:25 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:25 INFO  DAGScheduler:54 - Registering RDD 143 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:40:25 INFO  DAGScheduler:54 - Registering RDD 138 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:40:25 INFO  DAGScheduler:54 - Got job 14 (start at RateStreamStreamJoin.scala:53) with 1 output partitions
2018-05-12 23:40:25 INFO  DAGScheduler:54 - Final stage: ResultStage 23 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:40:25 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 21, ShuffleMapStage 22)
2018-05-12 23:40:25 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 21, ShuffleMapStage 22)
2018-05-12 23:40:25 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 21 (MapPartitionsRDD[143] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_67 stored as values in memory (estimated size 15.5 KB, free 360.3 MB)
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_67_piece0 stored as bytes in memory (estimated size 7.4 KB, free 360.3 MB)
2018-05-12 23:40:25 INFO  BlockManagerInfo:54 - Added broadcast_67_piece0 in memory on 192.168.19.162:46196 (size: 7.4 KB, free: 365.8 MB)
2018-05-12 23:40:25 INFO  SparkContext:54 - Created broadcast 67 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:40:25 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 21 (MapPartitionsRDD[143] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:40:25 INFO  TaskSchedulerImpl:54 - Adding task set 21.0 with 1 tasks
2018-05-12 23:40:25 INFO  TaskSetManager:54 - Starting task 0.0 in stage 21.0 (TID 19, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:40:25 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 22 (MapPartitionsRDD[138] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:40:25 INFO  Executor:54 - Running task 0.0 in stage 21.0 (TID 19)
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_68 stored as values in memory (estimated size 11.8 KB, free 360.3 MB)
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_68_piece0 stored as bytes in memory (estimated size 6.0 KB, free 360.3 MB)
2018-05-12 23:40:25 INFO  BlockManagerInfo:54 - Added broadcast_68_piece0 in memory on 192.168.19.162:46196 (size: 6.0 KB, free: 365.8 MB)
2018-05-12 23:40:25 INFO  SparkContext:54 - Created broadcast 68 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:40:25 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 22 (MapPartitionsRDD[138] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:40:25 INFO  TaskSchedulerImpl:54 - Adding task set 22.0 with 1 tasks
2018-05-12 23:40:25 INFO  TaskSetManager:54 - Starting task 0.0 in stage 22.0 (TID 20, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:40:25 INFO  Executor:54 - Running task 0.0 in stage 22.0 (TID 20)
2018-05-12 23:40:25 INFO  Executor:54 - Finished task 0.0 in stage 21.0 (TID 19). 1820 bytes result sent to driver
2018-05-12 23:40:25 INFO  TaskSetManager:54 - Finished task 0.0 in stage 21.0 (TID 19) in 18 ms on localhost (executor driver) (1/1)
2018-05-12 23:40:25 INFO  TaskSchedulerImpl:54 - Removed TaskSet 21.0, whose tasks have all completed, from pool 
2018-05-12 23:40:25 INFO  DAGScheduler:54 - ShuffleMapStage 21 (start at RateStreamStreamJoin.scala:53) finished in 0.033 s
2018-05-12 23:40:25 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:40:25 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 22)
2018-05-12 23:40:25 INFO  DAGScheduler:54 - waiting: Set(ResultStage 23)
2018-05-12 23:40:25 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:40:25 INFO  Executor:54 - Finished task 0.0 in stage 22.0 (TID 20). 1653 bytes result sent to driver
2018-05-12 23:40:25 INFO  TaskSetManager:54 - Finished task 0.0 in stage 22.0 (TID 20) in 18 ms on localhost (executor driver) (1/1)
2018-05-12 23:40:25 INFO  TaskSchedulerImpl:54 - Removed TaskSet 22.0, whose tasks have all completed, from pool 
2018-05-12 23:40:25 INFO  DAGScheduler:54 - ShuffleMapStage 22 (start at RateStreamStreamJoin.scala:53) finished in 0.029 s
2018-05-12 23:40:25 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:40:25 INFO  DAGScheduler:54 - running: Set()
2018-05-12 23:40:25 INFO  DAGScheduler:54 - waiting: Set(ResultStage 23)
2018-05-12 23:40:25 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:40:25 INFO  DAGScheduler:54 - Submitting ResultStage 23 (StateStoreAwareZipPartitionsRDD[145] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_69 stored as values in memory (estimated size 18.0 KB, free 360.3 MB)
2018-05-12 23:40:25 INFO  MemoryStore:54 - Block broadcast_69_piece0 stored as bytes in memory (estimated size 8.9 KB, free 360.3 MB)
2018-05-12 23:40:25 INFO  BlockManagerInfo:54 - Added broadcast_69_piece0 in memory on 192.168.19.162:46196 (size: 8.9 KB, free: 365.8 MB)
2018-05-12 23:40:25 INFO  SparkContext:54 - Created broadcast 69 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:40:25 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 23 (StateStoreAwareZipPartitionsRDD[145] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:40:25 INFO  TaskSchedulerImpl:54 - Adding task set 23.0 with 1 tasks
2018-05-12 23:40:25 INFO  TaskSetManager:54 - Starting task 0.0 in stage 23.0 (TID 21, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 23:40:25 INFO  Executor:54 - Running task 0.0 in stage 23.0 (TID 21)
2018-05-12 23:40:25 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:40:25 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2018-05-12 23:40:25 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:40:25 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2018-05-12 23:40:25 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:25 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:25 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@7222ee65
2018-05-12 23:40:25 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:40:25 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 7 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] for update
2018-05-12 23:40:25 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues)
2018-05-12 23:40:25 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:25 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:25 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@2458adbc
2018-05-12 23:40:25 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:40:25 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 7 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 23:40:25 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue)
2018-05-12 23:40:25 INFO  CodeGenerator:54 - Code generated in 10.220691 ms
2018-05-12 23:40:25 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:25 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:25 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@6f5df51a
2018-05-12 23:40:25 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:40:25 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 7 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] for update
2018-05-12 23:40:25 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues)
2018-05-12 23:40:25 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:25 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:25 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@35a7001d
2018-05-12 23:40:25 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:40:25 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 7 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 23:40:25 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue)
2018-05-12 23:40:25 INFO  CodeGenerator:54 - Code generated in 9.742093 ms
2018-05-12 23:40:25 INFO  CodeGenerator:54 - Code generated in 11.053333 ms
2018-05-12 23:40:25 INFO  HDFSBackedStateStoreProvider:54 - Committed version 8 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues/8.delta
2018-05-12 23:40:25 INFO  HDFSBackedStateStoreProvider:54 - Committed version 8 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue/8.delta
2018-05-12 23:40:25 INFO  HDFSBackedStateStoreProvider:54 - Committed version 8 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues/8.delta
2018-05-12 23:40:25 INFO  HDFSBackedStateStoreProvider:54 - Committed version 8 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue/8.delta
2018-05-12 23:40:25 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 23:40:25 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 23:40:25 INFO  Executor:54 - Finished task 0.0 in stage 23.0 (TID 21). 12146 bytes result sent to driver
2018-05-12 23:40:25 INFO  TaskSetManager:54 - Finished task 0.0 in stage 23.0 (TID 21) in 135 ms on localhost (executor driver) (1/1)
2018-05-12 23:40:25 INFO  TaskSchedulerImpl:54 - Removed TaskSet 23.0, whose tasks have all completed, from pool 
2018-05-12 23:40:25 INFO  DAGScheduler:54 - ResultStage 23 (start at RateStreamStreamJoin.scala:53) finished in 0.156 s
2018-05-12 23:40:25 INFO  DAGScheduler:54 - Job 14 finished: start at RateStreamStreamJoin.scala:53, took 0.211291 s
2018-05-12 23:40:25 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@433db401 is committing.
-------------------------------------------
Batch: 7
-------------------------------------------
+--------------+----------------------+---------+-----------------------+
|impressionAdId|impressionTime        |clickAdId|clickTime              |
+--------------+----------------------+---------+-----------------------+
|706           |2018-05-12 23:39:51.15|706      |2018-05-12 23:39:59.261|
|709           |2018-05-12 23:39:51.75|709      |2018-05-12 23:39:59.861|
|736           |2018-05-12 23:39:57.15|736      |2018-05-12 23:40:05.261|
|772           |2018-05-12 23:40:04.35|772      |2018-05-12 23:40:12.461|
|773           |2018-05-12 23:40:04.55|773      |2018-05-12 23:40:12.661|
|782           |2018-05-12 23:40:06.35|782      |2018-05-12 23:40:14.461|
|785           |2018-05-12 23:40:06.95|785      |2018-05-12 23:40:15.061|
|792           |2018-05-12 23:40:08.35|792      |2018-05-12 23:40:16.461|
|796           |2018-05-12 23:40:09.15|796      |2018-05-12 23:40:17.261|
|809           |2018-05-12 23:40:11.75|809      |2018-05-12 23:40:19.861|
|818           |2018-05-12 23:40:13.55|818      |2018-05-12 23:40:21.661|
|819           |2018-05-12 23:40:13.75|819      |2018-05-12 23:40:21.861|
|614           |2018-05-12 23:39:32.75|null     |null                   |
|632           |2018-05-12 23:39:36.35|null     |null                   |
|536           |2018-05-12 23:39:17.15|null     |null                   |
|616           |2018-05-12 23:39:33.15|null     |null                   |
|537           |2018-05-12 23:39:17.35|null     |null                   |
|563           |2018-05-12 23:39:22.55|null     |null                   |
|615           |2018-05-12 23:39:32.95|null     |null                   |
|595           |2018-05-12 23:39:28.95|null     |null                   |
|622           |2018-05-12 23:39:34.35|null     |null                   |
|626           |2018-05-12 23:39:35.15|null     |null                   |
|625           |2018-05-12 23:39:34.95|null     |null                   |
|608           |2018-05-12 23:39:31.55|null     |null                   |
|612           |2018-05-12 23:39:32.35|null     |null                   |
|592           |2018-05-12 23:39:28.35|null     |null                   |
|552           |2018-05-12 23:39:20.35|null     |null                   |
|619           |2018-05-12 23:39:33.75|null     |null                   |
|565           |2018-05-12 23:39:22.95|null     |null                   |
|527           |2018-05-12 23:39:15.35|null     |null                   |
|533           |2018-05-12 23:39:16.55|null     |null                   |
|627           |2018-05-12 23:39:35.35|null     |null                   |
|544           |2018-05-12 23:39:18.75|null     |null                   |
|526           |2018-05-12 23:39:15.15|null     |null                   |
|618           |2018-05-12 23:39:33.55|null     |null                   |
|560           |2018-05-12 23:39:21.95|null     |null                   |
|514           |2018-05-12 23:39:12.75|null     |null                   |
|511           |2018-05-12 23:39:12.15|null     |null                   |
|519           |2018-05-12 23:39:13.75|null     |null                   |
|623           |2018-05-12 23:39:34.55|null     |null                   |
|591           |2018-05-12 23:39:28.15|null     |null                   |
|556           |2018-05-12 23:39:21.15|null     |null                   |
|579           |2018-05-12 23:39:25.75|null     |null                   |
|620           |2018-05-12 23:39:33.95|null     |null                   |
|607           |2018-05-12 23:39:31.35|null     |null                   |
|601           |2018-05-12 23:39:30.15|null     |null                   |
|631           |2018-05-12 23:39:36.15|null     |null                   |
|547           |2018-05-12 23:39:19.35|null     |null                   |
|551           |2018-05-12 23:39:20.15|null     |null                   |
|599           |2018-05-12 23:39:29.75|null     |null                   |
+--------------+----------------------+---------+-----------------------+
only showing top 50 rows

2018-05-12 23:40:25 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@433db401 committed.
2018-05-12 23:40:25 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:25 INFO  DAGScheduler:54 - Job 15 finished: start at RateStreamStreamJoin.scala:53, took 0.000060 s
2018-05-12 23:40:25 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "f81d0864-a505-45c0-aee1-8bd905d13407",
  "runId" : "cda27f86-f23a-4e61-af81-4993b63777fe",
  "name" : null,
  "timestamp" : "2018-05-13T06:40:25.001Z",
  "batchId" : 7,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 9.99960001599936,
  "processedRowsPerSecond" : 348.18941504178275,
  "durationMs" : {
    "addBatch" : 359,
    "getBatch" : 39,
    "getOffset" : 0,
    "queryPlanning" : 275,
    "triggerExecution" : 718,
    "walCommit" : 39
  },
  "eventTime" : {
    "avg" : "2018-05-13T06:40:12.350Z",
    "max" : "2018-05-13T06:40:24.750Z",
    "min" : "2018-05-13T06:39:59.950Z",
    "watermark" : "2018-05-13T06:39:46.861Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 261,
    "numRowsUpdated" : 137,
    "memoryUsedBytes" : 99342
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 150,
    "endOffset" : 175,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 4.99980000799968,
    "processedRowsPerSecond" : 174.09470752089138
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 149,
    "endOffset" : 174,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 4.99980000799968,
    "processedRowsPerSecond" : 174.09470752089138
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@2736ef4e"
  }
}
2018-05-12 23:40:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@5ec6609d
2018-05-12 23:40:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@3a700a9b
2018-05-12 23:40:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@2fd674c1
2018-05-12 23:40:34 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:34 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:34 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@781e18ff
2018-05-12 23:40:50 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526193611861 ms
2018-05-12 23:40:50 INFO  MicroBatchExecution:54 - Committed offsets for batch 8. Metadata OffsetSeqMetadata(1526193611861,1526193650004,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_70 stored as values in memory (estimated size 277.7 KB, free 360.0 MB)
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_70_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.0 MB)
2018-05-12 23:40:50 INFO  BlockManagerInfo:54 - Added broadcast_70_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:40:50 INFO  SparkContext:54 - Created broadcast 70 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_71 stored as values in memory (estimated size 277.7 KB, free 359.7 MB)
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_71_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.7 MB)
2018-05-12 23:40:50 INFO  BlockManagerInfo:54 - Added broadcast_71_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 23:40:50 INFO  SparkContext:54 - Created broadcast 71 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_72 stored as values in memory (estimated size 277.7 KB, free 359.4 MB)
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_72_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.4 MB)
2018-05-12 23:40:50 INFO  BlockManagerInfo:54 - Added broadcast_72_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 23:40:50 INFO  SparkContext:54 - Created broadcast 72 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:50 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526193611861E12 * 1000.0) as double) + -1.0E7)
2018-05-12 23:40:50 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526193601860
2018-05-12 23:40:50 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526193611861E12 * 1000.0) as double)
2018-05-12 23:40:50 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526193611860
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_73 stored as values in memory (estimated size 277.7 KB, free 359.1 MB)
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_73_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.1 MB)
2018-05-12 23:40:50 INFO  BlockManagerInfo:54 - Added broadcast_73_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 23:40:50 INFO  SparkContext:54 - Created broadcast 73 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_74 stored as values in memory (estimated size 277.7 KB, free 358.8 MB)
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_74_piece0 stored as bytes in memory (estimated size 23.5 KB, free 358.8 MB)
2018-05-12 23:40:50 INFO  BlockManagerInfo:54 - Added broadcast_74_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 23:40:50 INFO  SparkContext:54 - Created broadcast 74 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_75 stored as values in memory (estimated size 277.7 KB, free 358.5 MB)
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_75_piece0 stored as bytes in memory (estimated size 23.5 KB, free 358.5 MB)
2018-05-12 23:40:50 INFO  BlockManagerInfo:54 - Added broadcast_75_piece0 in memory on 192.168.19.162:46196 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 23:40:50 INFO  SparkContext:54 - Created broadcast 75 from start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:50 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@49822fb3. The input RDD has 1 partitions.
2018-05-12 23:40:50 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:50 INFO  DAGScheduler:54 - Registering RDD 162 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:40:50 INFO  DAGScheduler:54 - Registering RDD 157 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:40:50 INFO  DAGScheduler:54 - Got job 16 (start at RateStreamStreamJoin.scala:53) with 1 output partitions
2018-05-12 23:40:50 INFO  DAGScheduler:54 - Final stage: ResultStage 26 (start at RateStreamStreamJoin.scala:53)
2018-05-12 23:40:50 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 24, ShuffleMapStage 25)
2018-05-12 23:40:50 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 24, ShuffleMapStage 25)
2018-05-12 23:40:50 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 24 (MapPartitionsRDD[162] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_76 stored as values in memory (estimated size 15.5 KB, free 358.5 MB)
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_76_piece0 stored as bytes in memory (estimated size 7.4 KB, free 358.5 MB)
2018-05-12 23:40:50 INFO  BlockManagerInfo:54 - Added broadcast_76_piece0 in memory on 192.168.19.162:46196 (size: 7.4 KB, free: 365.6 MB)
2018-05-12 23:40:50 INFO  SparkContext:54 - Created broadcast 76 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:40:50 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 24 (MapPartitionsRDD[162] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:40:50 INFO  TaskSchedulerImpl:54 - Adding task set 24.0 with 1 tasks
2018-05-12 23:40:50 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 25 (MapPartitionsRDD[157] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:40:50 INFO  TaskSetManager:54 - Starting task 0.0 in stage 24.0 (TID 22, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:40:50 INFO  Executor:54 - Running task 0.0 in stage 24.0 (TID 22)
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_77 stored as values in memory (estimated size 11.8 KB, free 358.5 MB)
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_77_piece0 stored as bytes in memory (estimated size 6.0 KB, free 358.5 MB)
2018-05-12 23:40:50 INFO  Executor:54 - Finished task 0.0 in stage 24.0 (TID 22). 1777 bytes result sent to driver
2018-05-12 23:40:50 INFO  BlockManagerInfo:54 - Added broadcast_77_piece0 in memory on 192.168.19.162:46196 (size: 6.0 KB, free: 365.6 MB)
2018-05-12 23:40:50 INFO  TaskSetManager:54 - Finished task 0.0 in stage 24.0 (TID 22) in 77 ms on localhost (executor driver) (1/1)
2018-05-12 23:40:50 INFO  TaskSchedulerImpl:54 - Removed TaskSet 24.0, whose tasks have all completed, from pool 
2018-05-12 23:40:50 INFO  SparkContext:54 - Created broadcast 77 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:40:50 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 25 (MapPartitionsRDD[157] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:40:50 INFO  TaskSchedulerImpl:54 - Adding task set 25.0 with 1 tasks
2018-05-12 23:40:50 INFO  DAGScheduler:54 - ShuffleMapStage 24 (start at RateStreamStreamJoin.scala:53) finished in 0.105 s
2018-05-12 23:40:50 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:40:50 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 25)
2018-05-12 23:40:50 INFO  DAGScheduler:54 - waiting: Set(ResultStage 26)
2018-05-12 23:40:50 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:40:50 INFO  TaskSetManager:54 - Starting task 0.0 in stage 25.0 (TID 23, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 23:40:50 INFO  Executor:54 - Running task 0.0 in stage 25.0 (TID 23)
2018-05-12 23:40:50 INFO  Executor:54 - Finished task 0.0 in stage 25.0 (TID 23). 1653 bytes result sent to driver
2018-05-12 23:40:50 INFO  TaskSetManager:54 - Finished task 0.0 in stage 25.0 (TID 23) in 27 ms on localhost (executor driver) (1/1)
2018-05-12 23:40:50 INFO  TaskSchedulerImpl:54 - Removed TaskSet 25.0, whose tasks have all completed, from pool 
2018-05-12 23:40:50 INFO  DAGScheduler:54 - ShuffleMapStage 25 (start at RateStreamStreamJoin.scala:53) finished in 0.112 s
2018-05-12 23:40:50 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 23:40:50 INFO  DAGScheduler:54 - running: Set()
2018-05-12 23:40:50 INFO  DAGScheduler:54 - waiting: Set(ResultStage 26)
2018-05-12 23:40:50 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 23:40:50 INFO  DAGScheduler:54 - Submitting ResultStage 26 (StateStoreAwareZipPartitionsRDD[164] at start at RateStreamStreamJoin.scala:53), which has no missing parents
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_78 stored as values in memory (estimated size 18.0 KB, free 358.4 MB)
2018-05-12 23:40:50 INFO  MemoryStore:54 - Block broadcast_78_piece0 stored as bytes in memory (estimated size 8.9 KB, free 358.4 MB)
2018-05-12 23:40:50 INFO  BlockManagerInfo:54 - Added broadcast_78_piece0 in memory on 192.168.19.162:46196 (size: 8.9 KB, free: 365.6 MB)
2018-05-12 23:40:50 INFO  SparkContext:54 - Created broadcast 78 from broadcast at DAGScheduler.scala:1039
2018-05-12 23:40:50 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 26 (StateStoreAwareZipPartitionsRDD[164] at start at RateStreamStreamJoin.scala:53) (first 15 tasks are for partitions Vector(0))
2018-05-12 23:40:50 INFO  TaskSchedulerImpl:54 - Adding task set 26.0 with 1 tasks
2018-05-12 23:40:50 INFO  TaskSetManager:54 - Starting task 0.0 in stage 26.0 (TID 24, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 23:40:50 INFO  Executor:54 - Running task 0.0 in stage 26.0 (TID 24)
2018-05-12 23:40:50 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:40:50 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2018-05-12 23:40:50 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 23:40:50 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 23:40:50 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:50 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:50 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@62913bc9
2018-05-12 23:40:50 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:40:50 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 8 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] for update
2018-05-12 23:40:50 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyToNumValues)
2018-05-12 23:40:50 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:50 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:50 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@8b9fb6b
2018-05-12 23:40:50 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:40:50 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 8 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 23:40:50 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,left-keyWithIndexToValue)
2018-05-12 23:40:50 INFO  CodeGenerator:54 - Code generated in 15.8652 ms
2018-05-12 23:40:50 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:50 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:50 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@5fcedf02
2018-05-12 23:40:50 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:40:50 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 8 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] for update
2018-05-12 23:40:50 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyToNumValues)
2018-05-12 23:40:50 INFO  StateStore:54 - Env is not null
2018-05-12 23:40:50 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 23:40:50 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@5508c800
2018-05-12 23:40:50 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue),cda27f86-f23a-4e61-af81-4993b63777fe) is active
2018-05-12 23:40:50 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 8 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 23:40:50 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state,0,0,right-keyWithIndexToValue)
2018-05-12 23:40:50 INFO  CodeGenerator:54 - Code generated in 9.829283 ms
2018-05-12 23:40:50 INFO  CodeGenerator:54 - Code generated in 16.767622 ms
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 704
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 693
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 587
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 599
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 726
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 566
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 663
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 565
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_55_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.7 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 705
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 666
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 681
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 738
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 655
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 700
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 669
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 584
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_62_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.7 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 614
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 673
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 684
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 730
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 718
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 613
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 627
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 721
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 452
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 729
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 451
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 695
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_70_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.7 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 679
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 740
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 731
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 644
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 571
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_54_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.7 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 680
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 711
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 633
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 617
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_77_piece0 on 192.168.19.162:46196 in memory (size: 6.0 KB, free: 365.7 MB)
2018-05-12 23:40:51 INFO  HDFSBackedStateStoreProvider:54 - Committed version 9 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyToNumValues/9.delta
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_45_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:40:51 INFO  HDFSBackedStateStoreProvider:54 - Committed version 9 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/left-keyWithIndexToValue/9.delta
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 739
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 640
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 707
2018-05-12 23:40:51 INFO  HDFSBackedStateStoreProvider:54 - Committed version 9 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyToNumValues/9.delta
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned shuffle 13
2018-05-12 23:40:51 INFO  HDFSBackedStateStoreProvider:54 - Committed version 9 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f/state/0/0/right-keyWithIndexToValue/9.delta
2018-05-12 23:40:51 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 23:40:51 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_73_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 618
2018-05-12 23:40:51 INFO  Executor:54 - Finished task 0.0 in stage 26.0 (TID 24). 12189 bytes result sent to driver
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_66_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 559
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 623
2018-05-12 23:40:51 INFO  TaskSetManager:54 - Finished task 0.0 in stage 26.0 (TID 24) in 411 ms on localhost (executor driver) (1/1)
2018-05-12 23:40:51 INFO  TaskSchedulerImpl:54 - Removed TaskSet 26.0, whose tasks have all completed, from pool 
2018-05-12 23:40:51 INFO  DAGScheduler:54 - ResultStage 26 (start at RateStreamStreamJoin.scala:53) finished in 0.436 s
2018-05-12 23:40:51 INFO  DAGScheduler:54 - Job 16 finished: start at RateStreamStreamJoin.scala:53, took 0.586158 s
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_67_piece0 on 192.168.19.162:46196 in memory (size: 7.4 KB, free: 365.8 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 714
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 622
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 650
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 708
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 457
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 596
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 735
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 546
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 466
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 458
2018-05-12 23:40:51 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@49822fb3 is committing.
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 558
-------------------------------------------
Batch: 8
-------------------------------------------
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 575
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 610
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_52_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 733
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 581
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 676
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 709
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 586
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 677
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 720
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 611
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 561
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 668
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 576
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_56_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 594
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 670
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 448
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 593
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 642
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 589
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 447
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 716
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 548
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 588
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 624
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 595
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 616
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 645
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 568
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 634
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 639
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 583
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 549
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_64_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 742
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 569
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_61_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 699
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 646
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 463
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned shuffle 10
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 625
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 692
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 734
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 629
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 544
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 555
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_48_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 712
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 563
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 682
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 747
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned shuffle 11
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 660
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 635
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 678
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 690
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 648
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 717
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 556
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 638
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 689
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 686
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 665
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 464
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 562
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_71_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 465
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 702
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_53_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 578
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 703
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 550
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 694
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 691
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 685
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 554
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_69_piece0 on 192.168.19.162:46196 in memory (size: 8.9 KB, free: 366.0 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 701
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 582
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 662
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 723
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 715
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 649
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 728
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 606
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 601
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 654
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 628
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 577
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 630
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 732
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 664
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 600
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 461
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 574
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 605
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 657
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_59_piece0 on 192.168.19.162:46196 in memory (size: 6.0 KB, free: 366.0 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 725
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_65_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 683
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 658
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 608
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 585
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 547
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned shuffle 12
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 615
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 652
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 603
+--------------+----------------------+---------+-----------------------+
|impressionAdId|impressionTime        |clickAdId|clickTime              |
+--------------+----------------------+---------+-----------------------+
|831           |2018-05-12 23:40:16.15|831      |2018-05-12 23:40:24.261|
|834           |2018-05-12 23:40:16.75|834      |2018-05-12 23:40:24.861|
|861           |2018-05-12 23:40:22.15|861      |2018-05-12 23:40:30.261|
|897           |2018-05-12 23:40:29.35|897      |2018-05-12 23:40:37.461|
|898           |2018-05-12 23:40:29.55|898      |2018-05-12 23:40:37.661|
|907           |2018-05-12 23:40:31.35|907      |2018-05-12 23:40:39.461|
|910           |2018-05-12 23:40:31.95|910      |2018-05-12 23:40:40.061|
|917           |2018-05-12 23:40:33.35|917      |2018-05-12 23:40:41.461|
|921           |2018-05-12 23:40:34.15|921      |2018-05-12 23:40:42.261|
|934           |2018-05-12 23:40:36.75|934      |2018-05-12 23:40:44.861|
|943           |2018-05-12 23:40:38.55|943      |2018-05-12 23:40:46.661|
|944           |2018-05-12 23:40:38.75|944      |2018-05-12 23:40:46.861|
|714           |2018-05-12 23:39:52.75|null     |null                   |
|743           |2018-05-12 23:39:58.55|null     |null                   |
|653           |2018-05-12 23:39:40.55|null     |null                   |
|645           |2018-05-12 23:39:38.95|null     |null                   |
|754           |2018-05-12 23:40:00.75|null     |null                   |
|747           |2018-05-12 23:39:59.35|null     |null                   |
|673           |2018-05-12 23:39:44.55|null     |null                   |
|707           |2018-05-12 23:39:51.35|null     |null                   |
|718           |2018-05-12 23:39:53.55|null     |null                   |
|661           |2018-05-12 23:39:42.15|null     |null                   |
|711           |2018-05-12 23:39:52.15|null     |null                   |
|679           |2018-05-12 23:39:45.75|null     |null                   |
|695           |2018-05-12 23:39:48.95|null     |null                   |
|751           |2018-05-12 23:40:00.15|null     |null                   |
|687           |2018-05-12 23:39:47.35|null     |null                   |
|724           |2018-05-12 23:39:54.75|null     |null                   |
|705           |2018-05-12 23:39:50.95|null     |null                   |
|639           |2018-05-12 23:39:37.75|null     |null                   |
|677           |2018-05-12 23:39:45.35|null     |null                   |
|741           |2018-05-12 23:39:58.15|null     |null                   |
|662           |2018-05-12 23:39:42.35|null     |null                   |
|710           |2018-05-12 23:39:51.95|null     |null                   |
|730           |2018-05-12 23:39:55.95|null     |null                   |
|756           |2018-05-12 23:40:01.15|null     |null                   |
|688           |2018-05-12 23:39:47.55|null     |null                   |
|749           |2018-05-12 23:39:59.75|null     |null                   |
|721           |2018-05-12 23:39:54.15|null     |null                   |
|753           |2018-05-12 23:40:00.55|null     |null                   |
|723           |2018-05-12 23:39:54.55|null     |null                   |
|685           |2018-05-12 23:39:46.95|null     |null                   |
|664           |2018-05-12 23:39:42.75|null     |null                   |
|686           |2018-05-12 23:39:47.15|null     |null                   |
|652           |2018-05-12 23:39:40.35|null     |null                   |
|675           |2018-05-12 23:39:44.95|null     |null                   |
|727           |2018-05-12 23:39:55.35|null     |null                   |
|752           |2018-05-12 23:40:00.35|null     |null                   |
|681           |2018-05-12 23:39:46.15|null     |null                   |
|669           |2018-05-12 23:39:43.75|null     |null                   |
+--------------+----------------------+---------+-----------------------+
only showing top 50 rows

2018-05-12 23:40:51 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@49822fb3 committed.
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_74_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 724
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 580
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned shuffle 15
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 687
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 579
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 572
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 619
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 459
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 671
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 727
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_58_piece0 on 192.168.19.162:46196 in memory (size: 7.4 KB, free: 366.0 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 453
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 675
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 570
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 651
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 659
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 460
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_63_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 366.1 MB)
2018-05-12 23:40:51 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:53
2018-05-12 23:40:51 INFO  DAGScheduler:54 - Job 17 finished: start at RateStreamStreamJoin.scala:53, took 0.000075 s
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 710
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 722
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 456
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 656
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 573
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 637
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 551
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 602
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 590
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 626
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 698
2018-05-12 23:40:51 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "f81d0864-a505-45c0-aee1-8bd905d13407",
  "runId" : "cda27f86-f23a-4e61-af81-4993b63777fe",
  "name" : null,
  "timestamp" : "2018-05-13T06:40:50.002Z",
  "batchId" : 8,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 9.99960001599936,
  "processedRowsPerSecond" : 210.43771043771045,
  "durationMs" : {
    "addBatch" : 822,
    "getBatch" : 48,
    "getOffset" : 0,
    "queryPlanning" : 274,
    "triggerExecution" : 1188,
    "walCommit" : 40
  },
  "eventTime" : {
    "avg" : "2018-05-13T06:40:37.350Z",
    "max" : "2018-05-13T06:40:49.750Z",
    "min" : "2018-05-13T06:40:24.950Z",
    "watermark" : "2018-05-13T06:40:11.861Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 261,
    "numRowsUpdated" : 137,
    "memoryUsedBytes" : 96718
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 175,
    "endOffset" : 200,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 4.99980000799968,
    "processedRowsPerSecond" : 105.21885521885523
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 174,
    "endOffset" : 199,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 4.99980000799968,
    "processedRowsPerSecond" : 105.21885521885523
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@2736ef4e"
  }
}
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_57_piece0 on 192.168.19.162:46196 in memory (size: 23.5 KB, free: 366.1 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 612
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 736
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 737
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 598
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 706
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_60_piece0 on 192.168.19.162:46196 in memory (size: 8.9 KB, free: 366.1 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 697
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 454
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 746
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 621
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 552
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 560
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 632
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 455
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 467
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 667
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 643
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 641
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 609
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 661
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 719
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 597
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 688
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 631
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 607
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 545
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 462
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 620
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 604
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_68_piece0 on 192.168.19.162:46196 in memory (size: 6.0 KB, free: 366.1 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 553
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 674
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 592
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 696
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 557
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 564
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 713
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 636
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 567
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 591
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 672
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 647
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 743
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 653
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned accumulator 741
2018-05-12 23:40:51 INFO  BlockManagerInfo:54 - Removed broadcast_76_piece0 on 192.168.19.162:46196 in memory (size: 7.4 KB, free: 366.1 MB)
2018-05-12 23:40:51 INFO  ContextCleaner:54 - Cleaned shuffle 14
2018-05-12 23:40:59 INFO  SparkContext:54 - Invoking stop() from shutdown hook
2018-05-12 23:40:59 INFO  AbstractConnector:318 - Stopped Spark@1a6f5124{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2018-05-12 23:41:00 INFO  SparkUI:54 - Stopped Spark web UI at http://192.168.19.162:4040
2018-05-12 23:41:00 INFO  MapOutputTrackerMasterEndpoint:54 - MapOutputTrackerMasterEndpoint stopped!
2018-05-12 23:41:00 INFO  MemoryStore:54 - MemoryStore cleared
2018-05-12 23:41:00 INFO  BlockManager:54 - BlockManager stopped
2018-05-12 23:41:00 INFO  BlockManagerMaster:54 - BlockManagerMaster stopped
2018-05-12 23:41:00 INFO  OutputCommitCoordinator$OutputCommitCoordinatorEndpoint:54 - OutputCommitCoordinator stopped!
2018-05-12 23:41:00 INFO  SparkContext:54 - Successfully stopped SparkContext
2018-05-12 23:41:00 INFO  ShutdownHookManager:54 - Shutdown hook called
2018-05-12 23:41:00 INFO  ShutdownHookManager:54 - Deleting directory /tmp/spark-b0fec0a0-b55a-4041-a3b0-df8abcdec58b
2018-05-12 23:41:00 INFO  ShutdownHookManager:54 - Deleting directory /tmp/temporaryReader-44552868-1607-4168-93a7-d40f1d3ebd20
2018-05-12 23:41:00 INFO  ShutdownHookManager:54 - Deleting directory /tmp/temporary-d5c63364-ed80-4932-88a5-85b40bc51f9f
2018-05-12 23:41:00 INFO  ShutdownHookManager:54 - Deleting directory /tmp/temporaryReader-c7d103e3-ada5-4f74-aef7-93c34d86795a
2018-05-12 23:41:00 INFO  ShutdownHookManager:54 - Deleting directory /tmp/spark-88dd305c-8c1a-4280-8803-c1d447923b7a
