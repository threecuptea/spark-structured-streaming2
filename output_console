2018-05-12 18:10:51 WARN  Utils:66 - Your hostname, ubuntu resolves to a loopback address: 127.0.1.1; using 192.168.19.162 instead (on interface ens33)
2018-05-12 18:10:51 WARN  Utils:66 - Set SPARK_LOCAL_IP if you need to bind to another address
2018-05-12 18:10:52 WARN  NativeCodeLoader:62 - Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
2018-05-12 18:10:52 INFO  SparkContext:54 - Running Spark version 2.3.0
2018-05-12 18:10:52 INFO  SparkContext:54 - Submitted application: RateStreamStreamJoin
2018-05-12 18:10:52 INFO  SecurityManager:54 - Changing view acls to: fandev
2018-05-12 18:10:52 INFO  SecurityManager:54 - Changing modify acls to: fandev
2018-05-12 18:10:52 INFO  SecurityManager:54 - Changing view acls groups to: 
2018-05-12 18:10:52 INFO  SecurityManager:54 - Changing modify acls groups to: 
2018-05-12 18:10:52 INFO  SecurityManager:54 - SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(fandev); groups with view permissions: Set(); users  with modify permissions: Set(fandev); groups with modify permissions: Set()
2018-05-12 18:10:53 INFO  Utils:54 - Successfully started service 'sparkDriver' on port 37633.
2018-05-12 18:10:53 INFO  SparkEnv:54 - Registering MapOutputTracker
2018-05-12 18:10:53 INFO  SparkEnv:54 - Registering BlockManagerMaster
2018-05-12 18:10:53 INFO  BlockManagerMasterEndpoint:54 - Using org.apache.spark.storage.DefaultTopologyMapper for getting topology information
2018-05-12 18:10:53 INFO  BlockManagerMasterEndpoint:54 - BlockManagerMasterEndpoint up
2018-05-12 18:10:53 INFO  DiskBlockManager:54 - Created local directory at /tmp/blockmgr-36fe193a-9e76-4069-807e-64cca42c962d
2018-05-12 18:10:53 INFO  MemoryStore:54 - MemoryStore started with capacity 366.3 MB
2018-05-12 18:10:53 INFO  SparkEnv:54 - Registering OutputCommitCoordinator
2018-05-12 18:10:53 INFO  log:192 - Logging initialized @4433ms
2018-05-12 18:10:53 INFO  Server:346 - jetty-9.3.z-SNAPSHOT
2018-05-12 18:10:53 INFO  Server:414 - Started @4578ms
2018-05-12 18:10:53 INFO  AbstractConnector:278 - Started ServerConnector@2a7b6f69{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2018-05-12 18:10:53 INFO  Utils:54 - Successfully started service 'SparkUI' on port 4040.
2018-05-12 18:10:53 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@30c0ccff{/jobs,null,AVAILABLE,@Spark}
2018-05-12 18:10:53 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2d8f2f3a{/jobs/json,null,AVAILABLE,@Spark}
2018-05-12 18:10:53 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2024293c{/jobs/job,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@c074c0c{/jobs/job/json,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@58a55449{/stages,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5949eba8{/stages/json,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@6e0ff644{/stages/stage,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3c291aad{/stages/stage/json,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2d0566ba{/stages/pool,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@733037{/stages/pool/json,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@7728643a{/storage,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@320e400{/storage/json,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@5167268{/storage/rdd,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1cfd1875{/storage/rdd/json,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@28c0b664{/environment,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2c444798{/environment/json,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@1af7f54a{/executors,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@6ebd78d1{/executors/json,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@436390f4{/executors/threadDump,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@4d157787{/executors/threadDump/json,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@68ed96ca{/static,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@751e664e{/,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@160c3ec1{/api,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@7577b641{/jobs/job/kill,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@3704122f{/stages/stage/kill,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  SparkUI:54 - Bound SparkUI to 0.0.0.0, and started at http://192.168.19.162:4040
2018-05-12 18:10:54 INFO  SparkContext:54 - Added JAR file:/home/fandev/workspace/samples/spark-structured-streaming2/build/libs/spark-structured-streaming2-0.0.1-SNAPSHOT.jar at spark://192.168.19.162:37633/jars/spark-structured-streaming2-0.0.1-SNAPSHOT.jar with timestamp 1526173854136
2018-05-12 18:10:54 INFO  Executor:54 - Starting executor ID driver on host localhost
2018-05-12 18:10:54 INFO  Utils:54 - Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 43174.
2018-05-12 18:10:54 INFO  NettyBlockTransferService:54 - Server created on 192.168.19.162:43174
2018-05-12 18:10:54 INFO  BlockManager:54 - Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
2018-05-12 18:10:54 INFO  BlockManagerMaster:54 - Registering BlockManager BlockManagerId(driver, 192.168.19.162, 43174, None)
2018-05-12 18:10:54 INFO  BlockManagerMasterEndpoint:54 - Registering block manager 192.168.19.162:43174 with 366.3 MB RAM, BlockManagerId(driver, 192.168.19.162, 43174, None)
2018-05-12 18:10:54 INFO  BlockManagerMaster:54 - Registered BlockManager BlockManagerId(driver, 192.168.19.162, 43174, None)
2018-05-12 18:10:54 INFO  BlockManager:54 - Initialized BlockManager: BlockManagerId(driver, 192.168.19.162, 43174, None)
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@682c1e93{/metrics/json,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  SharedState:54 - Setting hive.metastore.warehouse.dir ('null') to the value of spark.sql.warehouse.dir ('file:/home/fandev/workspace/samples/spark-structured-streaming2/spark-warehouse/').
2018-05-12 18:10:54 INFO  SharedState:54 - Warehouse path is 'file:/home/fandev/workspace/samples/spark-structured-streaming2/spark-warehouse/'.
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@4cbd03e7{/SQL,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@52fc5eb1{/SQL/json,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@2a49fe{/SQL/execution,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@66596a88{/SQL/execution/json,null,AVAILABLE,@Spark}
2018-05-12 18:10:54 INFO  ContextHandler:781 - Started o.s.j.s.ServletContextHandler@27f74733{/static/sql,null,AVAILABLE,@Spark}
2018-05-12 18:10:55 INFO  StateStoreCoordinatorRef:54 - Registered StateStoreCoordinator endpoint
Output to console
2018-05-12 18:10:58 INFO  MicroBatchExecution:54 - Starting [id = 0c6f7eb6-4f85-4322-9d17-ad4b241cd696, runId = 1f2f6927-f050-4179-8503-b350fe3ac6a4]. Use file:///tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89 to store the query checkpoint.
2018-05-12 18:10:58 INFO  RateStreamSource:54 - Start time: 1526173858929
2018-05-12 18:10:59 INFO  RateStreamSource:54 - Start time: 1526173858999
2018-05-12 18:10:59 INFO  MicroBatchExecution:54 - Starting new streaming query.
2018-05-12 18:10:59 INFO  MicroBatchExecution:54 - Committed offsets for batch 0. Metadata OffsetSeqMetadata(0,1526173859056,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 18:10:59 INFO  MemoryStore:54 - Block broadcast_0 stored as values in memory (estimated size 277.7 KB, free 366.0 MB)
2018-05-12 18:10:59 INFO  MemoryStore:54 - Block broadcast_0_piece0 stored as bytes in memory (estimated size 23.5 KB, free 366.0 MB)
2018-05-12 18:10:59 INFO  BlockManagerInfo:54 - Added broadcast_0_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.3 MB)
2018-05-12 18:10:59 INFO  SparkContext:54 - Created broadcast 0 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:10:59 INFO  MemoryStore:54 - Block broadcast_1 stored as values in memory (estimated size 277.7 KB, free 365.7 MB)
2018-05-12 18:10:59 INFO  MemoryStore:54 - Block broadcast_1_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.7 MB)
2018-05-12 18:10:59 INFO  BlockManagerInfo:54 - Added broadcast_1_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.3 MB)
2018-05-12 18:10:59 INFO  SparkContext:54 - Created broadcast 1 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:10:59 INFO  MemoryStore:54 - Block broadcast_2 stored as values in memory (estimated size 277.7 KB, free 365.4 MB)
2018-05-12 18:10:59 INFO  MemoryStore:54 - Block broadcast_2_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.4 MB)
2018-05-12 18:10:59 INFO  BlockManagerInfo:54 - Added broadcast_2_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.2 MB)
2018-05-12 18:10:59 INFO  SparkContext:54 - Created broadcast 2 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:10:59 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((0.0 * 1000.0) as double) + -1.0E7)
2018-05-12 18:10:59 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = -10001
2018-05-12 18:10:59 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((0.0 * 1000.0) as double)
2018-05-12 18:10:59 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = -1
2018-05-12 18:10:59 INFO  MemoryStore:54 - Block broadcast_3 stored as values in memory (estimated size 277.7 KB, free 365.1 MB)
2018-05-12 18:10:59 INFO  MemoryStore:54 - Block broadcast_3_piece0 stored as bytes in memory (estimated size 23.5 KB, free 365.1 MB)
2018-05-12 18:10:59 INFO  BlockManagerInfo:54 - Added broadcast_3_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.2 MB)
2018-05-12 18:10:59 INFO  SparkContext:54 - Created broadcast 3 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:10:59 INFO  MemoryStore:54 - Block broadcast_4 stored as values in memory (estimated size 277.7 KB, free 364.9 MB)
2018-05-12 18:10:59 INFO  MemoryStore:54 - Block broadcast_4_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.8 MB)
2018-05-12 18:10:59 INFO  BlockManagerInfo:54 - Added broadcast_4_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.2 MB)
2018-05-12 18:10:59 INFO  SparkContext:54 - Created broadcast 4 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:10:59 INFO  MemoryStore:54 - Block broadcast_5 stored as values in memory (estimated size 277.7 KB, free 364.6 MB)
2018-05-12 18:10:59 INFO  MemoryStore:54 - Block broadcast_5_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.5 MB)
2018-05-12 18:10:59 INFO  BlockManagerInfo:54 - Added broadcast_5_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.2 MB)
2018-05-12 18:10:59 INFO  SparkContext:54 - Created broadcast 5 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:00 INFO  CodeGenerator:54 - Code generated in 221.046596 ms
2018-05-12 18:11:00 INFO  CodeGenerator:54 - Code generated in 30.448165 ms
2018-05-12 18:11:00 INFO  CodeGenerator:54 - Code generated in 16.952751 ms
2018-05-12 18:11:00 INFO  CodeGenerator:54 - Code generated in 18.093156 ms
2018-05-12 18:11:00 INFO  CodeGenerator:54 - Code generated in 16.181068 ms
2018-05-12 18:11:00 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@776436d9. The input RDD has 1 partitions.
2018-05-12 18:11:00 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:00 INFO  DAGScheduler:54 - Registering RDD 6 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:11:00 INFO  DAGScheduler:54 - Registering RDD 12 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:11:00 INFO  DAGScheduler:54 - Got job 0 (start at RateStreamStreamJoin.scala:51) with 1 output partitions
2018-05-12 18:11:00 INFO  DAGScheduler:54 - Final stage: ResultStage 2 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:11:00 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 0, ShuffleMapStage 1)
2018-05-12 18:11:00 INFO  DAGScheduler:54 - Missing parents: List()
2018-05-12 18:11:00 INFO  DAGScheduler:54 - Submitting ResultStage 2 (StateStoreAwareZipPartitionsRDD[14] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:11:01 INFO  MemoryStore:54 - Block broadcast_6 stored as values in memory (estimated size 16.9 KB, free 364.5 MB)
2018-05-12 18:11:01 INFO  MemoryStore:54 - Block broadcast_6_piece0 stored as bytes in memory (estimated size 8.2 KB, free 364.5 MB)
2018-05-12 18:11:01 INFO  BlockManagerInfo:54 - Added broadcast_6_piece0 in memory on 192.168.19.162:43174 (size: 8.2 KB, free: 366.2 MB)
2018-05-12 18:11:01 INFO  SparkContext:54 - Created broadcast 6 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:11:01 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 2 (StateStoreAwareZipPartitionsRDD[14] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:11:01 INFO  TaskSchedulerImpl:54 - Adding task set 2.0 with 1 tasks
2018-05-12 18:11:01 INFO  TaskSetManager:54 - Starting task 0.0 in stage 2.0 (TID 0, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 18:11:01 INFO  Executor:54 - Running task 0.0 in stage 2.0 (TID 0)
2018-05-12 18:11:01 INFO  Executor:54 - Fetching spark://192.168.19.162:37633/jars/spark-structured-streaming2-0.0.1-SNAPSHOT.jar with timestamp 1526173854136
2018-05-12 18:11:01 INFO  TransportClientFactory:267 - Successfully created connection to /192.168.19.162:37633 after 33 ms (0 ms spent in bootstraps)
2018-05-12 18:11:01 INFO  Utils:54 - Fetching spark://192.168.19.162:37633/jars/spark-structured-streaming2-0.0.1-SNAPSHOT.jar to /tmp/spark-f24fcbce-343c-4734-80e6-ada2553e7ced/userFiles-14cc32ef-cff6-4a54-98dc-e977439b225e/fetchFileTemp1591552973804694968.tmp
2018-05-12 18:11:01 INFO  Executor:54 - Adding file:/tmp/spark-f24fcbce-343c-4734-80e6-ada2553e7ced/userFiles-14cc32ef-cff6-4a54-98dc-e977439b225e/spark-structured-streaming2-0.0.1-SNAPSHOT.jar to class loader
2018-05-12 18:11:01 INFO  ShuffleBlockFetcherIterator:54 - Getting 0 non-empty blocks out of 0 blocks
2018-05-12 18:11:01 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 3 ms
2018-05-12 18:11:01 INFO  ShuffleBlockFetcherIterator:54 - Getting 0 non-empty blocks out of 0 blocks
2018-05-12 18:11:01 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2018-05-12 18:11:01 INFO  CodeGenerator:54 - Code generated in 15.920757 ms
2018-05-12 18:11:01 INFO  CodeGenerator:54 - Code generated in 4.215257 ms
2018-05-12 18:11:01 INFO  CodeGenerator:54 - Code generated in 9.476245 ms
2018-05-12 18:11:01 INFO  StateStore:54 - State Store maintenance task started
2018-05-12 18:11:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:11:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:11:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@561159c1
2018-05-12 18:11:01 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:11:01 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 0 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] for update
2018-05-12 18:11:01 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues)
2018-05-12 18:11:01 INFO  CodeGenerator:54 - Code generated in 10.045898 ms
2018-05-12 18:11:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:11:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:11:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@620144e
2018-05-12 18:11:01 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:11:01 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 0 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 18:11:01 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue)
2018-05-12 18:11:01 INFO  CodeGenerator:54 - Code generated in 6.098335 ms
2018-05-12 18:11:01 INFO  CodeGenerator:54 - Code generated in 5.534987 ms
2018-05-12 18:11:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:11:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:11:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@43bbd901
2018-05-12 18:11:01 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:11:01 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 0 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] for update
2018-05-12 18:11:01 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues)
2018-05-12 18:11:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:11:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:11:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@23355c83
2018-05-12 18:11:01 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:11:01 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 0 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 18:11:01 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue)
2018-05-12 18:11:01 INFO  CodeGenerator:54 - Code generated in 6.433216 ms
2018-05-12 18:11:01 INFO  CodeGenerator:54 - Code generated in 5.159161 ms
2018-05-12 18:11:01 INFO  CodeGenerator:54 - Code generated in 10.312913 ms
2018-05-12 18:11:01 INFO  HDFSBackedStateStoreProvider:54 - Committed version 1 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/1.delta
2018-05-12 18:11:01 INFO  HDFSBackedStateStoreProvider:54 - Committed version 1 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/1.delta
2018-05-12 18:11:01 INFO  HDFSBackedStateStoreProvider:54 - Committed version 1 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/1.delta
2018-05-12 18:11:01 INFO  HDFSBackedStateStoreProvider:54 - Committed version 1 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/1.delta
2018-05-12 18:11:01 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 18:11:01 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 18:11:01 INFO  Executor:54 - Finished task 0.0 in stage 2.0 (TID 0). 3352 bytes result sent to driver
2018-05-12 18:11:01 INFO  TaskSetManager:54 - Finished task 0.0 in stage 2.0 (TID 0) in 450 ms on localhost (executor driver) (1/1)
2018-05-12 18:11:01 INFO  DAGScheduler:54 - ResultStage 2 (start at RateStreamStreamJoin.scala:51) finished in 0.525 s
2018-05-12 18:11:01 INFO  DAGScheduler:54 - Job 0 finished: start at RateStreamStreamJoin.scala:51, took 0.585057 s
2018-05-12 18:11:01 INFO  TaskSchedulerImpl:54 - Removed TaskSet 2.0, whose tasks have all completed, from pool 
2018-05-12 18:11:01 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@776436d9 is committing.
-------------------------------------------
Batch: 0
-------------------------------------------
2018-05-12 18:11:01 INFO  CodeGenerator:54 - Code generated in 42.635187 ms
+--------------+--------------+---------+---------+
|impressionAdId|impressionTime|clickAdId|clickTime|
+--------------+--------------+---------+---------+
+--------------+--------------+---------+---------+

2018-05-12 18:11:01 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@776436d9 committed.
2018-05-12 18:11:01 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:01 INFO  DAGScheduler:54 - Job 1 finished: start at RateStreamStreamJoin.scala:51, took 0.000073 s
2018-05-12 18:11:01 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "0c6f7eb6-4f85-4322-9d17-ad4b241cd696",
  "runId" : "1f2f6927-f050-4179-8503-b350fe3ac6a4",
  "name" : null,
  "timestamp" : "2018-05-13T01:10:59.048Z",
  "batchId" : 0,
  "numInputRows" : 0,
  "processedRowsPerSecond" : 0.0,
  "durationMs" : {
    "addBatch" : 1731,
    "getBatch" : 20,
    "getOffset" : 0,
    "queryPlanning" : 781,
    "triggerExecution" : 2598,
    "walCommit" : 46
  },
  "eventTime" : {
    "watermark" : "1970-01-01T00:00:00.000Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 0,
    "numRowsUpdated" : 0,
    "memoryUsedBytes" : 286
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : null,
    "endOffset" : 0,
    "numInputRows" : 0,
    "processedRowsPerSecond" : 0.0
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : null,
    "endOffset" : 0,
    "numInputRows" : 0,
    "processedRowsPerSecond" : 0.0
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@18366d4b"
  }
}
2018-05-12 18:11:15 INFO  MicroBatchExecution:54 - Committed offsets for batch 1. Metadata OffsetSeqMetadata(0,1526173875012,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 18:11:15 INFO  MemoryStore:54 - Block broadcast_7 stored as values in memory (estimated size 277.7 KB, free 364.2 MB)
2018-05-12 18:11:15 INFO  MemoryStore:54 - Block broadcast_7_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.2 MB)
2018-05-12 18:11:15 INFO  BlockManagerInfo:54 - Added broadcast_7_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:11:15 INFO  SparkContext:54 - Created broadcast 7 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:15 INFO  MemoryStore:54 - Block broadcast_8 stored as values in memory (estimated size 277.7 KB, free 363.9 MB)
2018-05-12 18:11:15 INFO  MemoryStore:54 - Block broadcast_8_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.9 MB)
2018-05-12 18:11:15 INFO  BlockManagerInfo:54 - Added broadcast_8_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:11:15 INFO  SparkContext:54 - Created broadcast 8 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:15 INFO  MemoryStore:54 - Block broadcast_9 stored as values in memory (estimated size 277.7 KB, free 363.7 MB)
2018-05-12 18:11:15 INFO  MemoryStore:54 - Block broadcast_9_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.6 MB)
2018-05-12 18:11:15 INFO  BlockManagerInfo:54 - Added broadcast_9_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:11:15 INFO  SparkContext:54 - Created broadcast 9 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:15 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((0.0 * 1000.0) as double) + -1.0E7)
2018-05-12 18:11:15 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = -10001
2018-05-12 18:11:15 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((0.0 * 1000.0) as double)
2018-05-12 18:11:15 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = -1
2018-05-12 18:11:15 INFO  MemoryStore:54 - Block broadcast_10 stored as values in memory (estimated size 277.7 KB, free 363.4 MB)
2018-05-12 18:11:15 INFO  MemoryStore:54 - Block broadcast_10_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.3 MB)
2018-05-12 18:11:15 INFO  BlockManagerInfo:54 - Added broadcast_10_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:11:15 INFO  SparkContext:54 - Created broadcast 10 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:15 INFO  MemoryStore:54 - Block broadcast_11 stored as values in memory (estimated size 277.7 KB, free 363.1 MB)
2018-05-12 18:11:15 INFO  MemoryStore:54 - Block broadcast_11_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.0 MB)
2018-05-12 18:11:15 INFO  BlockManagerInfo:54 - Added broadcast_11_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:11:15 INFO  SparkContext:54 - Created broadcast 11 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:15 INFO  MemoryStore:54 - Block broadcast_12 stored as values in memory (estimated size 277.7 KB, free 362.8 MB)
2018-05-12 18:11:15 INFO  MemoryStore:54 - Block broadcast_12_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.7 MB)
2018-05-12 18:11:15 INFO  BlockManagerInfo:54 - Added broadcast_12_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:11:15 INFO  SparkContext:54 - Created broadcast 12 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:15 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@374ec790. The input RDD has 1 partitions.
2018-05-12 18:11:15 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:15 INFO  DAGScheduler:54 - Registering RDD 33 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:11:15 INFO  DAGScheduler:54 - Registering RDD 27 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:11:15 INFO  DAGScheduler:54 - Got job 2 (start at RateStreamStreamJoin.scala:51) with 1 output partitions
2018-05-12 18:11:15 INFO  DAGScheduler:54 - Final stage: ResultStage 5 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:11:15 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 3, ShuffleMapStage 4)
2018-05-12 18:11:15 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 3, ShuffleMapStage 4)
2018-05-12 18:11:15 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 3 (MapPartitionsRDD[33] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:11:16 INFO  MemoryStore:54 - Block broadcast_13 stored as values in memory (estimated size 18.1 KB, free 362.7 MB)
2018-05-12 18:11:16 INFO  MemoryStore:54 - Block broadcast_13_piece0 stored as bytes in memory (estimated size 7.8 KB, free 362.7 MB)
2018-05-12 18:11:16 INFO  BlockManagerInfo:54 - Added broadcast_13_piece0 in memory on 192.168.19.162:43174 (size: 7.8 KB, free: 366.0 MB)
2018-05-12 18:11:16 INFO  SparkContext:54 - Created broadcast 13 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:11:16 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 3 (MapPartitionsRDD[33] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:11:16 INFO  TaskSchedulerImpl:54 - Adding task set 3.0 with 1 tasks
2018-05-12 18:11:16 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 4 (MapPartitionsRDD[27] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:11:16 INFO  MemoryStore:54 - Block broadcast_14 stored as values in memory (estimated size 15.7 KB, free 362.7 MB)
2018-05-12 18:11:16 INFO  TaskSetManager:54 - Starting task 0.0 in stage 3.0 (TID 1, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:11:16 INFO  Executor:54 - Running task 0.0 in stage 3.0 (TID 1)
2018-05-12 18:11:16 INFO  MemoryStore:54 - Block broadcast_14_piece0 stored as bytes in memory (estimated size 6.7 KB, free 362.7 MB)
2018-05-12 18:11:16 INFO  BlockManagerInfo:54 - Added broadcast_14_piece0 in memory on 192.168.19.162:43174 (size: 6.7 KB, free: 366.0 MB)
2018-05-12 18:11:16 INFO  SparkContext:54 - Created broadcast 14 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:11:16 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 4 (MapPartitionsRDD[27] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:11:16 INFO  TaskSchedulerImpl:54 - Adding task set 4.0 with 1 tasks
2018-05-12 18:11:16 INFO  TaskSetManager:54 - Starting task 0.0 in stage 4.0 (TID 2, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:11:16 INFO  Executor:54 - Running task 0.0 in stage 4.0 (TID 2)
2018-05-12 18:11:16 INFO  CodeGenerator:54 - Code generated in 23.185049 ms
2018-05-12 18:11:16 INFO  CodeGenerator:54 - Code generated in 17.78629 ms
2018-05-12 18:11:16 INFO  CodeGenerator:54 - Code generated in 23.370281 ms
2018-05-12 18:11:16 INFO  Executor:54 - Finished task 0.0 in stage 4.0 (TID 2). 1910 bytes result sent to driver
2018-05-12 18:11:16 INFO  Executor:54 - Finished task 0.0 in stage 3.0 (TID 1). 1972 bytes result sent to driver
2018-05-12 18:11:16 INFO  TaskSetManager:54 - Finished task 0.0 in stage 4.0 (TID 2) in 223 ms on localhost (executor driver) (1/1)
2018-05-12 18:11:16 INFO  TaskSchedulerImpl:54 - Removed TaskSet 4.0, whose tasks have all completed, from pool 
2018-05-12 18:11:16 INFO  DAGScheduler:54 - ShuffleMapStage 4 (start at RateStreamStreamJoin.scala:51) finished in 0.263 s
2018-05-12 18:11:16 INFO  TaskSetManager:54 - Finished task 0.0 in stage 3.0 (TID 1) in 265 ms on localhost (executor driver) (1/1)
2018-05-12 18:11:16 INFO  TaskSchedulerImpl:54 - Removed TaskSet 3.0, whose tasks have all completed, from pool 
2018-05-12 18:11:16 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:11:16 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 3)
2018-05-12 18:11:16 INFO  DAGScheduler:54 - waiting: Set(ResultStage 5)
2018-05-12 18:11:16 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:11:16 INFO  DAGScheduler:54 - ShuffleMapStage 3 (start at RateStreamStreamJoin.scala:51) finished in 0.317 s
2018-05-12 18:11:16 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:11:16 INFO  DAGScheduler:54 - running: Set()
2018-05-12 18:11:16 INFO  DAGScheduler:54 - waiting: Set(ResultStage 5)
2018-05-12 18:11:16 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:11:16 INFO  DAGScheduler:54 - Submitting ResultStage 5 (StateStoreAwareZipPartitionsRDD[35] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:11:16 INFO  MemoryStore:54 - Block broadcast_15 stored as values in memory (estimated size 18.7 KB, free 362.7 MB)
2018-05-12 18:11:16 INFO  MemoryStore:54 - Block broadcast_15_piece0 stored as bytes in memory (estimated size 9.2 KB, free 362.7 MB)
2018-05-12 18:11:16 INFO  BlockManagerInfo:54 - Added broadcast_15_piece0 in memory on 192.168.19.162:43174 (size: 9.2 KB, free: 366.0 MB)
2018-05-12 18:11:16 INFO  SparkContext:54 - Created broadcast 15 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:11:16 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 5 (StateStoreAwareZipPartitionsRDD[35] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:11:16 INFO  TaskSchedulerImpl:54 - Adding task set 5.0 with 1 tasks
2018-05-12 18:11:16 INFO  TaskSetManager:54 - Starting task 0.0 in stage 5.0 (TID 3, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 18:11:16 INFO  Executor:54 - Running task 0.0 in stage 5.0 (TID 3)
2018-05-12 18:11:16 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:11:16 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:11:16 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:11:16 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:11:16 INFO  StateStore:54 - Env is not null
2018-05-12 18:11:16 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:11:16 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@99c1155
2018-05-12 18:11:16 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:11:16 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 1 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] for update
2018-05-12 18:11:16 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues)
2018-05-12 18:11:16 INFO  StateStore:54 - Env is not null
2018-05-12 18:11:16 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:11:16 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@2b792880
2018-05-12 18:11:16 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:11:16 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 1 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 18:11:16 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue)
2018-05-12 18:11:16 INFO  StateStore:54 - Env is not null
2018-05-12 18:11:16 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:11:16 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@36a1577
2018-05-12 18:11:16 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:11:16 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 1 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] for update
2018-05-12 18:11:16 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues)
2018-05-12 18:11:16 INFO  StateStore:54 - Env is not null
2018-05-12 18:11:16 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:11:16 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@5921cc82
2018-05-12 18:11:16 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:11:16 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 1 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 18:11:16 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue)
2018-05-12 18:11:16 INFO  CodeGenerator:54 - Code generated in 21.43199 ms
2018-05-12 18:11:16 INFO  HDFSBackedStateStoreProvider:54 - Committed version 2 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/2.delta
2018-05-12 18:11:16 INFO  HDFSBackedStateStoreProvider:54 - Committed version 2 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/2.delta
2018-05-12 18:11:16 INFO  HDFSBackedStateStoreProvider:54 - Committed version 2 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/2.delta
2018-05-12 18:11:16 INFO  HDFSBackedStateStoreProvider:54 - Committed version 2 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/2.delta
2018-05-12 18:11:16 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 18:11:16 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 18:11:16 INFO  Executor:54 - Finished task 0.0 in stage 5.0 (TID 3). 4993 bytes result sent to driver
2018-05-12 18:11:16 INFO  TaskSetManager:54 - Finished task 0.0 in stage 5.0 (TID 3) in 178 ms on localhost (executor driver) (1/1)
2018-05-12 18:11:16 INFO  TaskSchedulerImpl:54 - Removed TaskSet 5.0, whose tasks have all completed, from pool 
2018-05-12 18:11:16 INFO  DAGScheduler:54 - ResultStage 5 (start at RateStreamStreamJoin.scala:51) finished in 0.214 s
2018-05-12 18:11:16 INFO  DAGScheduler:54 - Job 2 finished: start at RateStreamStreamJoin.scala:51, took 0.563274 s
2018-05-12 18:11:16 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@374ec790 is committing.
-------------------------------------------
Batch: 1
-------------------------------------------
2018-05-12 18:11:16 INFO  CodeGenerator:54 - Code generated in 16.634637 ms
+--------------+-----------------------+---------+-----------------------+
|impressionAdId|impressionTime         |clickAdId|clickTime              |
+--------------+-----------------------+---------+-----------------------+
|13            |2018-05-12 18:11:01.529|13       |2018-05-12 18:11:09.599|
|22            |2018-05-12 18:11:03.329|22       |2018-05-12 18:11:11.399|
+--------------+-----------------------+---------+-----------------------+

2018-05-12 18:11:16 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@374ec790 committed.
2018-05-12 18:11:16 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:16 INFO  DAGScheduler:54 - Job 3 finished: start at RateStreamStreamJoin.scala:51, took 0.000054 s
2018-05-12 18:11:16 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "0c6f7eb6-4f85-4322-9d17-ad4b241cd696",
  "runId" : "1f2f6927-f050-4179-8503-b350fe3ac6a4",
  "name" : null,
  "timestamp" : "2018-05-13T01:11:15.001Z",
  "batchId" : 1,
  "numInputRows" : 160,
  "inputRowsPerSecond" : 10.029461543283395,
  "processedRowsPerSecond" : 98.28009828009829,
  "durationMs" : {
    "addBatch" : 901,
    "getBatch" : 101,
    "getOffset" : 1,
    "queryPlanning" : 467,
    "triggerExecution" : 1628,
    "walCommit" : 144
  },
  "eventTime" : {
    "avg" : "2018-05-13T01:11:06.929Z",
    "max" : "2018-05-13T01:11:14.729Z",
    "min" : "2018-05-13T01:10:59.129Z",
    "watermark" : "1970-01-01T00:00:00.000Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 81,
    "numRowsUpdated" : 81,
    "memoryUsedBytes" : 31214
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 0,
    "endOffset" : 16,
    "numInputRows" : 80,
    "inputRowsPerSecond" : 5.014730771641697,
    "processedRowsPerSecond" : 49.14004914004914
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 0,
    "endOffset" : 16,
    "numInputRows" : 80,
    "inputRowsPerSecond" : 5.014730771641697,
    "processedRowsPerSecond" : 49.14004914004914
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@18366d4b"
  }
}
2018-05-12 18:11:40 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526173861399 ms
2018-05-12 18:11:40 INFO  MicroBatchExecution:54 - Committed offsets for batch 2. Metadata OffsetSeqMetadata(1526173861399,1526173900007,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_16 stored as values in memory (estimated size 277.7 KB, free 362.4 MB)
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_16_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.4 MB)
2018-05-12 18:11:40 INFO  BlockManagerInfo:54 - Added broadcast_16_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:11:40 INFO  SparkContext:54 - Created broadcast 16 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_17 stored as values in memory (estimated size 277.7 KB, free 362.1 MB)
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_17_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.1 MB)
2018-05-12 18:11:40 INFO  BlockManagerInfo:54 - Added broadcast_17_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:11:40 INFO  SparkContext:54 - Created broadcast 17 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_18 stored as values in memory (estimated size 277.7 KB, free 361.8 MB)
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_18_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.8 MB)
2018-05-12 18:11:40 INFO  BlockManagerInfo:54 - Added broadcast_18_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:11:40 INFO  SparkContext:54 - Created broadcast 18 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:40 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526173861399E12 * 1000.0) as double) + -1.0E7)
2018-05-12 18:11:40 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526173851398
2018-05-12 18:11:40 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526173861399E12 * 1000.0) as double)
2018-05-12 18:11:40 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526173861398
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_19 stored as values in memory (estimated size 277.7 KB, free 361.5 MB)
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_19_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.5 MB)
2018-05-12 18:11:40 INFO  BlockManagerInfo:54 - Added broadcast_19_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:11:40 INFO  SparkContext:54 - Created broadcast 19 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_20 stored as values in memory (estimated size 277.7 KB, free 361.2 MB)
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_20_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.2 MB)
2018-05-12 18:11:40 INFO  BlockManagerInfo:54 - Added broadcast_20_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:11:40 INFO  SparkContext:54 - Created broadcast 20 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_21 stored as values in memory (estimated size 277.7 KB, free 360.9 MB)
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_21_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.9 MB)
2018-05-12 18:11:40 INFO  BlockManagerInfo:54 - Added broadcast_21_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:11:40 INFO  SparkContext:54 - Created broadcast 21 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:40 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@71032d39. The input RDD has 1 partitions.
2018-05-12 18:11:40 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:40 INFO  DAGScheduler:54 - Registering RDD 54 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:11:40 INFO  DAGScheduler:54 - Registering RDD 48 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:11:40 INFO  DAGScheduler:54 - Got job 4 (start at RateStreamStreamJoin.scala:51) with 1 output partitions
2018-05-12 18:11:40 INFO  DAGScheduler:54 - Final stage: ResultStage 8 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:11:40 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 6, ShuffleMapStage 7)
2018-05-12 18:11:40 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 6, ShuffleMapStage 7)
2018-05-12 18:11:40 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 6 (MapPartitionsRDD[54] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_22 stored as values in memory (estimated size 18.1 KB, free 360.9 MB)
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_22_piece0 stored as bytes in memory (estimated size 7.8 KB, free 360.9 MB)
2018-05-12 18:11:40 INFO  BlockManagerInfo:54 - Added broadcast_22_piece0 in memory on 192.168.19.162:43174 (size: 7.8 KB, free: 365.8 MB)
2018-05-12 18:11:40 INFO  SparkContext:54 - Created broadcast 22 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:11:40 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 6 (MapPartitionsRDD[54] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:11:40 INFO  TaskSchedulerImpl:54 - Adding task set 6.0 with 1 tasks
2018-05-12 18:11:40 INFO  TaskSetManager:54 - Starting task 0.0 in stage 6.0 (TID 4, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:11:40 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 7 (MapPartitionsRDD[48] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:11:40 INFO  Executor:54 - Running task 0.0 in stage 6.0 (TID 4)
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_23 stored as values in memory (estimated size 15.7 KB, free 360.9 MB)
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_23_piece0 stored as bytes in memory (estimated size 6.7 KB, free 360.9 MB)
2018-05-12 18:11:40 INFO  BlockManagerInfo:54 - Added broadcast_23_piece0 in memory on 192.168.19.162:43174 (size: 6.7 KB, free: 365.8 MB)
2018-05-12 18:11:40 INFO  SparkContext:54 - Created broadcast 23 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:11:40 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 7 (MapPartitionsRDD[48] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:11:40 INFO  TaskSchedulerImpl:54 - Adding task set 7.0 with 1 tasks
2018-05-12 18:11:40 INFO  TaskSetManager:54 - Starting task 0.0 in stage 7.0 (TID 5, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:11:40 INFO  Executor:54 - Running task 0.0 in stage 7.0 (TID 5)
2018-05-12 18:11:40 INFO  Executor:54 - Finished task 0.0 in stage 6.0 (TID 4). 1972 bytes result sent to driver
2018-05-12 18:11:40 INFO  TaskSetManager:54 - Finished task 0.0 in stage 6.0 (TID 4) in 39 ms on localhost (executor driver) (1/1)
2018-05-12 18:11:40 INFO  TaskSchedulerImpl:54 - Removed TaskSet 6.0, whose tasks have all completed, from pool 
2018-05-12 18:11:40 INFO  DAGScheduler:54 - ShuffleMapStage 6 (start at RateStreamStreamJoin.scala:51) finished in 0.064 s
2018-05-12 18:11:40 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:11:40 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 7)
2018-05-12 18:11:40 INFO  DAGScheduler:54 - waiting: Set(ResultStage 8)
2018-05-12 18:11:40 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:11:40 INFO  Executor:54 - Finished task 0.0 in stage 7.0 (TID 5). 1867 bytes result sent to driver
2018-05-12 18:11:40 INFO  TaskSetManager:54 - Finished task 0.0 in stage 7.0 (TID 5) in 38 ms on localhost (executor driver) (1/1)
2018-05-12 18:11:40 INFO  TaskSchedulerImpl:54 - Removed TaskSet 7.0, whose tasks have all completed, from pool 
2018-05-12 18:11:40 INFO  DAGScheduler:54 - ShuffleMapStage 7 (start at RateStreamStreamJoin.scala:51) finished in 0.060 s
2018-05-12 18:11:40 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:11:40 INFO  DAGScheduler:54 - running: Set()
2018-05-12 18:11:40 INFO  DAGScheduler:54 - waiting: Set(ResultStage 8)
2018-05-12 18:11:40 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:11:40 INFO  DAGScheduler:54 - Submitting ResultStage 8 (StateStoreAwareZipPartitionsRDD[56] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_24 stored as values in memory (estimated size 18.7 KB, free 360.8 MB)
2018-05-12 18:11:40 INFO  MemoryStore:54 - Block broadcast_24_piece0 stored as bytes in memory (estimated size 9.2 KB, free 360.8 MB)
2018-05-12 18:11:40 INFO  BlockManagerInfo:54 - Added broadcast_24_piece0 in memory on 192.168.19.162:43174 (size: 9.2 KB, free: 365.8 MB)
2018-05-12 18:11:40 INFO  SparkContext:54 - Created broadcast 24 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:11:40 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 8 (StateStoreAwareZipPartitionsRDD[56] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:11:40 INFO  TaskSchedulerImpl:54 - Adding task set 8.0 with 1 tasks
2018-05-12 18:11:40 INFO  TaskSetManager:54 - Starting task 0.0 in stage 8.0 (TID 6, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 18:11:40 INFO  Executor:54 - Running task 0.0 in stage 8.0 (TID 6)
2018-05-12 18:11:40 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:11:40 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 2 ms
2018-05-12 18:11:40 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:11:40 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:11:40 INFO  StateStore:54 - Env is not null
2018-05-12 18:11:40 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:11:40 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@22a1b31d
2018-05-12 18:11:40 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:11:40 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 2 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] for update
2018-05-12 18:11:40 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues)
2018-05-12 18:11:40 INFO  StateStore:54 - Env is not null
2018-05-12 18:11:40 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:11:40 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@34847c6b
2018-05-12 18:11:40 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:11:40 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 2 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 18:11:40 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue)
2018-05-12 18:11:40 INFO  CodeGenerator:54 - Code generated in 11.242412 ms
2018-05-12 18:11:40 INFO  StateStore:54 - Env is not null
2018-05-12 18:11:40 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:11:40 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@1731905c
2018-05-12 18:11:40 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:11:40 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 2 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] for update
2018-05-12 18:11:40 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues)
2018-05-12 18:11:40 INFO  StateStore:54 - Env is not null
2018-05-12 18:11:40 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:11:40 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@6b6b5be6
2018-05-12 18:11:40 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:11:40 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 2 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 18:11:40 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue)
2018-05-12 18:11:41 INFO  CodeGenerator:54 - Code generated in 14.76128 ms
2018-05-12 18:11:41 INFO  CodeGenerator:54 - Code generated in 12.112436 ms
2018-05-12 18:11:41 INFO  HDFSBackedStateStoreProvider:54 - Committed version 3 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/3.delta
2018-05-12 18:11:41 INFO  HDFSBackedStateStoreProvider:54 - Committed version 3 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/3.delta
2018-05-12 18:11:41 INFO  HDFSBackedStateStoreProvider:54 - Committed version 3 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/3.delta
2018-05-12 18:11:41 INFO  HDFSBackedStateStoreProvider:54 - Committed version 3 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/3.delta
2018-05-12 18:11:41 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 18:11:41 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 18:11:41 INFO  Executor:54 - Finished task 0.0 in stage 8.0 (TID 6). 5772 bytes result sent to driver
2018-05-12 18:11:41 INFO  TaskSetManager:54 - Finished task 0.0 in stage 8.0 (TID 6) in 214 ms on localhost (executor driver) (1/1)
2018-05-12 18:11:41 INFO  TaskSchedulerImpl:54 - Removed TaskSet 8.0, whose tasks have all completed, from pool 
2018-05-12 18:11:41 INFO  DAGScheduler:54 - ResultStage 8 (start at RateStreamStreamJoin.scala:51) finished in 0.254 s
2018-05-12 18:11:41 INFO  DAGScheduler:54 - Job 4 finished: start at RateStreamStreamJoin.scala:51, took 0.360347 s
2018-05-12 18:11:41 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@71032d39 is committing.
-------------------------------------------
Batch: 2
-------------------------------------------
+--------------+-----------------------+---------+-----------------------+
|impressionAdId|impressionTime         |clickAdId|clickTime              |
+--------------+-----------------------+---------+-----------------------+
|53            |2018-05-12 18:11:09.529|53       |2018-05-12 18:11:17.599|
|69            |2018-05-12 18:11:12.729|69       |2018-05-12 18:11:20.799|
|70            |2018-05-12 18:11:12.929|70       |2018-05-12 18:11:20.999|
|79            |2018-05-12 18:11:14.729|79       |2018-05-12 18:11:22.799|
|93            |2018-05-12 18:11:17.529|93       |2018-05-12 18:11:25.599|
|102           |2018-05-12 18:11:19.329|102      |2018-05-12 18:11:27.399|
|123           |2018-05-12 18:11:23.529|123      |2018-05-12 18:11:31.599|
|131           |2018-05-12 18:11:25.129|131      |2018-05-12 18:11:33.199|
|140           |2018-05-12 18:11:26.929|140      |2018-05-12 18:11:34.999|
|144           |2018-05-12 18:11:27.729|144      |2018-05-12 18:11:35.799|
|153           |2018-05-12 18:11:29.529|153      |2018-05-12 18:11:37.599|
+--------------+-----------------------+---------+-----------------------+

2018-05-12 18:11:41 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@71032d39 committed.
2018-05-12 18:11:41 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:11:41 INFO  DAGScheduler:54 - Job 5 finished: start at RateStreamStreamJoin.scala:51, took 0.000064 s
2018-05-12 18:11:41 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "0c6f7eb6-4f85-4322-9d17-ad4b241cd696",
  "runId" : "1f2f6927-f050-4179-8503-b350fe3ac6a4",
  "name" : null,
  "timestamp" : "2018-05-13T01:11:40.002Z",
  "batchId" : 2,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 9.99960001599936,
  "processedRowsPerSecond" : 209.38023450586266,
  "durationMs" : {
    "addBatch" : 631,
    "getBatch" : 53,
    "getOffset" : 0,
    "queryPlanning" : 454,
    "triggerExecution" : 1194,
    "walCommit" : 49
  },
  "eventTime" : {
    "avg" : "2018-05-13T01:11:27.329Z",
    "max" : "2018-05-13T01:11:39.729Z",
    "min" : "2018-05-13T01:11:14.929Z",
    "watermark" : "2018-05-13T01:11:01.399Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 217,
    "numRowsUpdated" : 136,
    "memoryUsedBytes" : 86302
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 16,
    "endOffset" : 41,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 4.99980000799968,
    "processedRowsPerSecond" : 104.69011725293133
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 16,
    "endOffset" : 41,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 4.99980000799968,
    "processedRowsPerSecond" : 104.69011725293133
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@18366d4b"
  }
}
2018-05-12 18:12:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@ce833e0
2018-05-12 18:12:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@34141f35
2018-05-12 18:12:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@4e729052
2018-05-12 18:12:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@7d68de1e
2018-05-12 18:12:05 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526173887599 ms
2018-05-12 18:12:05 INFO  MicroBatchExecution:54 - Committed offsets for batch 3. Metadata OffsetSeqMetadata(1526173887599,1526173925004,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 18:12:05 INFO  MemoryStore:54 - Block broadcast_25 stored as values in memory (estimated size 277.7 KB, free 360.6 MB)
2018-05-12 18:12:05 INFO  MemoryStore:54 - Block broadcast_25_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.5 MB)
2018-05-12 18:12:05 INFO  BlockManagerInfo:54 - Added broadcast_25_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:12:05 INFO  SparkContext:54 - Created broadcast 25 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:05 INFO  MemoryStore:54 - Block broadcast_26 stored as values in memory (estimated size 277.7 KB, free 360.3 MB)
2018-05-12 18:12:05 INFO  MemoryStore:54 - Block broadcast_26_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.2 MB)
2018-05-12 18:12:05 INFO  BlockManagerInfo:54 - Added broadcast_26_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:12:05 INFO  SparkContext:54 - Created broadcast 26 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:05 INFO  MemoryStore:54 - Block broadcast_27 stored as values in memory (estimated size 277.7 KB, free 360.0 MB)
2018-05-12 18:12:05 INFO  MemoryStore:54 - Block broadcast_27_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.9 MB)
2018-05-12 18:12:05 INFO  BlockManagerInfo:54 - Added broadcast_27_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:12:05 INFO  SparkContext:54 - Created broadcast 27 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:05 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526173887599E12 * 1000.0) as double) + -1.0E7)
2018-05-12 18:12:05 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526173877598
2018-05-12 18:12:05 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526173887599E12 * 1000.0) as double)
2018-05-12 18:12:05 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526173887598
2018-05-12 18:12:05 INFO  MemoryStore:54 - Block broadcast_28 stored as values in memory (estimated size 277.7 KB, free 359.7 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 4
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 70
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 110
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 223
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 184
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 227
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 258
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 71
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned shuffle 5
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 95
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 119
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 211
2018-05-12 18:12:06 INFO  MemoryStore:54 - Block broadcast_28_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.7 MB)
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Added broadcast_28_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:12:06 INFO  SparkContext:54 - Created broadcast 28 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:06 INFO  MemoryStore:54 - Block broadcast_29 stored as values in memory (estimated size 277.7 KB, free 359.4 MB)
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_25_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:12:06 INFO  MemoryStore:54 - Block broadcast_29_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.7 MB)
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Added broadcast_29_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:12:06 INFO  SparkContext:54 - Created broadcast 29 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 79
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 146
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 59
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 78
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 124
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 262
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 87
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 131
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 245
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 203
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 91
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 261
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 117
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 104
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 205
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 136
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 214
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 249
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 157
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 159
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_20_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 232
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 108
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 121
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 145
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_23_piece0 on 192.168.19.162:43174 in memory (size: 6.7 KB, free: 365.8 MB)
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_18_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:12:06 INFO  MemoryStore:54 - Block broadcast_30 stored as values in memory (estimated size 277.7 KB, free 359.7 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 130
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 254
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 181
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 178
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 222
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 165
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 218
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 257
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 208
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 259
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 229
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 180
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 54
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 244
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 182
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 246
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 197
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 207
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 153
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 63
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 97
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned shuffle 4
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 72
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 84
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_7_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 134
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_10_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 80
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 56
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 162
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_22_piece0 on 192.168.19.162:43174 in memory (size: 7.8 KB, free: 365.8 MB)
2018-05-12 18:12:06 INFO  MemoryStore:54 - Block broadcast_30_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.6 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 58
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 61
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 112
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Added broadcast_30_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 201
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 69
2018-05-12 18:12:06 INFO  SparkContext:54 - Created broadcast 30 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_15_piece0 on 192.168.19.162:43174 in memory (size: 9.2 KB, free: 365.8 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 175
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 99
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_12_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_9_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 248
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 149
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_19_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_14_piece0 on 192.168.19.162:43174 in memory (size: 6.7 KB, free: 365.9 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 135
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 137
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 189
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 169
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 174
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 141
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 196
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 255
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 98
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 216
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 88
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 138
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 106
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 120
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 115
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 133
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 230
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 199
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 109
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 252
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 142
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 65
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned shuffle 2
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 185
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 128
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 235
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 231
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 74
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 233
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 118
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 73
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 193
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 204
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 238
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 148
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 140
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 152
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 114
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_11_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 85
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 172
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 67
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 122
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 155
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 239
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 228
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 158
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 200
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 176
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 77
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 82
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 129
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 127
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 60
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 161
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 183
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_21_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 251
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 170
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 163
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 186
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 102
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 195
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 226
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 206
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 105
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 132
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 220
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 111
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 194
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 66
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 166
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 168
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 210
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_17_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 217
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 213
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 96
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 240
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_16_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 188
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 147
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 237
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 68
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_26_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 164
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 253
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 256
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 173
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 215
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 221
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 86
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 144
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 202
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 260
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 113
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 150
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 177
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 247
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 187
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 55
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 191
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 212
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 242
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 219
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 179
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 234
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 171
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 198
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 90
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_8_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 156
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 225
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 154
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 62
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 209
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 100
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 123
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 250
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 126
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 64
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 190
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 81
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_24_piece0 on 192.168.19.162:43174 in memory (size: 9.2 KB, free: 366.1 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 57
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 151
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 241
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 125
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_13_piece0 on 192.168.19.162:43174 in memory (size: 7.8 KB, free: 366.1 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 192
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned shuffle 3
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 160
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 92
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 116
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 94
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 76
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 243
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 83
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 93
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 167
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 103
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 107
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 101
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 139
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 236
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 143
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 89
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 75
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 224
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 263
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 21
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 43
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 2
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 18
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 35
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 0
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 44
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 31
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 3
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 8
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 40
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 6
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 39
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 16
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 47
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 49
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 15
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 23
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 42
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 10
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 24
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 13
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 52
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_5_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 51
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_1_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned shuffle 1
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 1
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_6_piece0 on 192.168.19.162:43174 in memory (size: 8.2 KB, free: 366.1 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 34
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned shuffle 0
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 37
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 11
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 27
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 19
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_3_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 50
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 22
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 46
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 17
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 29
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 30
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_2_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.2 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 48
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 41
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 25
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 33
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 36
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 9
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_4_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.2 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 28
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 14
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 12
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 26
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 45
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 38
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 7
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 32
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 53
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 20
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Removed broadcast_0_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.2 MB)
2018-05-12 18:12:06 INFO  ContextCleaner:54 - Cleaned accumulator 5
2018-05-12 18:12:06 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@77bdebbb. The input RDD has 1 partitions.
2018-05-12 18:12:06 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:06 INFO  DAGScheduler:54 - Registering RDD 75 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:12:06 INFO  DAGScheduler:54 - Registering RDD 69 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:12:06 INFO  DAGScheduler:54 - Got job 6 (start at RateStreamStreamJoin.scala:51) with 1 output partitions
2018-05-12 18:12:06 INFO  DAGScheduler:54 - Final stage: ResultStage 11 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:12:06 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 9, ShuffleMapStage 10)
2018-05-12 18:12:06 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 9, ShuffleMapStage 10)
2018-05-12 18:12:06 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 9 (MapPartitionsRDD[75] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:12:06 INFO  MemoryStore:54 - Block broadcast_31 stored as values in memory (estimated size 18.1 KB, free 365.1 MB)
2018-05-12 18:12:06 INFO  MemoryStore:54 - Block broadcast_31_piece0 stored as bytes in memory (estimated size 7.8 KB, free 365.1 MB)
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Added broadcast_31_piece0 in memory on 192.168.19.162:43174 (size: 7.8 KB, free: 366.2 MB)
2018-05-12 18:12:06 INFO  SparkContext:54 - Created broadcast 31 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:12:06 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 9 (MapPartitionsRDD[75] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:12:06 INFO  TaskSchedulerImpl:54 - Adding task set 9.0 with 1 tasks
2018-05-12 18:12:06 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 10 (MapPartitionsRDD[69] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:12:06 INFO  TaskSetManager:54 - Starting task 0.0 in stage 9.0 (TID 7, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:12:06 INFO  Executor:54 - Running task 0.0 in stage 9.0 (TID 7)
2018-05-12 18:12:06 INFO  MemoryStore:54 - Block broadcast_32 stored as values in memory (estimated size 15.7 KB, free 365.1 MB)
2018-05-12 18:12:06 INFO  MemoryStore:54 - Block broadcast_32_piece0 stored as bytes in memory (estimated size 6.7 KB, free 365.1 MB)
2018-05-12 18:12:06 INFO  Executor:54 - Finished task 0.0 in stage 9.0 (TID 7). 1929 bytes result sent to driver
2018-05-12 18:12:06 INFO  TaskSetManager:54 - Finished task 0.0 in stage 9.0 (TID 7) in 19 ms on localhost (executor driver) (1/1)
2018-05-12 18:12:06 INFO  TaskSchedulerImpl:54 - Removed TaskSet 9.0, whose tasks have all completed, from pool 
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Added broadcast_32_piece0 in memory on 192.168.19.162:43174 (size: 6.7 KB, free: 366.2 MB)
2018-05-12 18:12:06 INFO  SparkContext:54 - Created broadcast 32 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:12:06 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 10 (MapPartitionsRDD[69] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:12:06 INFO  TaskSchedulerImpl:54 - Adding task set 10.0 with 1 tasks
2018-05-12 18:12:06 INFO  TaskSetManager:54 - Starting task 0.0 in stage 10.0 (TID 8, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:12:06 INFO  Executor:54 - Running task 0.0 in stage 10.0 (TID 8)
2018-05-12 18:12:06 INFO  DAGScheduler:54 - ShuffleMapStage 9 (start at RateStreamStreamJoin.scala:51) finished in 0.038 s
2018-05-12 18:12:06 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:12:06 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 10)
2018-05-12 18:12:06 INFO  DAGScheduler:54 - waiting: Set(ResultStage 11)
2018-05-12 18:12:06 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:12:06 INFO  Executor:54 - Finished task 0.0 in stage 10.0 (TID 8). 1867 bytes result sent to driver
2018-05-12 18:12:06 INFO  TaskSetManager:54 - Finished task 0.0 in stage 10.0 (TID 8) in 31 ms on localhost (executor driver) (1/1)
2018-05-12 18:12:06 INFO  TaskSchedulerImpl:54 - Removed TaskSet 10.0, whose tasks have all completed, from pool 
2018-05-12 18:12:06 INFO  DAGScheduler:54 - ShuffleMapStage 10 (start at RateStreamStreamJoin.scala:51) finished in 0.057 s
2018-05-12 18:12:06 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:12:06 INFO  DAGScheduler:54 - running: Set()
2018-05-12 18:12:06 INFO  DAGScheduler:54 - waiting: Set(ResultStage 11)
2018-05-12 18:12:06 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:12:06 INFO  DAGScheduler:54 - Submitting ResultStage 11 (StateStoreAwareZipPartitionsRDD[77] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:12:06 INFO  MemoryStore:54 - Block broadcast_33 stored as values in memory (estimated size 18.7 KB, free 365.1 MB)
2018-05-12 18:12:06 INFO  MemoryStore:54 - Block broadcast_33_piece0 stored as bytes in memory (estimated size 9.2 KB, free 365.0 MB)
2018-05-12 18:12:06 INFO  BlockManagerInfo:54 - Added broadcast_33_piece0 in memory on 192.168.19.162:43174 (size: 9.2 KB, free: 366.2 MB)
2018-05-12 18:12:06 INFO  SparkContext:54 - Created broadcast 33 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:12:06 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 11 (StateStoreAwareZipPartitionsRDD[77] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:12:06 INFO  TaskSchedulerImpl:54 - Adding task set 11.0 with 1 tasks
2018-05-12 18:12:06 INFO  TaskSetManager:54 - Starting task 0.0 in stage 11.0 (TID 9, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 18:12:06 INFO  Executor:54 - Running task 0.0 in stage 11.0 (TID 9)
2018-05-12 18:12:06 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:12:06 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2018-05-12 18:12:06 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:12:06 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2018-05-12 18:12:06 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:06 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:06 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@618cbab6
2018-05-12 18:12:06 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:12:06 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 3 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] for update
2018-05-12 18:12:06 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues)
2018-05-12 18:12:06 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:06 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:06 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@7ed9360d
2018-05-12 18:12:06 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:12:06 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 3 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 18:12:06 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue)
2018-05-12 18:12:06 INFO  CodeGenerator:54 - Code generated in 9.250478 ms
2018-05-12 18:12:06 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:06 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:06 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@38c8b6c9
2018-05-12 18:12:06 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:12:06 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 3 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] for update
2018-05-12 18:12:06 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues)
2018-05-12 18:12:06 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:06 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:06 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@18466f23
2018-05-12 18:12:06 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:12:06 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 3 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 18:12:06 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue)
2018-05-12 18:12:06 INFO  CodeGenerator:54 - Code generated in 8.017965 ms
2018-05-12 18:12:06 INFO  CodeGenerator:54 - Code generated in 8.555948 ms
2018-05-12 18:12:06 INFO  HDFSBackedStateStoreProvider:54 - Committed version 4 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/4.delta
2018-05-12 18:12:06 INFO  HDFSBackedStateStoreProvider:54 - Committed version 4 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/4.delta
2018-05-12 18:12:06 INFO  HDFSBackedStateStoreProvider:54 - Committed version 4 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/4.delta
2018-05-12 18:12:06 INFO  HDFSBackedStateStoreProvider:54 - Committed version 4 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/4.delta
2018-05-12 18:12:06 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 18:12:06 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 18:12:06 INFO  Executor:54 - Finished task 0.0 in stage 11.0 (TID 9). 5792 bytes result sent to driver
2018-05-12 18:12:06 INFO  TaskSetManager:54 - Finished task 0.0 in stage 11.0 (TID 9) in 150 ms on localhost (executor driver) (1/1)
2018-05-12 18:12:06 INFO  TaskSchedulerImpl:54 - Removed TaskSet 11.0, whose tasks have all completed, from pool 
2018-05-12 18:12:06 INFO  DAGScheduler:54 - ResultStage 11 (start at RateStreamStreamJoin.scala:51) finished in 0.180 s
2018-05-12 18:12:06 INFO  DAGScheduler:54 - Job 6 finished: start at RateStreamStreamJoin.scala:51, took 0.263984 s
2018-05-12 18:12:06 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@77bdebbb is committing.
-------------------------------------------
Batch: 3
-------------------------------------------
+--------------+-----------------------+---------+-----------------------+
|impressionAdId|impressionTime         |clickAdId|clickTime              |
+--------------+-----------------------+---------+-----------------------+
|178           |2018-05-12 18:11:34.529|178      |2018-05-12 18:11:42.599|
|194           |2018-05-12 18:11:37.729|194      |2018-05-12 18:11:45.799|
|195           |2018-05-12 18:11:37.929|195      |2018-05-12 18:11:45.999|
|204           |2018-05-12 18:11:39.729|204      |2018-05-12 18:11:47.799|
|218           |2018-05-12 18:11:42.529|218      |2018-05-12 18:11:50.599|
|227           |2018-05-12 18:11:44.329|227      |2018-05-12 18:11:52.399|
|248           |2018-05-12 18:11:48.529|248      |2018-05-12 18:11:56.599|
|256           |2018-05-12 18:11:50.129|256      |2018-05-12 18:11:58.199|
|265           |2018-05-12 18:11:51.929|265      |2018-05-12 18:11:59.999|
|269           |2018-05-12 18:11:52.729|269      |2018-05-12 18:12:00.799|
|278           |2018-05-12 18:11:54.529|278      |2018-05-12 18:12:02.599|
+--------------+-----------------------+---------+-----------------------+

2018-05-12 18:12:06 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@77bdebbb committed.
2018-05-12 18:12:06 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:06 INFO  DAGScheduler:54 - Job 7 finished: start at RateStreamStreamJoin.scala:51, took 0.000061 s
2018-05-12 18:12:06 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "0c6f7eb6-4f85-4322-9d17-ad4b241cd696",
  "runId" : "1f2f6927-f050-4179-8503-b350fe3ac6a4",
  "name" : null,
  "timestamp" : "2018-05-13T01:12:05.001Z",
  "batchId" : 3,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 10.00040001600064,
  "processedRowsPerSecond" : 129.66804979253112,
  "durationMs" : {
    "addBatch" : 466,
    "getBatch" : 91,
    "getOffset" : 0,
    "queryPlanning" : 1316,
    "triggerExecution" : 1928,
    "walCommit" : 47
  },
  "eventTime" : {
    "avg" : "2018-05-13T01:11:52.329Z",
    "max" : "2018-05-13T01:12:04.729Z",
    "min" : "2018-05-13T01:11:39.929Z",
    "watermark" : "2018-05-13T01:11:27.599Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 252,
    "numRowsUpdated" : 136,
    "memoryUsedBytes" : 95534
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 41,
    "endOffset" : 66,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.00020000800032,
    "processedRowsPerSecond" : 64.83402489626556
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 41,
    "endOffset" : 66,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.00020000800032,
    "processedRowsPerSecond" : 64.83402489626556
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@18366d4b"
  }
}
2018-05-12 18:12:30 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526173912599 ms
2018-05-12 18:12:30 INFO  MicroBatchExecution:54 - Committed offsets for batch 4. Metadata OffsetSeqMetadata(1526173912599,1526173950002,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_34 stored as values in memory (estimated size 277.7 KB, free 364.8 MB)
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_34_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.8 MB)
2018-05-12 18:12:30 INFO  BlockManagerInfo:54 - Added broadcast_34_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.2 MB)
2018-05-12 18:12:30 INFO  SparkContext:54 - Created broadcast 34 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_35 stored as values in memory (estimated size 277.7 KB, free 364.5 MB)
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_35_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.5 MB)
2018-05-12 18:12:30 INFO  BlockManagerInfo:54 - Added broadcast_35_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:12:30 INFO  SparkContext:54 - Created broadcast 35 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_36 stored as values in memory (estimated size 277.7 KB, free 364.2 MB)
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_36_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.2 MB)
2018-05-12 18:12:30 INFO  BlockManagerInfo:54 - Added broadcast_36_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:12:30 INFO  SparkContext:54 - Created broadcast 36 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:30 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526173912599E12 * 1000.0) as double) + -1.0E7)
2018-05-12 18:12:30 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526173902598
2018-05-12 18:12:30 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526173912599E12 * 1000.0) as double)
2018-05-12 18:12:30 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526173912598
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_37 stored as values in memory (estimated size 277.7 KB, free 363.9 MB)
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_37_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.9 MB)
2018-05-12 18:12:30 INFO  BlockManagerInfo:54 - Added broadcast_37_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:12:30 INFO  SparkContext:54 - Created broadcast 37 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_38 stored as values in memory (estimated size 277.7 KB, free 363.6 MB)
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_38_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.6 MB)
2018-05-12 18:12:30 INFO  BlockManagerInfo:54 - Added broadcast_38_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:12:30 INFO  SparkContext:54 - Created broadcast 38 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_39 stored as values in memory (estimated size 277.7 KB, free 363.3 MB)
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_39_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.3 MB)
2018-05-12 18:12:30 INFO  BlockManagerInfo:54 - Added broadcast_39_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:12:30 INFO  SparkContext:54 - Created broadcast 39 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:30 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@4fce15c1. The input RDD has 1 partitions.
2018-05-12 18:12:30 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:30 INFO  DAGScheduler:54 - Registering RDD 96 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:12:30 INFO  DAGScheduler:54 - Registering RDD 90 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:12:30 INFO  DAGScheduler:54 - Got job 8 (start at RateStreamStreamJoin.scala:51) with 1 output partitions
2018-05-12 18:12:30 INFO  DAGScheduler:54 - Final stage: ResultStage 14 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:12:30 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 12, ShuffleMapStage 13)
2018-05-12 18:12:30 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 12, ShuffleMapStage 13)
2018-05-12 18:12:30 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 12 (MapPartitionsRDD[96] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_40 stored as values in memory (estimated size 18.1 KB, free 363.3 MB)
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_40_piece0 stored as bytes in memory (estimated size 7.8 KB, free 363.3 MB)
2018-05-12 18:12:30 INFO  BlockManagerInfo:54 - Added broadcast_40_piece0 in memory on 192.168.19.162:43174 (size: 7.8 KB, free: 366.0 MB)
2018-05-12 18:12:30 INFO  SparkContext:54 - Created broadcast 40 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:12:30 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 12 (MapPartitionsRDD[96] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:12:30 INFO  TaskSchedulerImpl:54 - Adding task set 12.0 with 1 tasks
2018-05-12 18:12:30 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 13 (MapPartitionsRDD[90] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:12:30 INFO  TaskSetManager:54 - Starting task 0.0 in stage 12.0 (TID 10, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:12:30 INFO  Executor:54 - Running task 0.0 in stage 12.0 (TID 10)
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_41 stored as values in memory (estimated size 15.7 KB, free 363.2 MB)
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_41_piece0 stored as bytes in memory (estimated size 6.7 KB, free 363.2 MB)
2018-05-12 18:12:30 INFO  BlockManagerInfo:54 - Added broadcast_41_piece0 in memory on 192.168.19.162:43174 (size: 6.7 KB, free: 366.0 MB)
2018-05-12 18:12:30 INFO  SparkContext:54 - Created broadcast 41 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:12:30 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 13 (MapPartitionsRDD[90] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:12:30 INFO  TaskSchedulerImpl:54 - Adding task set 13.0 with 1 tasks
2018-05-12 18:12:30 INFO  TaskSetManager:54 - Starting task 0.0 in stage 13.0 (TID 11, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:12:30 INFO  Executor:54 - Running task 0.0 in stage 13.0 (TID 11)
2018-05-12 18:12:30 INFO  Executor:54 - Finished task 0.0 in stage 12.0 (TID 10). 1929 bytes result sent to driver
2018-05-12 18:12:30 INFO  TaskSetManager:54 - Finished task 0.0 in stage 12.0 (TID 10) in 50 ms on localhost (executor driver) (1/1)
2018-05-12 18:12:30 INFO  TaskSchedulerImpl:54 - Removed TaskSet 12.0, whose tasks have all completed, from pool 
2018-05-12 18:12:30 INFO  DAGScheduler:54 - ShuffleMapStage 12 (start at RateStreamStreamJoin.scala:51) finished in 0.069 s
2018-05-12 18:12:30 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:12:30 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 13)
2018-05-12 18:12:30 INFO  DAGScheduler:54 - waiting: Set(ResultStage 14)
2018-05-12 18:12:30 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:12:30 INFO  Executor:54 - Finished task 0.0 in stage 13.0 (TID 11). 1867 bytes result sent to driver
2018-05-12 18:12:30 INFO  TaskSetManager:54 - Finished task 0.0 in stage 13.0 (TID 11) in 63 ms on localhost (executor driver) (1/1)
2018-05-12 18:12:30 INFO  TaskSchedulerImpl:54 - Removed TaskSet 13.0, whose tasks have all completed, from pool 
2018-05-12 18:12:30 INFO  DAGScheduler:54 - ShuffleMapStage 13 (start at RateStreamStreamJoin.scala:51) finished in 0.086 s
2018-05-12 18:12:30 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:12:30 INFO  DAGScheduler:54 - running: Set()
2018-05-12 18:12:30 INFO  DAGScheduler:54 - waiting: Set(ResultStage 14)
2018-05-12 18:12:30 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:12:30 INFO  DAGScheduler:54 - Submitting ResultStage 14 (StateStoreAwareZipPartitionsRDD[98] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_42 stored as values in memory (estimated size 18.7 KB, free 363.2 MB)
2018-05-12 18:12:30 INFO  MemoryStore:54 - Block broadcast_42_piece0 stored as bytes in memory (estimated size 9.2 KB, free 363.2 MB)
2018-05-12 18:12:30 INFO  BlockManagerInfo:54 - Added broadcast_42_piece0 in memory on 192.168.19.162:43174 (size: 9.2 KB, free: 366.0 MB)
2018-05-12 18:12:30 INFO  SparkContext:54 - Created broadcast 42 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:12:30 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 14 (StateStoreAwareZipPartitionsRDD[98] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:12:30 INFO  TaskSchedulerImpl:54 - Adding task set 14.0 with 1 tasks
2018-05-12 18:12:30 INFO  TaskSetManager:54 - Starting task 0.0 in stage 14.0 (TID 12, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 18:12:30 INFO  Executor:54 - Running task 0.0 in stage 14.0 (TID 12)
2018-05-12 18:12:30 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:12:30 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:12:30 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:12:30 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:12:30 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:30 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:30 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@3f129233
2018-05-12 18:12:30 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:12:30 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 4 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] for update
2018-05-12 18:12:30 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues)
2018-05-12 18:12:30 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:30 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:30 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@7e48077b
2018-05-12 18:12:30 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:12:30 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 4 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 18:12:30 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue)
2018-05-12 18:12:30 INFO  CodeGenerator:54 - Code generated in 15.348925 ms
2018-05-12 18:12:30 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:30 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:30 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@6f572ada
2018-05-12 18:12:30 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:12:30 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 4 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] for update
2018-05-12 18:12:30 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues)
2018-05-12 18:12:30 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:30 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:30 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@4e89039e
2018-05-12 18:12:30 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:12:30 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 4 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 18:12:30 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue)
2018-05-12 18:12:30 INFO  CodeGenerator:54 - Code generated in 17.985857 ms
2018-05-12 18:12:30 INFO  CodeGenerator:54 - Code generated in 14.061928 ms
2018-05-12 18:12:30 INFO  HDFSBackedStateStoreProvider:54 - Committed version 5 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/5.delta
2018-05-12 18:12:30 INFO  HDFSBackedStateStoreProvider:54 - Committed version 5 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/5.delta
2018-05-12 18:12:30 INFO  HDFSBackedStateStoreProvider:54 - Committed version 5 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/5.delta
2018-05-12 18:12:30 INFO  HDFSBackedStateStoreProvider:54 - Committed version 5 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/5.delta
2018-05-12 18:12:30 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 18:12:30 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 18:12:30 INFO  Executor:54 - Finished task 0.0 in stage 14.0 (TID 12). 5792 bytes result sent to driver
2018-05-12 18:12:30 INFO  TaskSetManager:54 - Finished task 0.0 in stage 14.0 (TID 12) in 235 ms on localhost (executor driver) (1/1)
2018-05-12 18:12:30 INFO  TaskSchedulerImpl:54 - Removed TaskSet 14.0, whose tasks have all completed, from pool 
2018-05-12 18:12:30 INFO  DAGScheduler:54 - ResultStage 14 (start at RateStreamStreamJoin.scala:51) finished in 0.279 s
2018-05-12 18:12:30 INFO  DAGScheduler:54 - Job 8 finished: start at RateStreamStreamJoin.scala:51, took 0.402432 s
2018-05-12 18:12:31 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@4fce15c1 is committing.
-------------------------------------------
Batch: 4
-------------------------------------------
+--------------+-----------------------+---------+-----------------------+
|impressionAdId|impressionTime         |clickAdId|clickTime              |
+--------------+-----------------------+---------+-----------------------+
|303           |2018-05-12 18:11:59.529|303      |2018-05-12 18:12:07.599|
|319           |2018-05-12 18:12:02.729|319      |2018-05-12 18:12:10.799|
|320           |2018-05-12 18:12:02.929|320      |2018-05-12 18:12:10.999|
|329           |2018-05-12 18:12:04.729|329      |2018-05-12 18:12:12.799|
|343           |2018-05-12 18:12:07.529|343      |2018-05-12 18:12:15.599|
|352           |2018-05-12 18:12:09.329|352      |2018-05-12 18:12:17.399|
|373           |2018-05-12 18:12:13.529|373      |2018-05-12 18:12:21.599|
|381           |2018-05-12 18:12:15.129|381      |2018-05-12 18:12:23.199|
|390           |2018-05-12 18:12:16.929|390      |2018-05-12 18:12:24.999|
|394           |2018-05-12 18:12:17.729|394      |2018-05-12 18:12:25.799|
|403           |2018-05-12 18:12:19.529|403      |2018-05-12 18:12:27.599|
+--------------+-----------------------+---------+-----------------------+

2018-05-12 18:12:31 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@4fce15c1 committed.
2018-05-12 18:12:31 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:31 INFO  DAGScheduler:54 - Job 9 finished: start at RateStreamStreamJoin.scala:51, took 0.000062 s
2018-05-12 18:12:31 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "0c6f7eb6-4f85-4322-9d17-ad4b241cd696",
  "runId" : "1f2f6927-f050-4179-8503-b350fe3ac6a4",
  "name" : null,
  "timestamp" : "2018-05-13T01:12:30.001Z",
  "batchId" : 4,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 10.0,
  "processedRowsPerSecond" : 235.84905660377356,
  "durationMs" : {
    "addBatch" : 649,
    "getBatch" : 43,
    "getOffset" : 0,
    "queryPlanning" : 321,
    "triggerExecution" : 1060,
    "walCommit" : 43
  },
  "eventTime" : {
    "avg" : "2018-05-13T01:12:17.329Z",
    "max" : "2018-05-13T01:12:29.729Z",
    "min" : "2018-05-13T01:12:04.929Z",
    "watermark" : "2018-05-13T01:11:52.599Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 252,
    "numRowsUpdated" : 136,
    "memoryUsedBytes" : 96462
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 66,
    "endOffset" : 91,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 117.92452830188678
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 66,
    "endOffset" : 91,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 117.92452830188678
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@18366d4b"
  }
}
2018-05-12 18:12:55 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526173937599 ms
2018-05-12 18:12:55 INFO  MicroBatchExecution:54 - Committed offsets for batch 5. Metadata OffsetSeqMetadata(1526173937599,1526173975002,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_43 stored as values in memory (estimated size 277.7 KB, free 362.9 MB)
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_43_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.9 MB)
2018-05-12 18:12:55 INFO  BlockManagerInfo:54 - Added broadcast_43_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:12:55 INFO  SparkContext:54 - Created broadcast 43 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_44 stored as values in memory (estimated size 277.7 KB, free 362.6 MB)
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_44_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.6 MB)
2018-05-12 18:12:55 INFO  BlockManagerInfo:54 - Added broadcast_44_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:12:55 INFO  SparkContext:54 - Created broadcast 44 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_45 stored as values in memory (estimated size 277.7 KB, free 362.4 MB)
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_45_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.3 MB)
2018-05-12 18:12:55 INFO  BlockManagerInfo:54 - Added broadcast_45_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:12:55 INFO  SparkContext:54 - Created broadcast 45 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:55 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526173937599E12 * 1000.0) as double) + -1.0E7)
2018-05-12 18:12:55 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526173927598
2018-05-12 18:12:55 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526173937599E12 * 1000.0) as double)
2018-05-12 18:12:55 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526173937598
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_46 stored as values in memory (estimated size 277.7 KB, free 362.1 MB)
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_46_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.0 MB)
2018-05-12 18:12:55 INFO  BlockManagerInfo:54 - Added broadcast_46_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:12:55 INFO  SparkContext:54 - Created broadcast 46 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_47 stored as values in memory (estimated size 277.7 KB, free 361.8 MB)
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_47_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.7 MB)
2018-05-12 18:12:55 INFO  BlockManagerInfo:54 - Added broadcast_47_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:12:55 INFO  SparkContext:54 - Created broadcast 47 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_48 stored as values in memory (estimated size 277.7 KB, free 361.5 MB)
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_48_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.4 MB)
2018-05-12 18:12:55 INFO  BlockManagerInfo:54 - Added broadcast_48_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:12:55 INFO  SparkContext:54 - Created broadcast 48 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:55 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@1596c256. The input RDD has 1 partitions.
2018-05-12 18:12:55 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:55 INFO  DAGScheduler:54 - Registering RDD 117 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:12:55 INFO  DAGScheduler:54 - Registering RDD 111 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:12:55 INFO  DAGScheduler:54 - Got job 10 (start at RateStreamStreamJoin.scala:51) with 1 output partitions
2018-05-12 18:12:55 INFO  DAGScheduler:54 - Final stage: ResultStage 17 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:12:55 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 15, ShuffleMapStage 16)
2018-05-12 18:12:55 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 15, ShuffleMapStage 16)
2018-05-12 18:12:55 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 15 (MapPartitionsRDD[117] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_49 stored as values in memory (estimated size 18.1 KB, free 361.4 MB)
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_49_piece0 stored as bytes in memory (estimated size 7.8 KB, free 361.4 MB)
2018-05-12 18:12:55 INFO  BlockManagerInfo:54 - Added broadcast_49_piece0 in memory on 192.168.19.162:43174 (size: 7.8 KB, free: 365.9 MB)
2018-05-12 18:12:55 INFO  SparkContext:54 - Created broadcast 49 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:12:55 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 15 (MapPartitionsRDD[117] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:12:55 INFO  TaskSchedulerImpl:54 - Adding task set 15.0 with 1 tasks
2018-05-12 18:12:55 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 16 (MapPartitionsRDD[111] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:12:55 INFO  TaskSetManager:54 - Starting task 0.0 in stage 15.0 (TID 13, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:12:55 INFO  Executor:54 - Running task 0.0 in stage 15.0 (TID 13)
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_50 stored as values in memory (estimated size 15.7 KB, free 361.4 MB)
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_50_piece0 stored as bytes in memory (estimated size 6.7 KB, free 361.4 MB)
2018-05-12 18:12:55 INFO  BlockManagerInfo:54 - Added broadcast_50_piece0 in memory on 192.168.19.162:43174 (size: 6.7 KB, free: 365.9 MB)
2018-05-12 18:12:55 INFO  SparkContext:54 - Created broadcast 50 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:12:55 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 16 (MapPartitionsRDD[111] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:12:55 INFO  TaskSchedulerImpl:54 - Adding task set 16.0 with 1 tasks
2018-05-12 18:12:55 INFO  TaskSetManager:54 - Starting task 0.0 in stage 16.0 (TID 14, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:12:55 INFO  Executor:54 - Running task 0.0 in stage 16.0 (TID 14)
2018-05-12 18:12:55 INFO  Executor:54 - Finished task 0.0 in stage 15.0 (TID 13). 1929 bytes result sent to driver
2018-05-12 18:12:55 INFO  TaskSetManager:54 - Finished task 0.0 in stage 15.0 (TID 13) in 29 ms on localhost (executor driver) (1/1)
2018-05-12 18:12:55 INFO  TaskSchedulerImpl:54 - Removed TaskSet 15.0, whose tasks have all completed, from pool 
2018-05-12 18:12:55 INFO  DAGScheduler:54 - ShuffleMapStage 15 (start at RateStreamStreamJoin.scala:51) finished in 0.048 s
2018-05-12 18:12:55 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:12:55 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 16)
2018-05-12 18:12:55 INFO  DAGScheduler:54 - waiting: Set(ResultStage 17)
2018-05-12 18:12:55 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:12:55 INFO  Executor:54 - Finished task 0.0 in stage 16.0 (TID 14). 1867 bytes result sent to driver
2018-05-12 18:12:55 INFO  TaskSetManager:54 - Finished task 0.0 in stage 16.0 (TID 14) in 30 ms on localhost (executor driver) (1/1)
2018-05-12 18:12:55 INFO  TaskSchedulerImpl:54 - Removed TaskSet 16.0, whose tasks have all completed, from pool 
2018-05-12 18:12:55 INFO  DAGScheduler:54 - ShuffleMapStage 16 (start at RateStreamStreamJoin.scala:51) finished in 0.051 s
2018-05-12 18:12:55 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:12:55 INFO  DAGScheduler:54 - running: Set()
2018-05-12 18:12:55 INFO  DAGScheduler:54 - waiting: Set(ResultStage 17)
2018-05-12 18:12:55 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:12:55 INFO  DAGScheduler:54 - Submitting ResultStage 17 (StateStoreAwareZipPartitionsRDD[119] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_51 stored as values in memory (estimated size 18.7 KB, free 361.4 MB)
2018-05-12 18:12:55 INFO  MemoryStore:54 - Block broadcast_51_piece0 stored as bytes in memory (estimated size 9.2 KB, free 361.4 MB)
2018-05-12 18:12:55 INFO  BlockManagerInfo:54 - Added broadcast_51_piece0 in memory on 192.168.19.162:43174 (size: 9.2 KB, free: 365.9 MB)
2018-05-12 18:12:55 INFO  SparkContext:54 - Created broadcast 51 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:12:55 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 17 (StateStoreAwareZipPartitionsRDD[119] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:12:55 INFO  TaskSchedulerImpl:54 - Adding task set 17.0 with 1 tasks
2018-05-12 18:12:55 INFO  TaskSetManager:54 - Starting task 0.0 in stage 17.0 (TID 15, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 18:12:55 INFO  Executor:54 - Running task 0.0 in stage 17.0 (TID 15)
2018-05-12 18:12:55 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:12:55 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:12:55 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:12:55 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:12:55 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:55 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:55 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@bfd5011
2018-05-12 18:12:55 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:12:55 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 5 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] for update
2018-05-12 18:12:55 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues)
2018-05-12 18:12:55 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:55 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:55 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@6a12f86a
2018-05-12 18:12:55 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:12:55 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 5 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 18:12:55 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue)
2018-05-12 18:12:55 INFO  CodeGenerator:54 - Code generated in 14.156119 ms
2018-05-12 18:12:55 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:55 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:55 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@4f1a2fda
2018-05-12 18:12:55 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:12:55 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 5 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] for update
2018-05-12 18:12:55 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues)
2018-05-12 18:12:55 INFO  StateStore:54 - Env is not null
2018-05-12 18:12:55 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:12:55 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@7f406dfd
2018-05-12 18:12:55 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:12:55 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 5 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 18:12:55 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue)
2018-05-12 18:12:55 INFO  CodeGenerator:54 - Code generated in 12.76041 ms
2018-05-12 18:12:55 INFO  CodeGenerator:54 - Code generated in 13.172006 ms
2018-05-12 18:12:55 INFO  HDFSBackedStateStoreProvider:54 - Committed version 6 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/6.delta
2018-05-12 18:12:55 INFO  HDFSBackedStateStoreProvider:54 - Committed version 6 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/6.delta
2018-05-12 18:12:55 INFO  HDFSBackedStateStoreProvider:54 - Committed version 6 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/6.delta
2018-05-12 18:12:55 INFO  HDFSBackedStateStoreProvider:54 - Committed version 6 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/6.delta
2018-05-12 18:12:55 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 18:12:55 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 18:12:55 INFO  Executor:54 - Finished task 0.0 in stage 17.0 (TID 15). 5792 bytes result sent to driver
2018-05-12 18:12:55 INFO  TaskSetManager:54 - Finished task 0.0 in stage 17.0 (TID 15) in 217 ms on localhost (executor driver) (1/1)
2018-05-12 18:12:55 INFO  TaskSchedulerImpl:54 - Removed TaskSet 17.0, whose tasks have all completed, from pool 
2018-05-12 18:12:55 INFO  DAGScheduler:54 - ResultStage 17 (start at RateStreamStreamJoin.scala:51) finished in 0.255 s
2018-05-12 18:12:55 INFO  DAGScheduler:54 - Job 10 finished: start at RateStreamStreamJoin.scala:51, took 0.345399 s
2018-05-12 18:12:55 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@1596c256 is committing.
-------------------------------------------
Batch: 5
-------------------------------------------
+--------------+-----------------------+---------+-----------------------+
|impressionAdId|impressionTime         |clickAdId|clickTime              |
+--------------+-----------------------+---------+-----------------------+
|428           |2018-05-12 18:12:24.529|428      |2018-05-12 18:12:32.599|
|444           |2018-05-12 18:12:27.729|444      |2018-05-12 18:12:35.799|
|445           |2018-05-12 18:12:27.929|445      |2018-05-12 18:12:35.999|
|454           |2018-05-12 18:12:29.729|454      |2018-05-12 18:12:37.799|
|468           |2018-05-12 18:12:32.529|468      |2018-05-12 18:12:40.599|
|477           |2018-05-12 18:12:34.329|477      |2018-05-12 18:12:42.399|
|498           |2018-05-12 18:12:38.529|498      |2018-05-12 18:12:46.599|
|506           |2018-05-12 18:12:40.129|506      |2018-05-12 18:12:48.199|
|515           |2018-05-12 18:12:41.929|515      |2018-05-12 18:12:49.999|
|519           |2018-05-12 18:12:42.729|519      |2018-05-12 18:12:50.799|
|528           |2018-05-12 18:12:44.529|528      |2018-05-12 18:12:52.599|
+--------------+-----------------------+---------+-----------------------+

2018-05-12 18:12:55 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@1596c256 committed.
2018-05-12 18:12:56 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:12:56 INFO  DAGScheduler:54 - Job 11 finished: start at RateStreamStreamJoin.scala:51, took 0.000084 s
2018-05-12 18:12:56 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "0c6f7eb6-4f85-4322-9d17-ad4b241cd696",
  "runId" : "1f2f6927-f050-4179-8503-b350fe3ac6a4",
  "name" : null,
  "timestamp" : "2018-05-13T01:12:55.001Z",
  "batchId" : 5,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 10.0,
  "processedRowsPerSecond" : 247.27992087042534,
  "durationMs" : {
    "addBatch" : 590,
    "getBatch" : 48,
    "getOffset" : 0,
    "queryPlanning" : 325,
    "triggerExecution" : 1011,
    "walCommit" : 41
  },
  "eventTime" : {
    "avg" : "2018-05-13T01:12:42.329Z",
    "max" : "2018-05-13T01:12:54.729Z",
    "min" : "2018-05-13T01:12:29.929Z",
    "watermark" : "2018-05-13T01:12:17.599Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 252,
    "numRowsUpdated" : 136,
    "memoryUsedBytes" : 98014
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 91,
    "endOffset" : 116,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 123.63996043521267
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 91,
    "endOffset" : 116,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 123.63996043521267
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@18366d4b"
  }
}
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 566
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 529
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 559
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 450
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 313
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 445
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 320
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 471
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 427
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 423
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 455
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 463
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 426
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_35_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 469
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 512
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 296
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 410
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 421
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 462
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 293
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 362
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 377
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 413
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 416
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 461
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 302
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 518
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 429
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 347
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 425
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 451
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 502
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 330
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 433
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 440
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_43_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 328
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 449
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 453
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 540
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 448
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 515
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 363
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 500
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 510
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 541
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 375
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 334
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 422
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 439
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 516
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 447
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_42_piece0 on 192.168.19.162:43174 in memory (size: 9.2 KB, free: 365.9 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 467
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 437
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 552
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 513
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 430
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 380
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 424
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 553
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 315
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 505
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 520
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 307
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_47_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 369
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 305
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 314
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 335
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 360
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 290
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 312
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 310
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 326
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 414
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 507
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 316
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 545
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 346
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 504
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 543
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 555
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 317
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 466
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 519
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 343
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_39_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 573
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 319
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 332
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 405
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 403
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 536
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 396
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 409
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 499
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 295
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 468
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 509
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_36_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_37_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 411
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 547
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 297
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 351
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_40_piece0 on 192.168.19.162:43174 in memory (size: 7.8 KB, free: 366.0 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 523
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_34_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 397
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 534
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 300
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 524
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 569
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 444
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 561
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 370
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 401
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_41_piece0 on 192.168.19.162:43174 in memory (size: 6.7 KB, free: 366.0 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 359
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 542
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned shuffle 9
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 391
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 339
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 344
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_33_piece0 on 192.168.19.162:43174 in memory (size: 9.2 KB, free: 366.1 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 348
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 336
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 392
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 358
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 503
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 365
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 381
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 386
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 560
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 325
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 443
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 267
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 294
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 506
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 475
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 549
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 458
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 292
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 350
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 417
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 368
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 398
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 354
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 557
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 266
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 501
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 323
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 367
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 436
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 298
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 402
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 383
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 567
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_31_piece0 on 192.168.19.162:43174 in memory (size: 7.8 KB, free: 366.1 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 395
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 532
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 327
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 345
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_38_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 554
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 376
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 406
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 420
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 308
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 394
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_51_piece0 on 192.168.19.162:43174 in memory (size: 9.2 KB, free: 366.1 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 331
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 528
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 352
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 353
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_46_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 306
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 304
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 464
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 546
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 418
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 388
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 537
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 460
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 366
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 382
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 521
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 399
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 311
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 291
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 340
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 544
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 441
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 527
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 400
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 299
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 337
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 361
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 446
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 562
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 538
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_50_piece0 on 192.168.19.162:43174 in memory (size: 6.7 KB, free: 366.1 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 357
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 539
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 570
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 435
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 393
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 415
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 511
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 456
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 373
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 452
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 324
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 387
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_29_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 389
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 550
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 474
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 374
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 329
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 355
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 530
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 438
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 371
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 333
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 459
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 526
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 551
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 318
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 322
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 533
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 535
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 428
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 556
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 531
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 558
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 465
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 378
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 454
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 407
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 514
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 309
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 341
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 301
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 457
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 419
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 522
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 321
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_44_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.2 MB)
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_32_piece0 on 192.168.19.162:43174 in memory (size: 6.7 KB, free: 366.2 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 431
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 379
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 384
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 303
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 349
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 525
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 338
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 342
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 385
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned shuffle 8
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 390
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 434
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 565
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 412
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 517
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 408
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 564
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 563
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 442
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 404
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 432
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 498
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 572
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 548
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 372
2018-05-12 18:12:56 INFO  BlockManagerInfo:54 - Removed broadcast_49_piece0 on 192.168.19.162:43174 in memory (size: 7.8 KB, free: 366.2 MB)
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 568
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 508
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 571
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 364
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 356
2018-05-12 18:12:56 INFO  ContextCleaner:54 - Cleaned accumulator 470
2018-05-12 18:13:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:13:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:13:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@5d9a498
2018-05-12 18:13:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:13:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:13:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@11a0eea1
2018-05-12 18:13:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:13:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:13:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@4b8a1cc7
2018-05-12 18:13:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:13:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:13:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@70a9b386
2018-05-12 18:13:20 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526173962599 ms
2018-05-12 18:13:20 INFO  MicroBatchExecution:54 - Committed offsets for batch 6. Metadata OffsetSeqMetadata(1526173962599,1526174000002,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_52 stored as values in memory (estimated size 277.7 KB, free 364.6 MB)
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_52_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.5 MB)
2018-05-12 18:13:20 INFO  BlockManagerInfo:54 - Added broadcast_52_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.2 MB)
2018-05-12 18:13:20 INFO  SparkContext:54 - Created broadcast 52 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_53 stored as values in memory (estimated size 277.7 KB, free 364.3 MB)
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_53_piece0 stored as bytes in memory (estimated size 23.5 KB, free 364.2 MB)
2018-05-12 18:13:20 INFO  BlockManagerInfo:54 - Added broadcast_53_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:13:20 INFO  SparkContext:54 - Created broadcast 53 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_54 stored as values in memory (estimated size 277.7 KB, free 364.0 MB)
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_54_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.9 MB)
2018-05-12 18:13:20 INFO  BlockManagerInfo:54 - Added broadcast_54_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:13:20 INFO  SparkContext:54 - Created broadcast 54 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:20 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526173962599E12 * 1000.0) as double) + -1.0E7)
2018-05-12 18:13:20 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526173952598
2018-05-12 18:13:20 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526173962599E12 * 1000.0) as double)
2018-05-12 18:13:20 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526173962598
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_55 stored as values in memory (estimated size 277.7 KB, free 363.7 MB)
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_55_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.7 MB)
2018-05-12 18:13:20 INFO  BlockManagerInfo:54 - Added broadcast_55_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:13:20 INFO  SparkContext:54 - Created broadcast 55 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_56 stored as values in memory (estimated size 277.7 KB, free 363.4 MB)
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_56_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.4 MB)
2018-05-12 18:13:20 INFO  BlockManagerInfo:54 - Added broadcast_56_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:13:20 INFO  SparkContext:54 - Created broadcast 56 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_57 stored as values in memory (estimated size 277.7 KB, free 363.1 MB)
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_57_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.1 MB)
2018-05-12 18:13:20 INFO  BlockManagerInfo:54 - Added broadcast_57_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:13:20 INFO  SparkContext:54 - Created broadcast 57 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:20 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@7b5e3972. The input RDD has 1 partitions.
2018-05-12 18:13:20 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:20 INFO  DAGScheduler:54 - Registering RDD 138 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:13:20 INFO  DAGScheduler:54 - Registering RDD 132 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:13:20 INFO  DAGScheduler:54 - Got job 12 (start at RateStreamStreamJoin.scala:51) with 1 output partitions
2018-05-12 18:13:20 INFO  DAGScheduler:54 - Final stage: ResultStage 20 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:13:20 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 19, ShuffleMapStage 18)
2018-05-12 18:13:20 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 19, ShuffleMapStage 18)
2018-05-12 18:13:20 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 18 (MapPartitionsRDD[138] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_58 stored as values in memory (estimated size 18.1 KB, free 363.0 MB)
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_58_piece0 stored as bytes in memory (estimated size 7.8 KB, free 363.0 MB)
2018-05-12 18:13:20 INFO  BlockManagerInfo:54 - Added broadcast_58_piece0 in memory on 192.168.19.162:43174 (size: 7.8 KB, free: 366.0 MB)
2018-05-12 18:13:20 INFO  SparkContext:54 - Created broadcast 58 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:13:20 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 18 (MapPartitionsRDD[138] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:13:20 INFO  TaskSchedulerImpl:54 - Adding task set 18.0 with 1 tasks
2018-05-12 18:13:20 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 19 (MapPartitionsRDD[132] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:13:20 INFO  TaskSetManager:54 - Starting task 0.0 in stage 18.0 (TID 16, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:13:20 INFO  Executor:54 - Running task 0.0 in stage 18.0 (TID 16)
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_59 stored as values in memory (estimated size 15.7 KB, free 363.0 MB)
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_59_piece0 stored as bytes in memory (estimated size 6.7 KB, free 363.0 MB)
2018-05-12 18:13:20 INFO  BlockManagerInfo:54 - Added broadcast_59_piece0 in memory on 192.168.19.162:43174 (size: 6.7 KB, free: 366.0 MB)
2018-05-12 18:13:20 INFO  SparkContext:54 - Created broadcast 59 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:13:20 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 19 (MapPartitionsRDD[132] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:13:20 INFO  Executor:54 - Finished task 0.0 in stage 18.0 (TID 16). 1929 bytes result sent to driver
2018-05-12 18:13:20 INFO  TaskSchedulerImpl:54 - Adding task set 19.0 with 1 tasks
2018-05-12 18:13:20 INFO  TaskSetManager:54 - Finished task 0.0 in stage 18.0 (TID 16) in 20 ms on localhost (executor driver) (1/1)
2018-05-12 18:13:20 INFO  TaskSchedulerImpl:54 - Removed TaskSet 18.0, whose tasks have all completed, from pool 
2018-05-12 18:13:20 INFO  DAGScheduler:54 - ShuffleMapStage 18 (start at RateStreamStreamJoin.scala:51) finished in 0.036 s
2018-05-12 18:13:20 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:13:20 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 19)
2018-05-12 18:13:20 INFO  DAGScheduler:54 - waiting: Set(ResultStage 20)
2018-05-12 18:13:20 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:13:20 INFO  TaskSetManager:54 - Starting task 0.0 in stage 19.0 (TID 17, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:13:20 INFO  Executor:54 - Running task 0.0 in stage 19.0 (TID 17)
2018-05-12 18:13:20 INFO  Executor:54 - Finished task 0.0 in stage 19.0 (TID 17). 1867 bytes result sent to driver
2018-05-12 18:13:20 INFO  TaskSetManager:54 - Finished task 0.0 in stage 19.0 (TID 17) in 18 ms on localhost (executor driver) (1/1)
2018-05-12 18:13:20 INFO  TaskSchedulerImpl:54 - Removed TaskSet 19.0, whose tasks have all completed, from pool 
2018-05-12 18:13:20 INFO  DAGScheduler:54 - ShuffleMapStage 19 (start at RateStreamStreamJoin.scala:51) finished in 0.044 s
2018-05-12 18:13:20 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:13:20 INFO  DAGScheduler:54 - running: Set()
2018-05-12 18:13:20 INFO  DAGScheduler:54 - waiting: Set(ResultStage 20)
2018-05-12 18:13:20 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:13:20 INFO  DAGScheduler:54 - Submitting ResultStage 20 (StateStoreAwareZipPartitionsRDD[140] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_60 stored as values in memory (estimated size 18.7 KB, free 363.0 MB)
2018-05-12 18:13:20 INFO  MemoryStore:54 - Block broadcast_60_piece0 stored as bytes in memory (estimated size 9.2 KB, free 363.0 MB)
2018-05-12 18:13:20 INFO  BlockManagerInfo:54 - Added broadcast_60_piece0 in memory on 192.168.19.162:43174 (size: 9.2 KB, free: 366.0 MB)
2018-05-12 18:13:20 INFO  SparkContext:54 - Created broadcast 60 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:13:20 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 20 (StateStoreAwareZipPartitionsRDD[140] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:13:20 INFO  TaskSchedulerImpl:54 - Adding task set 20.0 with 1 tasks
2018-05-12 18:13:20 INFO  TaskSetManager:54 - Starting task 0.0 in stage 20.0 (TID 18, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 18:13:20 INFO  Executor:54 - Running task 0.0 in stage 20.0 (TID 18)
2018-05-12 18:13:20 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:13:20 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:13:20 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:13:20 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:13:20 INFO  StateStore:54 - Env is not null
2018-05-12 18:13:20 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:13:20 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@67d45a6f
2018-05-12 18:13:20 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:13:20 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 6 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] for update
2018-05-12 18:13:20 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues)
2018-05-12 18:13:20 INFO  StateStore:54 - Env is not null
2018-05-12 18:13:20 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:13:20 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@7ff03e57
2018-05-12 18:13:20 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:13:20 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 6 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 18:13:20 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue)
2018-05-12 18:13:20 INFO  CodeGenerator:54 - Code generated in 9.058777 ms
2018-05-12 18:13:20 INFO  StateStore:54 - Env is not null
2018-05-12 18:13:20 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:13:20 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@304da404
2018-05-12 18:13:20 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:13:20 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 6 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] for update
2018-05-12 18:13:20 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues)
2018-05-12 18:13:20 INFO  StateStore:54 - Env is not null
2018-05-12 18:13:20 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:13:20 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@598b1aae
2018-05-12 18:13:20 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:13:20 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 6 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 18:13:20 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue)
2018-05-12 18:13:20 INFO  CodeGenerator:54 - Code generated in 9.262657 ms
2018-05-12 18:13:20 INFO  CodeGenerator:54 - Code generated in 9.237347 ms
2018-05-12 18:13:20 INFO  HDFSBackedStateStoreProvider:54 - Committed version 7 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/7.delta
2018-05-12 18:13:20 INFO  HDFSBackedStateStoreProvider:54 - Committed version 7 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/7.delta
2018-05-12 18:13:20 INFO  HDFSBackedStateStoreProvider:54 - Committed version 7 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/7.delta
2018-05-12 18:13:20 INFO  HDFSBackedStateStoreProvider:54 - Committed version 7 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/7.delta
2018-05-12 18:13:20 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 18:13:20 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 18:13:20 INFO  Executor:54 - Finished task 0.0 in stage 20.0 (TID 18). 5792 bytes result sent to driver
2018-05-12 18:13:20 INFO  TaskSetManager:54 - Finished task 0.0 in stage 20.0 (TID 18) in 154 ms on localhost (executor driver) (1/1)
2018-05-12 18:13:20 INFO  TaskSchedulerImpl:54 - Removed TaskSet 20.0, whose tasks have all completed, from pool 
2018-05-12 18:13:20 INFO  DAGScheduler:54 - ResultStage 20 (start at RateStreamStreamJoin.scala:51) finished in 0.188 s
2018-05-12 18:13:20 INFO  DAGScheduler:54 - Job 12 finished: start at RateStreamStreamJoin.scala:51, took 0.258758 s
2018-05-12 18:13:20 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@7b5e3972 is committing.
-------------------------------------------
Batch: 6
-------------------------------------------
+--------------+-----------------------+---------+-----------------------+
|impressionAdId|impressionTime         |clickAdId|clickTime              |
+--------------+-----------------------+---------+-----------------------+
|553           |2018-05-12 18:12:49.529|553      |2018-05-12 18:12:57.599|
|569           |2018-05-12 18:12:52.729|569      |2018-05-12 18:13:00.799|
|570           |2018-05-12 18:12:52.929|570      |2018-05-12 18:13:00.999|
|579           |2018-05-12 18:12:54.729|579      |2018-05-12 18:13:02.799|
|593           |2018-05-12 18:12:57.529|593      |2018-05-12 18:13:05.599|
|602           |2018-05-12 18:12:59.329|602      |2018-05-12 18:13:07.399|
|623           |2018-05-12 18:13:03.529|623      |2018-05-12 18:13:11.599|
|631           |2018-05-12 18:13:05.129|631      |2018-05-12 18:13:13.199|
|640           |2018-05-12 18:13:06.929|640      |2018-05-12 18:13:14.999|
|644           |2018-05-12 18:13:07.729|644      |2018-05-12 18:13:15.799|
|653           |2018-05-12 18:13:09.529|653      |2018-05-12 18:13:17.599|
+--------------+-----------------------+---------+-----------------------+

2018-05-12 18:13:20 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@7b5e3972 committed.
2018-05-12 18:13:20 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:20 INFO  DAGScheduler:54 - Job 13 finished: start at RateStreamStreamJoin.scala:51, took 0.000062 s
2018-05-12 18:13:20 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "0c6f7eb6-4f85-4322-9d17-ad4b241cd696",
  "runId" : "1f2f6927-f050-4179-8503-b350fe3ac6a4",
  "name" : null,
  "timestamp" : "2018-05-13T01:13:20.001Z",
  "batchId" : 6,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 10.0,
  "processedRowsPerSecond" : 313.2832080200501,
  "durationMs" : {
    "addBatch" : 421,
    "getBatch" : 42,
    "getOffset" : 0,
    "queryPlanning" : 286,
    "triggerExecution" : 798,
    "walCommit" : 45
  },
  "eventTime" : {
    "avg" : "2018-05-13T01:13:07.329Z",
    "max" : "2018-05-13T01:13:19.729Z",
    "min" : "2018-05-13T01:12:54.929Z",
    "watermark" : "2018-05-13T01:12:42.599Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 252,
    "numRowsUpdated" : 136,
    "memoryUsedBytes" : 93742
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 116,
    "endOffset" : 141,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 156.64160401002505
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 116,
    "endOffset" : 141,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 156.64160401002505
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@18366d4b"
  }
}
2018-05-12 18:13:45 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526173987599 ms
2018-05-12 18:13:45 INFO  MicroBatchExecution:54 - Committed offsets for batch 7. Metadata OffsetSeqMetadata(1526173987599,1526174025003,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_61 stored as values in memory (estimated size 277.7 KB, free 362.7 MB)
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_61_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.7 MB)
2018-05-12 18:13:45 INFO  BlockManagerInfo:54 - Added broadcast_61_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:13:45 INFO  SparkContext:54 - Created broadcast 61 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_62 stored as values in memory (estimated size 277.7 KB, free 362.4 MB)
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_62_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.4 MB)
2018-05-12 18:13:45 INFO  BlockManagerInfo:54 - Added broadcast_62_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:13:45 INFO  SparkContext:54 - Created broadcast 62 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_63 stored as values in memory (estimated size 277.7 KB, free 362.1 MB)
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_63_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.1 MB)
2018-05-12 18:13:45 INFO  BlockManagerInfo:54 - Added broadcast_63_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:13:45 INFO  SparkContext:54 - Created broadcast 63 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:45 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526173987599E12 * 1000.0) as double) + -1.0E7)
2018-05-12 18:13:45 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526173977598
2018-05-12 18:13:45 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526173987599E12 * 1000.0) as double)
2018-05-12 18:13:45 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526173987598
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_64 stored as values in memory (estimated size 277.7 KB, free 361.8 MB)
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_64_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.8 MB)
2018-05-12 18:13:45 INFO  BlockManagerInfo:54 - Added broadcast_64_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:13:45 INFO  SparkContext:54 - Created broadcast 64 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_65 stored as values in memory (estimated size 277.7 KB, free 361.5 MB)
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_65_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.5 MB)
2018-05-12 18:13:45 INFO  BlockManagerInfo:54 - Added broadcast_65_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:13:45 INFO  SparkContext:54 - Created broadcast 65 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_66 stored as values in memory (estimated size 277.7 KB, free 361.2 MB)
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_66_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.2 MB)
2018-05-12 18:13:45 INFO  BlockManagerInfo:54 - Added broadcast_66_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:13:45 INFO  SparkContext:54 - Created broadcast 66 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:45 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@5912e21c. The input RDD has 1 partitions.
2018-05-12 18:13:45 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:45 INFO  DAGScheduler:54 - Registering RDD 153 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:13:45 INFO  DAGScheduler:54 - Registering RDD 159 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:13:45 INFO  DAGScheduler:54 - Got job 14 (start at RateStreamStreamJoin.scala:51) with 1 output partitions
2018-05-12 18:13:45 INFO  DAGScheduler:54 - Final stage: ResultStage 23 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:13:45 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 21, ShuffleMapStage 22)
2018-05-12 18:13:45 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 21, ShuffleMapStage 22)
2018-05-12 18:13:45 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 21 (MapPartitionsRDD[153] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_67 stored as values in memory (estimated size 15.7 KB, free 361.2 MB)
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_67_piece0 stored as bytes in memory (estimated size 6.7 KB, free 361.2 MB)
2018-05-12 18:13:45 INFO  BlockManagerInfo:54 - Added broadcast_67_piece0 in memory on 192.168.19.162:43174 (size: 6.7 KB, free: 365.9 MB)
2018-05-12 18:13:45 INFO  SparkContext:54 - Created broadcast 67 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:13:45 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 21 (MapPartitionsRDD[153] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:13:45 INFO  TaskSchedulerImpl:54 - Adding task set 21.0 with 1 tasks
2018-05-12 18:13:45 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 22 (MapPartitionsRDD[159] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:13:45 INFO  TaskSetManager:54 - Starting task 0.0 in stage 21.0 (TID 19, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:13:45 INFO  Executor:54 - Running task 0.0 in stage 21.0 (TID 19)
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_68 stored as values in memory (estimated size 18.1 KB, free 361.2 MB)
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_68_piece0 stored as bytes in memory (estimated size 7.8 KB, free 361.2 MB)
2018-05-12 18:13:45 INFO  BlockManagerInfo:54 - Added broadcast_68_piece0 in memory on 192.168.19.162:43174 (size: 7.8 KB, free: 365.9 MB)
2018-05-12 18:13:45 INFO  SparkContext:54 - Created broadcast 68 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:13:45 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 22 (MapPartitionsRDD[159] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:13:45 INFO  TaskSchedulerImpl:54 - Adding task set 22.0 with 1 tasks
2018-05-12 18:13:45 INFO  TaskSetManager:54 - Starting task 0.0 in stage 22.0 (TID 20, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:13:45 INFO  Executor:54 - Running task 0.0 in stage 22.0 (TID 20)
2018-05-12 18:13:45 INFO  Executor:54 - Finished task 0.0 in stage 21.0 (TID 19). 1867 bytes result sent to driver
2018-05-12 18:13:45 INFO  Executor:54 - Finished task 0.0 in stage 22.0 (TID 20). 1929 bytes result sent to driver
2018-05-12 18:13:45 INFO  TaskSetManager:54 - Finished task 0.0 in stage 21.0 (TID 19) in 88 ms on localhost (executor driver) (1/1)
2018-05-12 18:13:45 INFO  TaskSchedulerImpl:54 - Removed TaskSet 21.0, whose tasks have all completed, from pool 
2018-05-12 18:13:45 INFO  TaskSetManager:54 - Finished task 0.0 in stage 22.0 (TID 20) in 25 ms on localhost (executor driver) (1/1)
2018-05-12 18:13:45 INFO  DAGScheduler:54 - ShuffleMapStage 21 (start at RateStreamStreamJoin.scala:51) finished in 0.175 s
2018-05-12 18:13:45 INFO  TaskSchedulerImpl:54 - Removed TaskSet 22.0, whose tasks have all completed, from pool 
2018-05-12 18:13:45 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:13:45 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 22)
2018-05-12 18:13:45 INFO  DAGScheduler:54 - waiting: Set(ResultStage 23)
2018-05-12 18:13:45 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:13:45 INFO  DAGScheduler:54 - ShuffleMapStage 22 (start at RateStreamStreamJoin.scala:51) finished in 0.097 s
2018-05-12 18:13:45 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:13:45 INFO  DAGScheduler:54 - running: Set()
2018-05-12 18:13:45 INFO  DAGScheduler:54 - waiting: Set(ResultStage 23)
2018-05-12 18:13:45 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:13:45 INFO  DAGScheduler:54 - Submitting ResultStage 23 (StateStoreAwareZipPartitionsRDD[161] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_69 stored as values in memory (estimated size 18.7 KB, free 361.2 MB)
2018-05-12 18:13:45 INFO  MemoryStore:54 - Block broadcast_69_piece0 stored as bytes in memory (estimated size 9.2 KB, free 361.2 MB)
2018-05-12 18:13:45 INFO  BlockManagerInfo:54 - Added broadcast_69_piece0 in memory on 192.168.19.162:43174 (size: 9.2 KB, free: 365.9 MB)
2018-05-12 18:13:45 INFO  SparkContext:54 - Created broadcast 69 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:13:45 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 23 (StateStoreAwareZipPartitionsRDD[161] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:13:45 INFO  TaskSchedulerImpl:54 - Adding task set 23.0 with 1 tasks
2018-05-12 18:13:45 INFO  TaskSetManager:54 - Starting task 0.0 in stage 23.0 (TID 21, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 18:13:45 INFO  Executor:54 - Running task 0.0 in stage 23.0 (TID 21)
2018-05-12 18:13:45 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:13:45 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:13:45 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:13:45 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:13:45 INFO  StateStore:54 - Env is not null
2018-05-12 18:13:45 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:13:45 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@7181f446
2018-05-12 18:13:45 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:13:45 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 7 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] for update
2018-05-12 18:13:45 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues)
2018-05-12 18:13:45 INFO  StateStore:54 - Env is not null
2018-05-12 18:13:45 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:13:45 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@7779f845
2018-05-12 18:13:45 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:13:45 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 7 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 18:13:45 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue)
2018-05-12 18:13:45 INFO  CodeGenerator:54 - Code generated in 9.083758 ms
2018-05-12 18:13:45 INFO  StateStore:54 - Env is not null
2018-05-12 18:13:45 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:13:45 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@441ed727
2018-05-12 18:13:45 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:13:45 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 7 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] for update
2018-05-12 18:13:45 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues)
2018-05-12 18:13:45 INFO  StateStore:54 - Env is not null
2018-05-12 18:13:45 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:13:45 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@68a129a0
2018-05-12 18:13:45 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:13:45 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 7 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 18:13:45 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue)
2018-05-12 18:13:45 INFO  CodeGenerator:54 - Code generated in 8.582073 ms
2018-05-12 18:13:45 INFO  CodeGenerator:54 - Code generated in 11.486957 ms
2018-05-12 18:13:45 INFO  HDFSBackedStateStoreProvider:54 - Committed version 8 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/8.delta
2018-05-12 18:13:45 INFO  HDFSBackedStateStoreProvider:54 - Committed version 8 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/8.delta
2018-05-12 18:13:45 INFO  HDFSBackedStateStoreProvider:54 - Committed version 8 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/8.delta
2018-05-12 18:13:45 INFO  HDFSBackedStateStoreProvider:54 - Committed version 8 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/8.delta
2018-05-12 18:13:45 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 18:13:45 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 18:13:45 INFO  Executor:54 - Finished task 0.0 in stage 23.0 (TID 21). 5835 bytes result sent to driver
2018-05-12 18:13:45 INFO  TaskSetManager:54 - Finished task 0.0 in stage 23.0 (TID 21) in 142 ms on localhost (executor driver) (1/1)
2018-05-12 18:13:45 INFO  TaskSchedulerImpl:54 - Removed TaskSet 23.0, whose tasks have all completed, from pool 
2018-05-12 18:13:45 INFO  DAGScheduler:54 - ResultStage 23 (start at RateStreamStreamJoin.scala:51) finished in 0.174 s
2018-05-12 18:13:45 INFO  DAGScheduler:54 - Job 14 finished: start at RateStreamStreamJoin.scala:51, took 0.368619 s
2018-05-12 18:13:45 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@5912e21c is committing.
-------------------------------------------
Batch: 7
-------------------------------------------
+--------------+-----------------------+---------+-----------------------+
|impressionAdId|impressionTime         |clickAdId|clickTime              |
+--------------+-----------------------+---------+-----------------------+
|678           |2018-05-12 18:13:14.529|678      |2018-05-12 18:13:22.599|
|694           |2018-05-12 18:13:17.729|694      |2018-05-12 18:13:25.799|
|695           |2018-05-12 18:13:17.929|695      |2018-05-12 18:13:25.999|
|704           |2018-05-12 18:13:19.729|704      |2018-05-12 18:13:27.799|
|718           |2018-05-12 18:13:22.529|718      |2018-05-12 18:13:30.599|
|727           |2018-05-12 18:13:24.329|727      |2018-05-12 18:13:32.399|
|748           |2018-05-12 18:13:28.529|748      |2018-05-12 18:13:36.599|
|756           |2018-05-12 18:13:30.129|756      |2018-05-12 18:13:38.199|
|765           |2018-05-12 18:13:31.929|765      |2018-05-12 18:13:39.999|
|769           |2018-05-12 18:13:32.729|769      |2018-05-12 18:13:40.799|
|778           |2018-05-12 18:13:34.529|778      |2018-05-12 18:13:42.599|
+--------------+-----------------------+---------+-----------------------+

2018-05-12 18:13:45 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@5912e21c committed.
2018-05-12 18:13:45 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:13:45 INFO  DAGScheduler:54 - Job 15 finished: start at RateStreamStreamJoin.scala:51, took 0.000068 s
2018-05-12 18:13:45 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "0c6f7eb6-4f85-4322-9d17-ad4b241cd696",
  "runId" : "1f2f6927-f050-4179-8503-b350fe3ac6a4",
  "name" : null,
  "timestamp" : "2018-05-13T01:13:45.002Z",
  "batchId" : 7,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 9.99960001599936,
  "processedRowsPerSecond" : 252.27043390514632,
  "durationMs" : {
    "addBatch" : 594,
    "getBatch" : 40,
    "getOffset" : 0,
    "queryPlanning" : 310,
    "triggerExecution" : 991,
    "walCommit" : 43
  },
  "eventTime" : {
    "avg" : "2018-05-13T01:13:32.329Z",
    "max" : "2018-05-13T01:13:44.729Z",
    "min" : "2018-05-13T01:13:19.929Z",
    "watermark" : "2018-05-13T01:13:07.599Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 252,
    "numRowsUpdated" : 136,
    "memoryUsedBytes" : 89422
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 141,
    "endOffset" : 166,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 4.99980000799968,
    "processedRowsPerSecond" : 126.13521695257316
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 141,
    "endOffset" : 166,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 4.99980000799968,
    "processedRowsPerSecond" : 126.13521695257316
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@18366d4b"
  }
}
2018-05-12 18:14:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:14:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:14:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@381c246f
2018-05-12 18:14:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:14:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:14:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@2edf102b
2018-05-12 18:14:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:14:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:14:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@35285d13
2018-05-12 18:14:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:14:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:14:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@820fdb3
2018-05-12 18:14:10 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526174012599 ms
2018-05-12 18:14:10 INFO  MicroBatchExecution:54 - Committed offsets for batch 8. Metadata OffsetSeqMetadata(1526174012599,1526174050003,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_70 stored as values in memory (estimated size 277.7 KB, free 360.9 MB)
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_70_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.9 MB)
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Added broadcast_70_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:14:10 INFO  SparkContext:54 - Created broadcast 70 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_71 stored as values in memory (estimated size 277.7 KB, free 360.6 MB)
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_71_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.6 MB)
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Added broadcast_71_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:14:10 INFO  SparkContext:54 - Created broadcast 71 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_72 stored as values in memory (estimated size 277.7 KB, free 360.3 MB)
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_72_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.3 MB)
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Added broadcast_72_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:14:10 INFO  SparkContext:54 - Created broadcast 72 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:10 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526174012599E12 * 1000.0) as double) + -1.0E7)
2018-05-12 18:14:10 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526174002598
2018-05-12 18:14:10 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526174012599E12 * 1000.0) as double)
2018-05-12 18:14:10 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526174012598
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_73 stored as values in memory (estimated size 277.7 KB, free 360.0 MB)
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_73_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.0 MB)
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Added broadcast_73_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:14:10 INFO  SparkContext:54 - Created broadcast 73 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_74 stored as values in memory (estimated size 277.7 KB, free 359.7 MB)
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_74_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.7 MB)
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Added broadcast_74_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:14:10 INFO  SparkContext:54 - Created broadcast 74 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_75 stored as values in memory (estimated size 277.7 KB, free 359.4 MB)
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_75_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.4 MB)
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Added broadcast_75_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:14:10 INFO  SparkContext:54 - Created broadcast 75 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:10 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@60ed2514. The input RDD has 1 partitions.
2018-05-12 18:14:10 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:10 INFO  DAGScheduler:54 - Registering RDD 174 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:14:10 INFO  DAGScheduler:54 - Registering RDD 180 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:14:10 INFO  DAGScheduler:54 - Got job 16 (start at RateStreamStreamJoin.scala:51) with 1 output partitions
2018-05-12 18:14:10 INFO  DAGScheduler:54 - Final stage: ResultStage 26 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:14:10 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 24, ShuffleMapStage 25)
2018-05-12 18:14:10 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 24, ShuffleMapStage 25)
2018-05-12 18:14:10 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 24 (MapPartitionsRDD[174] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_76 stored as values in memory (estimated size 15.7 KB, free 359.4 MB)
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_76_piece0 stored as bytes in memory (estimated size 6.7 KB, free 359.4 MB)
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Added broadcast_76_piece0 in memory on 192.168.19.162:43174 (size: 6.7 KB, free: 365.7 MB)
2018-05-12 18:14:10 INFO  SparkContext:54 - Created broadcast 76 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:14:10 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 24 (MapPartitionsRDD[174] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:14:10 INFO  TaskSchedulerImpl:54 - Adding task set 24.0 with 1 tasks
2018-05-12 18:14:10 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 25 (MapPartitionsRDD[180] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:14:10 INFO  TaskSetManager:54 - Starting task 0.0 in stage 24.0 (TID 22, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:14:10 INFO  Executor:54 - Running task 0.0 in stage 24.0 (TID 22)
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_77 stored as values in memory (estimated size 18.1 KB, free 359.3 MB)
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_77_piece0 stored as bytes in memory (estimated size 7.8 KB, free 359.3 MB)
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Added broadcast_77_piece0 in memory on 192.168.19.162:43174 (size: 7.8 KB, free: 365.7 MB)
2018-05-12 18:14:10 INFO  SparkContext:54 - Created broadcast 77 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:14:10 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 25 (MapPartitionsRDD[180] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:14:10 INFO  TaskSchedulerImpl:54 - Adding task set 25.0 with 1 tasks
2018-05-12 18:14:10 INFO  TaskSetManager:54 - Starting task 0.0 in stage 25.0 (TID 23, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:14:10 INFO  Executor:54 - Running task 0.0 in stage 25.0 (TID 23)
2018-05-12 18:14:10 INFO  Executor:54 - Finished task 0.0 in stage 24.0 (TID 22). 1867 bytes result sent to driver
2018-05-12 18:14:10 INFO  TaskSetManager:54 - Finished task 0.0 in stage 24.0 (TID 22) in 31 ms on localhost (executor driver) (1/1)
2018-05-12 18:14:10 INFO  TaskSchedulerImpl:54 - Removed TaskSet 24.0, whose tasks have all completed, from pool 
2018-05-12 18:14:10 INFO  DAGScheduler:54 - ShuffleMapStage 24 (start at RateStreamStreamJoin.scala:51) finished in 0.050 s
2018-05-12 18:14:10 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:14:10 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 25)
2018-05-12 18:14:10 INFO  DAGScheduler:54 - waiting: Set(ResultStage 26)
2018-05-12 18:14:10 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 627
2018-05-12 18:14:10 INFO  Executor:54 - Finished task 0.0 in stage 25.0 (TID 23). 2015 bytes result sent to driver
2018-05-12 18:14:10 INFO  TaskSetManager:54 - Finished task 0.0 in stage 25.0 (TID 23) in 106 ms on localhost (executor driver) (1/1)
2018-05-12 18:14:10 INFO  TaskSchedulerImpl:54 - Removed TaskSet 25.0, whose tasks have all completed, from pool 
2018-05-12 18:14:10 INFO  DAGScheduler:54 - ShuffleMapStage 25 (start at RateStreamStreamJoin.scala:51) finished in 0.128 s
2018-05-12 18:14:10 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:14:10 INFO  DAGScheduler:54 - running: Set()
2018-05-12 18:14:10 INFO  DAGScheduler:54 - waiting: Set(ResultStage 26)
2018-05-12 18:14:10 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:14:10 INFO  DAGScheduler:54 - Submitting ResultStage 26 (StateStoreAwareZipPartitionsRDD[182] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_62_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 624
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 659
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 772
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 787
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 738
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 651
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 662
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 722
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 748
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 707
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 632
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 628
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 755
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 729
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 588
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 757
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 702
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 706
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 745
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 775
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 620
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 580
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 629
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_71_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 596
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 639
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 649
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 666
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 672
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 640
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 764
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 598
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 765
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 630
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 753
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 587
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 725
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 688
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 762
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 623
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 586
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 619
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 750
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 583
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 669
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 690
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 667
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 741
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 670
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 744
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 686
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 735
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_78 stored as values in memory (estimated size 18.7 KB, free 359.9 MB)
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_74_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:14:10 INFO  MemoryStore:54 - Block broadcast_78_piece0 stored as bytes in memory (estimated size 9.2 KB, free 360.2 MB)
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Added broadcast_78_piece0 in memory on 192.168.19.162:43174 (size: 9.2 KB, free: 365.8 MB)
2018-05-12 18:14:10 INFO  SparkContext:54 - Created broadcast 78 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:14:10 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 26 (StateStoreAwareZipPartitionsRDD[182] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:14:10 INFO  TaskSchedulerImpl:54 - Adding task set 26.0 with 1 tasks
2018-05-12 18:14:10 INFO  TaskSetManager:54 - Starting task 0.0 in stage 26.0 (TID 24, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_55_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:14:10 INFO  Executor:54 - Running task 0.0 in stage 26.0 (TID 24)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 634
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 692
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 593
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 724
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 717
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 719
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_58_piece0 on 192.168.19.162:43174 in memory (size: 7.8 KB, free: 365.8 MB)
2018-05-12 18:14:10 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:14:10 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 700
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 591
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 728
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 726
2018-05-12 18:14:10 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:14:10 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_56_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 684
2018-05-12 18:14:10 INFO  StateStore:54 - Env is not null
2018-05-12 18:14:10 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 641
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 712
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 698
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 612
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 638
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 597
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 699
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 594
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_66_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:14:10 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@6c39cc3f
2018-05-12 18:14:10 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:14:10 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 8 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] for update
2018-05-12 18:14:10 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues)
2018-05-12 18:14:10 INFO  StateStore:54 - Env is not null
2018-05-12 18:14:10 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 760
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 607
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 617
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 713
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 683
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 733
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 610
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 751
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 777
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 671
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 616
2018-05-12 18:14:10 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@2990da8f
2018-05-12 18:14:10 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned shuffle 13
2018-05-12 18:14:10 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 8 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 754
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 782
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 647
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 737
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 643
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 681
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 589
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 721
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 631
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 752
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 661
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 648
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 780
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 676
2018-05-12 18:14:10 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 696
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 658
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 646
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 678
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 746
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 663
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 611
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 720
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 786
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 642
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 636
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 716
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 743
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 761
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 645
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 601
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 602
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 689
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 730
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 769
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 731
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 710
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 711
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 652
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 732
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_53_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 734
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 614
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_57_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 650
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_73_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 758
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 768
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 695
2018-05-12 18:14:10 INFO  CodeGenerator:54 - Code generated in 15.299388 ms
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned shuffle 14
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 599
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_64_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:14:10 INFO  StateStore:54 - Env is not null
2018-05-12 18:14:10 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 718
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 615
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 770
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 685
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 578
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 654
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 633
2018-05-12 18:14:10 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@2eee53aa
2018-05-12 18:14:10 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:14:10 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 8 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] for update
2018-05-12 18:14:10 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues)
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_61_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:14:10 INFO  StateStore:54 - Env is not null
2018-05-12 18:14:10 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 776
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 592
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 704
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 600
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 747
2018-05-12 18:14:10 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@5e0dabae
2018-05-12 18:14:10 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:14:10 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 8 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 18:14:10 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue)
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_63_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_70_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 657
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_54_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 664
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 653
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 635
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_69_piece0 on 192.168.19.162:43174 in memory (size: 9.2 KB, free: 366.0 MB)
2018-05-12 18:14:10 INFO  CodeGenerator:54 - Code generated in 12.71547 ms
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 674
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 740
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 759
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 608
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_65_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 691
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 605
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 680
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 621
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 675
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 715
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_76_piece0 on 192.168.19.162:43174 in memory (size: 6.7 KB, free: 366.1 MB)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 763
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 604
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned shuffle 12
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 618
2018-05-12 18:14:10 INFO  CodeGenerator:54 - Code generated in 18.230081 ms
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_68_piece0 on 192.168.19.162:43174 in memory (size: 7.8 KB, free: 366.1 MB)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 778
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_60_piece0 on 192.168.19.162:43174 in memory (size: 9.2 KB, free: 366.1 MB)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 606
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_52_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 613
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 655
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 767
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 749
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 771
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 742
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 644
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 687
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 736
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 625
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 590
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 709
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 701
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 637
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 579
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 603
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 693
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 781
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 756
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 584
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 723
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 665
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_59_piece0 on 192.168.19.162:43174 in memory (size: 6.7 KB, free: 366.1 MB)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 697
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 783
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 668
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 708
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 673
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 766
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 576
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 679
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 585
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 656
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 727
2018-05-12 18:14:10 INFO  BlockManagerInfo:54 - Removed broadcast_67_piece0 on 192.168.19.162:43174 in memory (size: 6.7 KB, free: 366.1 MB)
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 703
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 694
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 577
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 682
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned shuffle 15
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 574
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 739
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 609
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 660
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 626
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 774
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 714
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 582
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 622
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 575
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 705
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 773
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 581
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 595
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 677
2018-05-12 18:14:10 INFO  ContextCleaner:54 - Cleaned accumulator 779
2018-05-12 18:14:10 INFO  HDFSBackedStateStoreProvider:54 - Committed version 9 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/9.delta
2018-05-12 18:14:10 INFO  HDFSBackedStateStoreProvider:54 - Committed version 9 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/9.delta
2018-05-12 18:14:10 INFO  HDFSBackedStateStoreProvider:54 - Committed version 9 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/9.delta
2018-05-12 18:14:10 INFO  HDFSBackedStateStoreProvider:54 - Committed version 9 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/9.delta
2018-05-12 18:14:10 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 18:14:10 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 18:14:10 INFO  Executor:54 - Finished task 0.0 in stage 26.0 (TID 24). 5792 bytes result sent to driver
2018-05-12 18:14:10 INFO  TaskSetManager:54 - Finished task 0.0 in stage 26.0 (TID 24) in 219 ms on localhost (executor driver) (1/1)
2018-05-12 18:14:10 INFO  TaskSchedulerImpl:54 - Removed TaskSet 26.0, whose tasks have all completed, from pool 
2018-05-12 18:14:10 INFO  DAGScheduler:54 - ResultStage 26 (start at RateStreamStreamJoin.scala:51) finished in 0.307 s
2018-05-12 18:14:11 INFO  DAGScheduler:54 - Job 16 finished: start at RateStreamStreamJoin.scala:51, took 0.475412 s
2018-05-12 18:14:11 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@60ed2514 is committing.
-------------------------------------------
Batch: 8
-------------------------------------------
+--------------+-----------------------+---------+-----------------------+
|impressionAdId|impressionTime         |clickAdId|clickTime              |
+--------------+-----------------------+---------+-----------------------+
|803           |2018-05-12 18:13:39.529|803      |2018-05-12 18:13:47.599|
|819           |2018-05-12 18:13:42.729|819      |2018-05-12 18:13:50.799|
|820           |2018-05-12 18:13:42.929|820      |2018-05-12 18:13:50.999|
|829           |2018-05-12 18:13:44.729|829      |2018-05-12 18:13:52.799|
|843           |2018-05-12 18:13:47.529|843      |2018-05-12 18:13:55.599|
|852           |2018-05-12 18:13:49.329|852      |2018-05-12 18:13:57.399|
|873           |2018-05-12 18:13:53.529|873      |2018-05-12 18:14:01.599|
|881           |2018-05-12 18:13:55.129|881      |2018-05-12 18:14:03.199|
|890           |2018-05-12 18:13:56.929|890      |2018-05-12 18:14:04.999|
|894           |2018-05-12 18:13:57.729|894      |2018-05-12 18:14:05.799|
|903           |2018-05-12 18:13:59.529|903      |2018-05-12 18:14:07.599|
+--------------+-----------------------+---------+-----------------------+

2018-05-12 18:14:11 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@60ed2514 committed.
2018-05-12 18:14:11 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:11 INFO  DAGScheduler:54 - Job 17 finished: start at RateStreamStreamJoin.scala:51, took 0.000074 s
2018-05-12 18:14:11 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "0c6f7eb6-4f85-4322-9d17-ad4b241cd696",
  "runId" : "1f2f6927-f050-4179-8503-b350fe3ac6a4",
  "name" : null,
  "timestamp" : "2018-05-13T01:14:10.001Z",
  "batchId" : 8,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 10.00040001600064,
  "processedRowsPerSecond" : 234.0823970037453,
  "durationMs" : {
    "addBatch" : 690,
    "getBatch" : 35,
    "getOffset" : 0,
    "queryPlanning" : 292,
    "triggerExecution" : 1068,
    "walCommit" : 47
  },
  "eventTime" : {
    "avg" : "2018-05-13T01:13:57.329Z",
    "max" : "2018-05-13T01:14:09.729Z",
    "min" : "2018-05-13T01:13:44.929Z",
    "watermark" : "2018-05-13T01:13:32.599Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 252,
    "numRowsUpdated" : 136,
    "memoryUsedBytes" : 97838
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 166,
    "endOffset" : 191,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.00020000800032,
    "processedRowsPerSecond" : 117.04119850187266
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 166,
    "endOffset" : 191,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.00020000800032,
    "processedRowsPerSecond" : 117.04119850187266
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@18366d4b"
  }
}
2018-05-12 18:14:35 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526174037599 ms
2018-05-12 18:14:35 INFO  MicroBatchExecution:54 - Committed offsets for batch 9. Metadata OffsetSeqMetadata(1526174037599,1526174075001,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_79 stored as values in memory (estimated size 277.7 KB, free 363.9 MB)
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_79_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.9 MB)
2018-05-12 18:14:35 INFO  BlockManagerInfo:54 - Added broadcast_79_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:14:35 INFO  SparkContext:54 - Created broadcast 79 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_80 stored as values in memory (estimated size 277.7 KB, free 363.6 MB)
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_80_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.6 MB)
2018-05-12 18:14:35 INFO  BlockManagerInfo:54 - Added broadcast_80_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:14:35 INFO  SparkContext:54 - Created broadcast 80 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_81 stored as values in memory (estimated size 277.7 KB, free 363.3 MB)
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_81_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.3 MB)
2018-05-12 18:14:35 INFO  BlockManagerInfo:54 - Added broadcast_81_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:14:35 INFO  SparkContext:54 - Created broadcast 81 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:35 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526174037599E12 * 1000.0) as double) + -1.0E7)
2018-05-12 18:14:35 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526174027598
2018-05-12 18:14:35 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526174037599E12 * 1000.0) as double)
2018-05-12 18:14:35 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526174037598
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_82 stored as values in memory (estimated size 277.7 KB, free 363.0 MB)
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_82_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.0 MB)
2018-05-12 18:14:35 INFO  BlockManagerInfo:54 - Added broadcast_82_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:14:35 INFO  SparkContext:54 - Created broadcast 82 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_83 stored as values in memory (estimated size 277.7 KB, free 362.7 MB)
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_83_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.7 MB)
2018-05-12 18:14:35 INFO  BlockManagerInfo:54 - Added broadcast_83_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:14:35 INFO  SparkContext:54 - Created broadcast 83 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_84 stored as values in memory (estimated size 277.7 KB, free 362.4 MB)
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_84_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.4 MB)
2018-05-12 18:14:35 INFO  BlockManagerInfo:54 - Added broadcast_84_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:14:35 INFO  SparkContext:54 - Created broadcast 84 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:35 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@7e54458d. The input RDD has 1 partitions.
2018-05-12 18:14:35 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:35 INFO  DAGScheduler:54 - Registering RDD 195 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:14:35 INFO  DAGScheduler:54 - Registering RDD 201 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:14:35 INFO  DAGScheduler:54 - Got job 18 (start at RateStreamStreamJoin.scala:51) with 1 output partitions
2018-05-12 18:14:35 INFO  DAGScheduler:54 - Final stage: ResultStage 29 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:14:35 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 27, ShuffleMapStage 28)
2018-05-12 18:14:35 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 27, ShuffleMapStage 28)
2018-05-12 18:14:35 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 27 (MapPartitionsRDD[195] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_85 stored as values in memory (estimated size 15.7 KB, free 362.4 MB)
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_85_piece0 stored as bytes in memory (estimated size 6.7 KB, free 362.4 MB)
2018-05-12 18:14:35 INFO  BlockManagerInfo:54 - Added broadcast_85_piece0 in memory on 192.168.19.162:43174 (size: 6.7 KB, free: 366.0 MB)
2018-05-12 18:14:35 INFO  SparkContext:54 - Created broadcast 85 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:14:35 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 27 (MapPartitionsRDD[195] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:14:35 INFO  TaskSchedulerImpl:54 - Adding task set 27.0 with 1 tasks
2018-05-12 18:14:35 INFO  TaskSetManager:54 - Starting task 0.0 in stage 27.0 (TID 25, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:14:35 INFO  Executor:54 - Running task 0.0 in stage 27.0 (TID 25)
2018-05-12 18:14:35 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 28 (MapPartitionsRDD[201] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_86 stored as values in memory (estimated size 18.1 KB, free 362.4 MB)
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_86_piece0 stored as bytes in memory (estimated size 7.8 KB, free 362.4 MB)
2018-05-12 18:14:35 INFO  BlockManagerInfo:54 - Added broadcast_86_piece0 in memory on 192.168.19.162:43174 (size: 7.8 KB, free: 366.0 MB)
2018-05-12 18:14:35 INFO  SparkContext:54 - Created broadcast 86 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:14:35 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 28 (MapPartitionsRDD[201] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:14:35 INFO  TaskSchedulerImpl:54 - Adding task set 28.0 with 1 tasks
2018-05-12 18:14:35 INFO  TaskSetManager:54 - Starting task 0.0 in stage 28.0 (TID 26, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:14:35 INFO  Executor:54 - Running task 0.0 in stage 28.0 (TID 26)
2018-05-12 18:14:35 INFO  Executor:54 - Finished task 0.0 in stage 27.0 (TID 25). 1867 bytes result sent to driver
2018-05-12 18:14:35 INFO  TaskSetManager:54 - Finished task 0.0 in stage 27.0 (TID 25) in 19 ms on localhost (executor driver) (1/1)
2018-05-12 18:14:35 INFO  TaskSchedulerImpl:54 - Removed TaskSet 27.0, whose tasks have all completed, from pool 
2018-05-12 18:14:35 INFO  DAGScheduler:54 - ShuffleMapStage 27 (start at RateStreamStreamJoin.scala:51) finished in 0.032 s
2018-05-12 18:14:35 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:14:35 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 28)
2018-05-12 18:14:35 INFO  DAGScheduler:54 - waiting: Set(ResultStage 29)
2018-05-12 18:14:35 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:14:35 INFO  Executor:54 - Finished task 0.0 in stage 28.0 (TID 26). 1929 bytes result sent to driver
2018-05-12 18:14:35 INFO  TaskSetManager:54 - Finished task 0.0 in stage 28.0 (TID 26) in 42 ms on localhost (executor driver) (1/1)
2018-05-12 18:14:35 INFO  TaskSchedulerImpl:54 - Removed TaskSet 28.0, whose tasks have all completed, from pool 
2018-05-12 18:14:35 INFO  DAGScheduler:54 - ShuffleMapStage 28 (start at RateStreamStreamJoin.scala:51) finished in 0.057 s
2018-05-12 18:14:35 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:14:35 INFO  DAGScheduler:54 - running: Set()
2018-05-12 18:14:35 INFO  DAGScheduler:54 - waiting: Set(ResultStage 29)
2018-05-12 18:14:35 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:14:35 INFO  DAGScheduler:54 - Submitting ResultStage 29 (StateStoreAwareZipPartitionsRDD[203] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_87 stored as values in memory (estimated size 18.7 KB, free 362.4 MB)
2018-05-12 18:14:35 INFO  MemoryStore:54 - Block broadcast_87_piece0 stored as bytes in memory (estimated size 9.2 KB, free 362.3 MB)
2018-05-12 18:14:35 INFO  BlockManagerInfo:54 - Added broadcast_87_piece0 in memory on 192.168.19.162:43174 (size: 9.2 KB, free: 366.0 MB)
2018-05-12 18:14:35 INFO  SparkContext:54 - Created broadcast 87 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:14:35 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 29 (StateStoreAwareZipPartitionsRDD[203] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:14:35 INFO  TaskSchedulerImpl:54 - Adding task set 29.0 with 1 tasks
2018-05-12 18:14:35 INFO  TaskSetManager:54 - Starting task 0.0 in stage 29.0 (TID 27, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 18:14:35 INFO  Executor:54 - Running task 0.0 in stage 29.0 (TID 27)
2018-05-12 18:14:35 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:14:35 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2018-05-12 18:14:35 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:14:35 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:14:35 INFO  StateStore:54 - Env is not null
2018-05-12 18:14:35 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:14:35 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@58ab1e76
2018-05-12 18:14:35 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:14:35 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 9 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] for update
2018-05-12 18:14:35 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues)
2018-05-12 18:14:35 INFO  StateStore:54 - Env is not null
2018-05-12 18:14:35 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:14:35 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@1cbdcc80
2018-05-12 18:14:35 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:14:35 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 9 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 18:14:35 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue)
2018-05-12 18:14:35 INFO  CodeGenerator:54 - Code generated in 9.364679 ms
2018-05-12 18:14:35 INFO  StateStore:54 - Env is not null
2018-05-12 18:14:35 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:14:35 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@1525b66d
2018-05-12 18:14:35 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:14:35 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 9 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] for update
2018-05-12 18:14:35 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues)
2018-05-12 18:14:35 INFO  StateStore:54 - Env is not null
2018-05-12 18:14:35 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:14:35 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@7bd68b72
2018-05-12 18:14:35 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:14:35 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 9 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 18:14:35 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue)
2018-05-12 18:14:35 INFO  CodeGenerator:54 - Code generated in 11.23009 ms
2018-05-12 18:14:35 INFO  CodeGenerator:54 - Code generated in 8.863762 ms
2018-05-12 18:14:35 INFO  HDFSBackedStateStoreProvider:54 - Committed version 10 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/10.delta
2018-05-12 18:14:35 INFO  HDFSBackedStateStoreProvider:54 - Committed version 10 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/10.delta
2018-05-12 18:14:35 INFO  HDFSBackedStateStoreProvider:54 - Committed version 10 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/10.delta
2018-05-12 18:14:35 INFO  HDFSBackedStateStoreProvider:54 - Committed version 10 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/10.delta
2018-05-12 18:14:35 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 18:14:35 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 18:14:35 INFO  Executor:54 - Finished task 0.0 in stage 29.0 (TID 27). 5792 bytes result sent to driver
2018-05-12 18:14:35 INFO  TaskSetManager:54 - Finished task 0.0 in stage 29.0 (TID 27) in 141 ms on localhost (executor driver) (1/1)
2018-05-12 18:14:35 INFO  TaskSchedulerImpl:54 - Removed TaskSet 29.0, whose tasks have all completed, from pool 
2018-05-12 18:14:35 INFO  DAGScheduler:54 - ResultStage 29 (start at RateStreamStreamJoin.scala:51) finished in 0.175 s
2018-05-12 18:14:35 INFO  DAGScheduler:54 - Job 18 finished: start at RateStreamStreamJoin.scala:51, took 0.257950 s
2018-05-12 18:14:35 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@7e54458d is committing.
-------------------------------------------
Batch: 9
-------------------------------------------
+--------------+-----------------------+---------+-----------------------+
|impressionAdId|impressionTime         |clickAdId|clickTime              |
+--------------+-----------------------+---------+-----------------------+
|928           |2018-05-12 18:14:04.529|928      |2018-05-12 18:14:12.599|
|944           |2018-05-12 18:14:07.729|944      |2018-05-12 18:14:15.799|
|945           |2018-05-12 18:14:07.929|945      |2018-05-12 18:14:15.999|
|954           |2018-05-12 18:14:09.729|954      |2018-05-12 18:14:17.799|
|968           |2018-05-12 18:14:12.529|968      |2018-05-12 18:14:20.599|
|977           |2018-05-12 18:14:14.329|977      |2018-05-12 18:14:22.399|
|998           |2018-05-12 18:14:18.529|998      |2018-05-12 18:14:26.599|
|1006          |2018-05-12 18:14:20.129|1006     |2018-05-12 18:14:28.199|
|1015          |2018-05-12 18:14:21.929|1015     |2018-05-12 18:14:29.999|
|1019          |2018-05-12 18:14:22.729|1019     |2018-05-12 18:14:30.799|
|1028          |2018-05-12 18:14:24.529|1028     |2018-05-12 18:14:32.599|
+--------------+-----------------------+---------+-----------------------+

2018-05-12 18:14:35 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@7e54458d committed.
2018-05-12 18:14:35 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:14:35 INFO  DAGScheduler:54 - Job 19 finished: start at RateStreamStreamJoin.scala:51, took 0.000129 s
2018-05-12 18:14:35 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "0c6f7eb6-4f85-4322-9d17-ad4b241cd696",
  "runId" : "1f2f6927-f050-4179-8503-b350fe3ac6a4",
  "name" : null,
  "timestamp" : "2018-05-13T01:14:35.000Z",
  "batchId" : 9,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 10.00040001600064,
  "processedRowsPerSecond" : 331.56498673740055,
  "durationMs" : {
    "addBatch" : 405,
    "getBatch" : 34,
    "getOffset" : 0,
    "queryPlanning" : 276,
    "triggerExecution" : 754,
    "walCommit" : 36
  },
  "eventTime" : {
    "avg" : "2018-05-13T01:14:22.329Z",
    "max" : "2018-05-13T01:14:34.729Z",
    "min" : "2018-05-13T01:14:09.929Z",
    "watermark" : "2018-05-13T01:13:57.599Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 252,
    "numRowsUpdated" : 136,
    "memoryUsedBytes" : 93502
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 191,
    "endOffset" : 216,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.00020000800032,
    "processedRowsPerSecond" : 165.78249336870027
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 191,
    "endOffset" : 216,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.00020000800032,
    "processedRowsPerSecond" : 165.78249336870027
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@18366d4b"
  }
}
2018-05-12 18:15:00 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526174062599 ms
2018-05-12 18:15:00 INFO  MicroBatchExecution:54 - Committed offsets for batch 10. Metadata OffsetSeqMetadata(1526174062599,1526174100003,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_88 stored as values in memory (estimated size 277.7 KB, free 362.1 MB)
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_88_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.1 MB)
2018-05-12 18:15:00 INFO  BlockManagerInfo:54 - Added broadcast_88_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:15:00 INFO  SparkContext:54 - Created broadcast 88 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_89 stored as values in memory (estimated size 277.7 KB, free 361.8 MB)
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_89_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.8 MB)
2018-05-12 18:15:00 INFO  BlockManagerInfo:54 - Added broadcast_89_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:15:00 INFO  SparkContext:54 - Created broadcast 89 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_90 stored as values in memory (estimated size 277.7 KB, free 361.5 MB)
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_90_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.5 MB)
2018-05-12 18:15:00 INFO  BlockManagerInfo:54 - Added broadcast_90_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:15:00 INFO  SparkContext:54 - Created broadcast 90 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:00 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526174062599E12 * 1000.0) as double) + -1.0E7)
2018-05-12 18:15:00 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526174052598
2018-05-12 18:15:00 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526174062599E12 * 1000.0) as double)
2018-05-12 18:15:00 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526174062598
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_91 stored as values in memory (estimated size 277.7 KB, free 361.2 MB)
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_91_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.2 MB)
2018-05-12 18:15:00 INFO  BlockManagerInfo:54 - Added broadcast_91_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:15:00 INFO  SparkContext:54 - Created broadcast 91 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_92 stored as values in memory (estimated size 277.7 KB, free 360.9 MB)
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_92_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.9 MB)
2018-05-12 18:15:00 INFO  BlockManagerInfo:54 - Added broadcast_92_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:15:00 INFO  SparkContext:54 - Created broadcast 92 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_93 stored as values in memory (estimated size 277.7 KB, free 360.6 MB)
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_93_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.6 MB)
2018-05-12 18:15:00 INFO  BlockManagerInfo:54 - Added broadcast_93_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:15:00 INFO  SparkContext:54 - Created broadcast 93 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:00 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@5c83a028. The input RDD has 1 partitions.
2018-05-12 18:15:00 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:00 INFO  DAGScheduler:54 - Registering RDD 216 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:15:00 INFO  DAGScheduler:54 - Registering RDD 222 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:15:00 INFO  DAGScheduler:54 - Got job 20 (start at RateStreamStreamJoin.scala:51) with 1 output partitions
2018-05-12 18:15:00 INFO  DAGScheduler:54 - Final stage: ResultStage 32 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:15:00 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 30, ShuffleMapStage 31)
2018-05-12 18:15:00 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 30, ShuffleMapStage 31)
2018-05-12 18:15:00 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 30 (MapPartitionsRDD[216] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_94 stored as values in memory (estimated size 15.7 KB, free 360.6 MB)
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_94_piece0 stored as bytes in memory (estimated size 6.7 KB, free 360.6 MB)
2018-05-12 18:15:00 INFO  BlockManagerInfo:54 - Added broadcast_94_piece0 in memory on 192.168.19.162:43174 (size: 6.7 KB, free: 365.8 MB)
2018-05-12 18:15:00 INFO  SparkContext:54 - Created broadcast 94 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:15:00 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 30 (MapPartitionsRDD[216] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:15:00 INFO  TaskSchedulerImpl:54 - Adding task set 30.0 with 1 tasks
2018-05-12 18:15:00 INFO  TaskSetManager:54 - Starting task 0.0 in stage 30.0 (TID 28, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:15:00 INFO  Executor:54 - Running task 0.0 in stage 30.0 (TID 28)
2018-05-12 18:15:00 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 31 (MapPartitionsRDD[222] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_95 stored as values in memory (estimated size 18.1 KB, free 360.5 MB)
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_95_piece0 stored as bytes in memory (estimated size 7.8 KB, free 360.5 MB)
2018-05-12 18:15:00 INFO  BlockManagerInfo:54 - Added broadcast_95_piece0 in memory on 192.168.19.162:43174 (size: 7.8 KB, free: 365.8 MB)
2018-05-12 18:15:00 INFO  SparkContext:54 - Created broadcast 95 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:15:00 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 31 (MapPartitionsRDD[222] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:15:00 INFO  TaskSchedulerImpl:54 - Adding task set 31.0 with 1 tasks
2018-05-12 18:15:00 INFO  TaskSetManager:54 - Starting task 0.0 in stage 31.0 (TID 29, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:15:00 INFO  Executor:54 - Running task 0.0 in stage 31.0 (TID 29)
2018-05-12 18:15:00 INFO  Executor:54 - Finished task 0.0 in stage 30.0 (TID 28). 1867 bytes result sent to driver
2018-05-12 18:15:00 INFO  TaskSetManager:54 - Finished task 0.0 in stage 30.0 (TID 28) in 33 ms on localhost (executor driver) (1/1)
2018-05-12 18:15:00 INFO  TaskSchedulerImpl:54 - Removed TaskSet 30.0, whose tasks have all completed, from pool 
2018-05-12 18:15:00 INFO  DAGScheduler:54 - ShuffleMapStage 30 (start at RateStreamStreamJoin.scala:51) finished in 0.057 s
2018-05-12 18:15:00 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:15:00 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 31)
2018-05-12 18:15:00 INFO  DAGScheduler:54 - waiting: Set(ResultStage 32)
2018-05-12 18:15:00 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:15:00 INFO  Executor:54 - Finished task 0.0 in stage 31.0 (TID 29). 1929 bytes result sent to driver
2018-05-12 18:15:00 INFO  TaskSetManager:54 - Finished task 0.0 in stage 31.0 (TID 29) in 24 ms on localhost (executor driver) (1/1)
2018-05-12 18:15:00 INFO  TaskSchedulerImpl:54 - Removed TaskSet 31.0, whose tasks have all completed, from pool 
2018-05-12 18:15:00 INFO  DAGScheduler:54 - ShuffleMapStage 31 (start at RateStreamStreamJoin.scala:51) finished in 0.058 s
2018-05-12 18:15:00 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:15:00 INFO  DAGScheduler:54 - running: Set()
2018-05-12 18:15:00 INFO  DAGScheduler:54 - waiting: Set(ResultStage 32)
2018-05-12 18:15:00 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:15:00 INFO  DAGScheduler:54 - Submitting ResultStage 32 (StateStoreAwareZipPartitionsRDD[224] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_96 stored as values in memory (estimated size 18.7 KB, free 360.5 MB)
2018-05-12 18:15:00 INFO  MemoryStore:54 - Block broadcast_96_piece0 stored as bytes in memory (estimated size 9.2 KB, free 360.5 MB)
2018-05-12 18:15:00 INFO  BlockManagerInfo:54 - Added broadcast_96_piece0 in memory on 192.168.19.162:43174 (size: 9.2 KB, free: 365.8 MB)
2018-05-12 18:15:00 INFO  SparkContext:54 - Created broadcast 96 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:15:00 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 32 (StateStoreAwareZipPartitionsRDD[224] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:15:00 INFO  TaskSchedulerImpl:54 - Adding task set 32.0 with 1 tasks
2018-05-12 18:15:00 INFO  TaskSetManager:54 - Starting task 0.0 in stage 32.0 (TID 30, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 18:15:00 INFO  Executor:54 - Running task 0.0 in stage 32.0 (TID 30)
2018-05-12 18:15:00 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:15:00 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:15:00 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:15:00 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2018-05-12 18:15:00 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:00 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:00 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@6b060a28
2018-05-12 18:15:00 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:15:00 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 10 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] for update
2018-05-12 18:15:00 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues)
2018-05-12 18:15:00 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:00 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:00 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@334713a1
2018-05-12 18:15:00 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:15:00 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 10 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 18:15:00 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue)
2018-05-12 18:15:00 INFO  CodeGenerator:54 - Code generated in 12.729568 ms
2018-05-12 18:15:00 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:00 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:00 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@35639db0
2018-05-12 18:15:00 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:15:00 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 10 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] for update
2018-05-12 18:15:00 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues)
2018-05-12 18:15:00 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:00 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:00 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@13a56e8
2018-05-12 18:15:00 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:15:00 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 10 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 18:15:00 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue)
2018-05-12 18:15:00 INFO  CodeGenerator:54 - Code generated in 14.088566 ms
2018-05-12 18:15:00 INFO  CodeGenerator:54 - Code generated in 11.643724 ms
2018-05-12 18:15:00 INFO  HDFSBackedStateStoreProvider:54 - Committed version 11 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/11.delta
2018-05-12 18:15:00 INFO  HDFSBackedStateStoreProvider:54 - Committed version 11 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/11.delta
2018-05-12 18:15:00 INFO  HDFSBackedStateStoreProvider:54 - Committed version 11 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/11.delta
2018-05-12 18:15:00 INFO  HDFSBackedStateStoreProvider:54 - Committed version 11 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/11.delta
2018-05-12 18:15:00 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 18:15:00 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 18:15:00 INFO  Executor:54 - Finished task 0.0 in stage 32.0 (TID 30). 5835 bytes result sent to driver
2018-05-12 18:15:00 INFO  TaskSetManager:54 - Finished task 0.0 in stage 32.0 (TID 30) in 187 ms on localhost (executor driver) (1/1)
2018-05-12 18:15:00 INFO  TaskSchedulerImpl:54 - Removed TaskSet 32.0, whose tasks have all completed, from pool 
2018-05-12 18:15:00 INFO  DAGScheduler:54 - ResultStage 32 (start at RateStreamStreamJoin.scala:51) finished in 0.222 s
2018-05-12 18:15:00 INFO  DAGScheduler:54 - Job 20 finished: start at RateStreamStreamJoin.scala:51, took 0.314232 s
2018-05-12 18:15:00 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@5c83a028 is committing.
-------------------------------------------
Batch: 10
-------------------------------------------
+--------------+-----------------------+---------+-----------------------+
|impressionAdId|impressionTime         |clickAdId|clickTime              |
+--------------+-----------------------+---------+-----------------------+
|1053          |2018-05-12 18:14:29.529|1053     |2018-05-12 18:14:37.599|
|1069          |2018-05-12 18:14:32.729|1069     |2018-05-12 18:14:40.799|
|1070          |2018-05-12 18:14:32.929|1070     |2018-05-12 18:14:40.999|
|1079          |2018-05-12 18:14:34.729|1079     |2018-05-12 18:14:42.799|
|1093          |2018-05-12 18:14:37.529|1093     |2018-05-12 18:14:45.599|
|1102          |2018-05-12 18:14:39.329|1102     |2018-05-12 18:14:47.399|
|1123          |2018-05-12 18:14:43.529|1123     |2018-05-12 18:14:51.599|
|1131          |2018-05-12 18:14:45.129|1131     |2018-05-12 18:14:53.199|
|1140          |2018-05-12 18:14:46.929|1140     |2018-05-12 18:14:54.999|
|1144          |2018-05-12 18:14:47.729|1144     |2018-05-12 18:14:55.799|
|1153          |2018-05-12 18:14:49.529|1153     |2018-05-12 18:14:57.599|
+--------------+-----------------------+---------+-----------------------+

2018-05-12 18:15:00 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@5c83a028 committed.
2018-05-12 18:15:00 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:00 INFO  DAGScheduler:54 - Job 21 finished: start at RateStreamStreamJoin.scala:51, took 0.000103 s
2018-05-12 18:15:00 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "0c6f7eb6-4f85-4322-9d17-ad4b241cd696",
  "runId" : "1f2f6927-f050-4179-8503-b350fe3ac6a4",
  "name" : null,
  "timestamp" : "2018-05-13T01:15:00.001Z",
  "batchId" : 10,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 9.99960001599936,
  "processedRowsPerSecond" : 281.8489289740699,
  "durationMs" : {
    "addBatch" : 516,
    "getBatch" : 38,
    "getOffset" : 0,
    "queryPlanning" : 291,
    "triggerExecution" : 887,
    "walCommit" : 38
  },
  "eventTime" : {
    "avg" : "2018-05-13T01:14:47.329Z",
    "max" : "2018-05-13T01:14:59.729Z",
    "min" : "2018-05-13T01:14:34.929Z",
    "watermark" : "2018-05-13T01:14:22.599Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 252,
    "numRowsUpdated" : 136,
    "memoryUsedBytes" : 88190
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 216,
    "endOffset" : 241,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 4.99980000799968,
    "processedRowsPerSecond" : 140.92446448703495
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 216,
    "endOffset" : 241,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 4.99980000799968,
    "processedRowsPerSecond" : 140.92446448703495
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@18366d4b"
  }
}
2018-05-12 18:15:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@51c68f84
2018-05-12 18:15:01 INFO  HDFSBackedStateStoreProvider:54 - Written snapshot file for version 11 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] at file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/11.snapshot
2018-05-12 18:15:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@4821a026
2018-05-12 18:15:01 INFO  HDFSBackedStateStoreProvider:54 - Written snapshot file for version 11 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] at file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/11.snapshot
2018-05-12 18:15:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@1da31455
2018-05-12 18:15:01 INFO  HDFSBackedStateStoreProvider:54 - Written snapshot file for version 11 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] at file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/11.snapshot
2018-05-12 18:15:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@62d347fd
2018-05-12 18:15:01 INFO  HDFSBackedStateStoreProvider:54 - Written snapshot file for version 11 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] at file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/11.snapshot
2018-05-12 18:15:25 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526174087599 ms
2018-05-12 18:15:25 INFO  MicroBatchExecution:54 - Committed offsets for batch 11. Metadata OffsetSeqMetadata(1526174087599,1526174125003,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_97 stored as values in memory (estimated size 277.7 KB, free 360.2 MB)
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_97_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.2 MB)
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Added broadcast_97_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:15:25 INFO  SparkContext:54 - Created broadcast 97 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_98 stored as values in memory (estimated size 277.7 KB, free 359.9 MB)
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_98_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.9 MB)
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Added broadcast_98_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:15:25 INFO  SparkContext:54 - Created broadcast 98 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_99 stored as values in memory (estimated size 277.7 KB, free 359.7 MB)
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_99_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.6 MB)
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Added broadcast_99_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:15:25 INFO  SparkContext:54 - Created broadcast 99 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:25 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526174087599E12 * 1000.0) as double) + -1.0E7)
2018-05-12 18:15:25 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526174077598
2018-05-12 18:15:25 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526174087599E12 * 1000.0) as double)
2018-05-12 18:15:25 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526174087598
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_100 stored as values in memory (estimated size 277.7 KB, free 359.4 MB)
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_100_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.3 MB)
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Added broadcast_100_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:15:25 INFO  SparkContext:54 - Created broadcast 100 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_101 stored as values in memory (estimated size 277.7 KB, free 359.1 MB)
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_101_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.0 MB)
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Added broadcast_101_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:15:25 INFO  SparkContext:54 - Created broadcast 101 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_102 stored as values in memory (estimated size 277.7 KB, free 358.8 MB)
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_102_piece0 stored as bytes in memory (estimated size 23.5 KB, free 358.7 MB)
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Added broadcast_102_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:15:25 INFO  SparkContext:54 - Created broadcast 102 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 900
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_95_piece0 on 192.168.19.162:43174 in memory (size: 7.8 KB, free: 365.7 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 864
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 923
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1083
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1053
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 891
2018-05-12 18:15:25 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@4fd3f0ad. The input RDD has 1 partitions.
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_89_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1075
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 867
2018-05-12 18:15:25 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_100_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:15:25 INFO  DAGScheduler:54 - Registering RDD 237 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 958
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 956
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 972
2018-05-12 18:15:25 INFO  DAGScheduler:54 - Registering RDD 243 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:15:25 INFO  DAGScheduler:54 - Got job 22 (start at RateStreamStreamJoin.scala:51) with 1 output partitions
2018-05-12 18:15:25 INFO  DAGScheduler:54 - Final stage: ResultStage 35 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_88_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:15:25 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 33, ShuffleMapStage 34)
2018-05-12 18:15:25 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 33, ShuffleMapStage 34)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1065
2018-05-12 18:15:25 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 33 (MapPartitionsRDD[237] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1031
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1080
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 928
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1043
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1082
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 970
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1063
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 925
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 927
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 918
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 942
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1068
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1073
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 981
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1061
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_97_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_103 stored as values in memory (estimated size 15.7 KB, free 359.7 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 952
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1045
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 911
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 937
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1027
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1025
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 944
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 901
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1090
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1093
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_103_piece0 stored as bytes in memory (estimated size 6.7 KB, free 359.9 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 921
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 973
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 950
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 991
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 932
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 888
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 894
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 869
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 961
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Added broadcast_103_piece0 in memory on 192.168.19.162:43174 (size: 6.7 KB, free: 365.8 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1051
2018-05-12 18:15:25 INFO  SparkContext:54 - Created broadcast 103 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_93_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:15:25 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 33 (MapPartitionsRDD[237] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:15:25 INFO  TaskSchedulerImpl:54 - Adding task set 33.0 with 1 tasks
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1070
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 962
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 983
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 892
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 984
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1016
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 943
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1052
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 929
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 874
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 955
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 899
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 917
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 876
2018-05-12 18:15:25 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 34 (MapPartitionsRDD[243] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:15:25 INFO  TaskSetManager:54 - Starting task 0.0 in stage 33.0 (TID 31, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:15:25 INFO  Executor:54 - Running task 0.0 in stage 33.0 (TID 31)
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_94_piece0 on 192.168.19.162:43174 in memory (size: 6.7 KB, free: 365.8 MB)
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_104 stored as values in memory (estimated size 18.1 KB, free 360.2 MB)
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_104_piece0 stored as bytes in memory (estimated size 7.8 KB, free 360.2 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 953
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Added broadcast_104_piece0 in memory on 192.168.19.162:43174 (size: 7.8 KB, free: 365.8 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1084
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 908
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 969
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 965
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 884
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1064
2018-05-12 18:15:25 INFO  SparkContext:54 - Created broadcast 104 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_101_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:15:25 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 34 (MapPartitionsRDD[243] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:15:25 INFO  TaskSchedulerImpl:54 - Adding task set 34.0 with 1 tasks
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1009
2018-05-12 18:15:25 INFO  TaskSetManager:54 - Starting task 0.0 in stage 34.0 (TID 32, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:15:25 INFO  Executor:54 - Finished task 0.0 in stage 33.0 (TID 31). 1867 bytes result sent to driver
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_79_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:15:25 INFO  TaskSetManager:54 - Finished task 0.0 in stage 33.0 (TID 31) in 22 ms on localhost (executor driver) (1/1)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 951
2018-05-12 18:15:25 INFO  TaskSchedulerImpl:54 - Removed TaskSet 33.0, whose tasks have all completed, from pool 
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 946
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 990
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 881
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 902
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1091
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 893
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1067
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 886
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 974
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 913
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1074
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1085
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1078
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 968
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 860
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1034
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1049
2018-05-12 18:15:25 INFO  DAGScheduler:54 - ShuffleMapStage 33 (start at RateStreamStreamJoin.scala:51) finished in 0.038 s
2018-05-12 18:15:25 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:15:25 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 34)
2018-05-12 18:15:25 INFO  DAGScheduler:54 - waiting: Set(ResultStage 35)
2018-05-12 18:15:25 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:15:25 INFO  Executor:54 - Running task 0.0 in stage 34.0 (TID 32)
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_87_piece0 on 192.168.19.162:43174 in memory (size: 9.2 KB, free: 365.8 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 868
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 879
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 907
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_78_piece0 on 192.168.19.162:43174 in memory (size: 9.2 KB, free: 365.8 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 994
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 939
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1046
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 931
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1000
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 865
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 986
2018-05-12 18:15:25 INFO  Executor:54 - Finished task 0.0 in stage 34.0 (TID 32). 1929 bytes result sent to driver
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned shuffle 20
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1048
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 934
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 993
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 919
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 954
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 924
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 898
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 885
2018-05-12 18:15:25 INFO  TaskSetManager:54 - Finished task 0.0 in stage 34.0 (TID 32) in 32 ms on localhost (executor driver) (1/1)
2018-05-12 18:15:25 INFO  TaskSchedulerImpl:54 - Removed TaskSet 34.0, whose tasks have all completed, from pool 
2018-05-12 18:15:25 INFO  DAGScheduler:54 - ShuffleMapStage 34 (start at RateStreamStreamJoin.scala:51) finished in 0.046 s
2018-05-12 18:15:25 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:15:25 INFO  DAGScheduler:54 - running: Set()
2018-05-12 18:15:25 INFO  DAGScheduler:54 - waiting: Set(ResultStage 35)
2018-05-12 18:15:25 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:15:25 INFO  DAGScheduler:54 - Submitting ResultStage 35 (StateStoreAwareZipPartitionsRDD[245] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_83_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 861
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1079
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1055
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 889
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_91_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 897
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned shuffle 18
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 905
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 920
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 877
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1050
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_105 stored as values in memory (estimated size 18.7 KB, free 361.4 MB)
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_84_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 896
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1060
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1024
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 890
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 912
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 992
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1038
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 980
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1022
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1004
2018-05-12 18:15:25 INFO  MemoryStore:54 - Block broadcast_105_piece0 stored as bytes in memory (estimated size 9.2 KB, free 361.7 MB)
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Added broadcast_105_piece0 in memory on 192.168.19.162:43174 (size: 9.2 KB, free: 365.9 MB)
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_85_piece0 on 192.168.19.162:43174 in memory (size: 6.7 KB, free: 365.9 MB)
2018-05-12 18:15:25 INFO  SparkContext:54 - Created broadcast 105 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 957
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 989
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1088
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1076
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1014
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1007
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 926
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 906
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 866
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 947
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 999
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 987
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1089
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 979
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 915
2018-05-12 18:15:25 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 35 (StateStoreAwareZipPartitionsRDD[245] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:15:25 INFO  TaskSchedulerImpl:54 - Adding task set 35.0 with 1 tasks
2018-05-12 18:15:25 INFO  TaskSetManager:54 - Starting task 0.0 in stage 35.0 (TID 33, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 18:15:25 INFO  Executor:54 - Running task 0.0 in stage 35.0 (TID 33)
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_86_piece0 on 192.168.19.162:43174 in memory (size: 7.8 KB, free: 365.9 MB)
2018-05-12 18:15:25 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:15:25 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:15:25 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:15:25 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_90_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:15:25 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:25 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1042
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1036
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1099
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 873
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 909
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 875
2018-05-12 18:15:25 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@114f8864
2018-05-12 18:15:25 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:15:25 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 11 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] for update
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_81_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:15:25 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 988
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 930
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1069
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned shuffle 19
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 998
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 910
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 964
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1059
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 975
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 936
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 878
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 935
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 903
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1008
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 966
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 862
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1012
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1011
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1032
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 872
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1077
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1030
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 882
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1057
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1094
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1071
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 883
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1015
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 916
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1035
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1028
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1017
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 982
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1081
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 941
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1062
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1021
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1041
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 976
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1029
2018-05-12 18:15:25 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:25 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_98_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 895
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 948
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 985
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 997
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 945
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned shuffle 21
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 978
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1072
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 933
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1044
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 914
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1037
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 863
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 904
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 880
2018-05-12 18:15:25 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@3379cf83
2018-05-12 18:15:25 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_80_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:15:25 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 11 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 18:15:25 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1047
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1020
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 960
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 996
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_92_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1058
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1026
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 870
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1087
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1023
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1005
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1086
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 940
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_96_piece0 on 192.168.19.162:43174 in memory (size: 9.2 KB, free: 366.0 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 959
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1018
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 887
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 967
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1092
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1098
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 938
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 949
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 995
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1010
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1054
2018-05-12 18:15:25 INFO  BlockManagerInfo:54 - Removed broadcast_82_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 922
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1006
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1056
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1001
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 971
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1003
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 963
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 977
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 871
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1002
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1095
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1013
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1019
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1066
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1040
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1039
2018-05-12 18:15:25 INFO  ContextCleaner:54 - Cleaned accumulator 1033
2018-05-12 18:15:25 INFO  CodeGenerator:54 - Code generated in 15.31353 ms
2018-05-12 18:15:25 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:25 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:25 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@68fe5a10
2018-05-12 18:15:25 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:15:25 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 11 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] for update
2018-05-12 18:15:25 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues)
2018-05-12 18:15:25 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:25 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:25 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@5c5adaac
2018-05-12 18:15:25 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:15:25 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 11 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 18:15:25 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue)
2018-05-12 18:15:25 INFO  CodeGenerator:54 - Code generated in 10.180679 ms
2018-05-12 18:15:25 INFO  CodeGenerator:54 - Code generated in 10.625729 ms
2018-05-12 18:15:25 INFO  HDFSBackedStateStoreProvider:54 - Committed version 12 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/12.delta
2018-05-12 18:15:25 INFO  HDFSBackedStateStoreProvider:54 - Committed version 12 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/12.delta
2018-05-12 18:15:25 INFO  HDFSBackedStateStoreProvider:54 - Committed version 12 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/12.delta
2018-05-12 18:15:25 INFO  HDFSBackedStateStoreProvider:54 - Committed version 12 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/12.delta
2018-05-12 18:15:25 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 18:15:25 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 18:15:25 INFO  Executor:54 - Finished task 0.0 in stage 35.0 (TID 33). 5792 bytes result sent to driver
2018-05-12 18:15:25 INFO  TaskSetManager:54 - Finished task 0.0 in stage 35.0 (TID 33) in 159 ms on localhost (executor driver) (1/1)
2018-05-12 18:15:25 INFO  TaskSchedulerImpl:54 - Removed TaskSet 35.0, whose tasks have all completed, from pool 
2018-05-12 18:15:25 INFO  DAGScheduler:54 - ResultStage 35 (start at RateStreamStreamJoin.scala:51) finished in 0.199 s
2018-05-12 18:15:25 INFO  DAGScheduler:54 - Job 22 finished: start at RateStreamStreamJoin.scala:51, took 0.273829 s
2018-05-12 18:15:25 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@4fd3f0ad is committing.
-------------------------------------------
Batch: 11
-------------------------------------------
+--------------+-----------------------+---------+-----------------------+
|impressionAdId|impressionTime         |clickAdId|clickTime              |
+--------------+-----------------------+---------+-----------------------+
|1178          |2018-05-12 18:14:54.529|1178     |2018-05-12 18:15:02.599|
|1194          |2018-05-12 18:14:57.729|1194     |2018-05-12 18:15:05.799|
|1195          |2018-05-12 18:14:57.929|1195     |2018-05-12 18:15:05.999|
|1204          |2018-05-12 18:14:59.729|1204     |2018-05-12 18:15:07.799|
|1218          |2018-05-12 18:15:02.529|1218     |2018-05-12 18:15:10.599|
|1227          |2018-05-12 18:15:04.329|1227     |2018-05-12 18:15:12.399|
|1248          |2018-05-12 18:15:08.529|1248     |2018-05-12 18:15:16.599|
|1256          |2018-05-12 18:15:10.129|1256     |2018-05-12 18:15:18.199|
|1265          |2018-05-12 18:15:11.929|1265     |2018-05-12 18:15:19.999|
|1269          |2018-05-12 18:15:12.729|1269     |2018-05-12 18:15:20.799|
|1278          |2018-05-12 18:15:14.529|1278     |2018-05-12 18:15:22.599|
+--------------+-----------------------+---------+-----------------------+

2018-05-12 18:15:25 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@4fd3f0ad committed.
2018-05-12 18:15:25 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:25 INFO  DAGScheduler:54 - Job 23 finished: start at RateStreamStreamJoin.scala:51, took 0.000104 s
2018-05-12 18:15:25 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "0c6f7eb6-4f85-4322-9d17-ad4b241cd696",
  "runId" : "1f2f6927-f050-4179-8503-b350fe3ac6a4",
  "name" : null,
  "timestamp" : "2018-05-13T01:15:25.001Z",
  "batchId" : 11,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 10.0,
  "processedRowsPerSecond" : 259.87525987525987,
  "durationMs" : {
    "addBatch" : 599,
    "getBatch" : 34,
    "getOffset" : 0,
    "queryPlanning" : 285,
    "triggerExecution" : 961,
    "walCommit" : 39
  },
  "eventTime" : {
    "avg" : "2018-05-13T01:15:12.329Z",
    "max" : "2018-05-13T01:15:24.729Z",
    "min" : "2018-05-13T01:14:59.929Z",
    "watermark" : "2018-05-13T01:14:47.599Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 252,
    "numRowsUpdated" : 136,
    "memoryUsedBytes" : 99614
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 241,
    "endOffset" : 266,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 129.93762993762994
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 241,
    "endOffset" : 266,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 129.93762993762994
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@18366d4b"
  }
}
2018-05-12 18:15:50 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526174112599 ms
2018-05-12 18:15:50 INFO  MicroBatchExecution:54 - Committed offsets for batch 12. Metadata OffsetSeqMetadata(1526174112599,1526174150004,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_106 stored as values in memory (estimated size 277.7 KB, free 363.3 MB)
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_106_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.3 MB)
2018-05-12 18:15:50 INFO  BlockManagerInfo:54 - Added broadcast_106_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:15:50 INFO  SparkContext:54 - Created broadcast 106 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_107 stored as values in memory (estimated size 277.7 KB, free 363.0 MB)
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_107_piece0 stored as bytes in memory (estimated size 23.5 KB, free 363.0 MB)
2018-05-12 18:15:50 INFO  BlockManagerInfo:54 - Added broadcast_107_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:15:50 INFO  SparkContext:54 - Created broadcast 107 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_108 stored as values in memory (estimated size 277.7 KB, free 362.7 MB)
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_108_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.7 MB)
2018-05-12 18:15:50 INFO  BlockManagerInfo:54 - Added broadcast_108_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:15:50 INFO  SparkContext:54 - Created broadcast 108 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:50 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526174112599E12 * 1000.0) as double) + -1.0E7)
2018-05-12 18:15:50 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526174102598
2018-05-12 18:15:50 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526174112599E12 * 1000.0) as double)
2018-05-12 18:15:50 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526174112598
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_109 stored as values in memory (estimated size 277.7 KB, free 362.4 MB)
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_109_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.4 MB)
2018-05-12 18:15:50 INFO  BlockManagerInfo:54 - Added broadcast_109_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:15:50 INFO  SparkContext:54 - Created broadcast 109 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_110 stored as values in memory (estimated size 277.7 KB, free 362.1 MB)
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_110_piece0 stored as bytes in memory (estimated size 23.5 KB, free 362.1 MB)
2018-05-12 18:15:50 INFO  BlockManagerInfo:54 - Added broadcast_110_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:15:50 INFO  SparkContext:54 - Created broadcast 110 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_111 stored as values in memory (estimated size 277.7 KB, free 361.8 MB)
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_111_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.8 MB)
2018-05-12 18:15:50 INFO  BlockManagerInfo:54 - Added broadcast_111_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:15:50 INFO  SparkContext:54 - Created broadcast 111 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:50 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@771a1165. The input RDD has 1 partitions.
2018-05-12 18:15:50 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:50 INFO  DAGScheduler:54 - Registering RDD 264 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:15:50 INFO  DAGScheduler:54 - Registering RDD 258 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:15:50 INFO  DAGScheduler:54 - Got job 24 (start at RateStreamStreamJoin.scala:51) with 1 output partitions
2018-05-12 18:15:50 INFO  DAGScheduler:54 - Final stage: ResultStage 38 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:15:50 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 37, ShuffleMapStage 36)
2018-05-12 18:15:50 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 37, ShuffleMapStage 36)
2018-05-12 18:15:50 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 36 (MapPartitionsRDD[264] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_112 stored as values in memory (estimated size 18.1 KB, free 361.8 MB)
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_112_piece0 stored as bytes in memory (estimated size 7.8 KB, free 361.8 MB)
2018-05-12 18:15:50 INFO  BlockManagerInfo:54 - Added broadcast_112_piece0 in memory on 192.168.19.162:43174 (size: 7.8 KB, free: 365.9 MB)
2018-05-12 18:15:50 INFO  SparkContext:54 - Created broadcast 112 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:15:50 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 36 (MapPartitionsRDD[264] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:15:50 INFO  TaskSchedulerImpl:54 - Adding task set 36.0 with 1 tasks
2018-05-12 18:15:50 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 37 (MapPartitionsRDD[258] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:15:50 INFO  TaskSetManager:54 - Starting task 0.0 in stage 36.0 (TID 34, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:15:50 INFO  Executor:54 - Running task 0.0 in stage 36.0 (TID 34)
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_113 stored as values in memory (estimated size 15.7 KB, free 361.7 MB)
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_113_piece0 stored as bytes in memory (estimated size 6.7 KB, free 361.7 MB)
2018-05-12 18:15:50 INFO  BlockManagerInfo:54 - Added broadcast_113_piece0 in memory on 192.168.19.162:43174 (size: 6.7 KB, free: 365.9 MB)
2018-05-12 18:15:50 INFO  SparkContext:54 - Created broadcast 113 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:15:50 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 37 (MapPartitionsRDD[258] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:15:50 INFO  TaskSchedulerImpl:54 - Adding task set 37.0 with 1 tasks
2018-05-12 18:15:50 INFO  TaskSetManager:54 - Starting task 0.0 in stage 37.0 (TID 35, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:15:50 INFO  Executor:54 - Running task 0.0 in stage 37.0 (TID 35)
2018-05-12 18:15:50 INFO  Executor:54 - Finished task 0.0 in stage 36.0 (TID 34). 1929 bytes result sent to driver
2018-05-12 18:15:50 INFO  TaskSetManager:54 - Finished task 0.0 in stage 36.0 (TID 34) in 22 ms on localhost (executor driver) (1/1)
2018-05-12 18:15:50 INFO  TaskSchedulerImpl:54 - Removed TaskSet 36.0, whose tasks have all completed, from pool 
2018-05-12 18:15:50 INFO  DAGScheduler:54 - ShuffleMapStage 36 (start at RateStreamStreamJoin.scala:51) finished in 0.038 s
2018-05-12 18:15:50 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:15:50 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 37)
2018-05-12 18:15:50 INFO  DAGScheduler:54 - waiting: Set(ResultStage 38)
2018-05-12 18:15:50 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:15:50 INFO  Executor:54 - Finished task 0.0 in stage 37.0 (TID 35). 1867 bytes result sent to driver
2018-05-12 18:15:50 INFO  TaskSetManager:54 - Finished task 0.0 in stage 37.0 (TID 35) in 21 ms on localhost (executor driver) (1/1)
2018-05-12 18:15:50 INFO  TaskSchedulerImpl:54 - Removed TaskSet 37.0, whose tasks have all completed, from pool 
2018-05-12 18:15:50 INFO  DAGScheduler:54 - ShuffleMapStage 37 (start at RateStreamStreamJoin.scala:51) finished in 0.036 s
2018-05-12 18:15:50 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:15:50 INFO  DAGScheduler:54 - running: Set()
2018-05-12 18:15:50 INFO  DAGScheduler:54 - waiting: Set(ResultStage 38)
2018-05-12 18:15:50 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:15:50 INFO  DAGScheduler:54 - Submitting ResultStage 38 (StateStoreAwareZipPartitionsRDD[266] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_114 stored as values in memory (estimated size 18.7 KB, free 361.7 MB)
2018-05-12 18:15:50 INFO  MemoryStore:54 - Block broadcast_114_piece0 stored as bytes in memory (estimated size 9.2 KB, free 361.7 MB)
2018-05-12 18:15:50 INFO  BlockManagerInfo:54 - Added broadcast_114_piece0 in memory on 192.168.19.162:43174 (size: 9.2 KB, free: 365.9 MB)
2018-05-12 18:15:50 INFO  SparkContext:54 - Created broadcast 114 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:15:50 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 38 (StateStoreAwareZipPartitionsRDD[266] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:15:50 INFO  TaskSchedulerImpl:54 - Adding task set 38.0 with 1 tasks
2018-05-12 18:15:50 INFO  TaskSetManager:54 - Starting task 0.0 in stage 38.0 (TID 36, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 18:15:50 INFO  Executor:54 - Running task 0.0 in stage 38.0 (TID 36)
2018-05-12 18:15:50 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:15:50 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2018-05-12 18:15:50 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:15:50 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:15:50 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:50 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:50 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@486fad0c
2018-05-12 18:15:50 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:15:50 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 12 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] for update
2018-05-12 18:15:50 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues)
2018-05-12 18:15:50 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:50 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:50 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@7e4e12a9
2018-05-12 18:15:50 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:15:50 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 12 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 18:15:50 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue)
2018-05-12 18:15:50 INFO  CodeGenerator:54 - Code generated in 19.051483 ms
2018-05-12 18:15:50 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:50 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:50 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@5cb17353
2018-05-12 18:15:50 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:15:50 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 12 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] for update
2018-05-12 18:15:50 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues)
2018-05-12 18:15:50 INFO  StateStore:54 - Env is not null
2018-05-12 18:15:50 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:15:50 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@1d6996a4
2018-05-12 18:15:50 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:15:50 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 12 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 18:15:50 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue)
2018-05-12 18:15:50 INFO  CodeGenerator:54 - Code generated in 12.112669 ms
2018-05-12 18:15:50 INFO  CodeGenerator:54 - Code generated in 11.491705 ms
2018-05-12 18:15:50 INFO  HDFSBackedStateStoreProvider:54 - Committed version 13 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/13.delta
2018-05-12 18:15:50 INFO  HDFSBackedStateStoreProvider:54 - Committed version 13 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/13.delta
2018-05-12 18:15:50 INFO  HDFSBackedStateStoreProvider:54 - Committed version 13 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/13.delta
2018-05-12 18:15:50 INFO  HDFSBackedStateStoreProvider:54 - Committed version 13 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/13.delta
2018-05-12 18:15:50 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 18:15:50 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 18:15:50 INFO  Executor:54 - Finished task 0.0 in stage 38.0 (TID 36). 5792 bytes result sent to driver
2018-05-12 18:15:50 INFO  TaskSetManager:54 - Finished task 0.0 in stage 38.0 (TID 36) in 188 ms on localhost (executor driver) (1/1)
2018-05-12 18:15:50 INFO  TaskSchedulerImpl:54 - Removed TaskSet 38.0, whose tasks have all completed, from pool 
2018-05-12 18:15:50 INFO  DAGScheduler:54 - ResultStage 38 (start at RateStreamStreamJoin.scala:51) finished in 0.243 s
2018-05-12 18:15:50 INFO  DAGScheduler:54 - Job 24 finished: start at RateStreamStreamJoin.scala:51, took 0.308634 s
2018-05-12 18:15:50 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@771a1165 is committing.
-------------------------------------------
Batch: 12
-------------------------------------------
+--------------+-----------------------+---------+-----------------------+
|impressionAdId|impressionTime         |clickAdId|clickTime              |
+--------------+-----------------------+---------+-----------------------+
|1303          |2018-05-12 18:15:19.529|1303     |2018-05-12 18:15:27.599|
|1319          |2018-05-12 18:15:22.729|1319     |2018-05-12 18:15:30.799|
|1320          |2018-05-12 18:15:22.929|1320     |2018-05-12 18:15:30.999|
|1329          |2018-05-12 18:15:24.729|1329     |2018-05-12 18:15:32.799|
|1343          |2018-05-12 18:15:27.529|1343     |2018-05-12 18:15:35.599|
|1352          |2018-05-12 18:15:29.329|1352     |2018-05-12 18:15:37.399|
|1373          |2018-05-12 18:15:33.529|1373     |2018-05-12 18:15:41.599|
|1381          |2018-05-12 18:15:35.129|1381     |2018-05-12 18:15:43.199|
|1390          |2018-05-12 18:15:36.929|1390     |2018-05-12 18:15:44.999|
|1394          |2018-05-12 18:15:37.729|1394     |2018-05-12 18:15:45.799|
|1403          |2018-05-12 18:15:39.529|1403     |2018-05-12 18:15:47.599|
+--------------+-----------------------+---------+-----------------------+

2018-05-12 18:15:50 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@771a1165 committed.
2018-05-12 18:15:50 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:15:50 INFO  DAGScheduler:54 - Job 25 finished: start at RateStreamStreamJoin.scala:51, took 0.000074 s
2018-05-12 18:15:50 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "0c6f7eb6-4f85-4322-9d17-ad4b241cd696",
  "runId" : "1f2f6927-f050-4179-8503-b350fe3ac6a4",
  "name" : null,
  "timestamp" : "2018-05-13T01:15:50.001Z",
  "batchId" : 12,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 10.0,
  "processedRowsPerSecond" : 285.38812785388126,
  "durationMs" : {
    "addBatch" : 514,
    "getBatch" : 35,
    "getOffset" : 0,
    "queryPlanning" : 286,
    "triggerExecution" : 875,
    "walCommit" : 35
  },
  "eventTime" : {
    "avg" : "2018-05-13T01:15:37.329Z",
    "max" : "2018-05-13T01:15:49.729Z",
    "min" : "2018-05-13T01:15:24.929Z",
    "watermark" : "2018-05-13T01:15:12.599Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 252,
    "numRowsUpdated" : 136,
    "memoryUsedBytes" : 106494
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 266,
    "endOffset" : 291,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 142.69406392694063
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 266,
    "endOffset" : 291,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 142.69406392694063
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@18366d4b"
  }
}
2018-05-12 18:16:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:16:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:16:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@5d3c34bc
2018-05-12 18:16:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:16:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:16:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@d1c7810
2018-05-12 18:16:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:16:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:16:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@79bfe7b5
2018-05-12 18:16:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:16:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:16:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@57d57de5
2018-05-12 18:16:15 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526174137599 ms
2018-05-12 18:16:15 INFO  MicroBatchExecution:54 - Committed offsets for batch 13. Metadata OffsetSeqMetadata(1526174137599,1526174175003,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_115 stored as values in memory (estimated size 277.7 KB, free 361.4 MB)
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_115_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.4 MB)
2018-05-12 18:16:15 INFO  BlockManagerInfo:54 - Added broadcast_115_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:16:15 INFO  SparkContext:54 - Created broadcast 115 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_116 stored as values in memory (estimated size 277.7 KB, free 361.1 MB)
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_116_piece0 stored as bytes in memory (estimated size 23.5 KB, free 361.1 MB)
2018-05-12 18:16:15 INFO  BlockManagerInfo:54 - Added broadcast_116_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:16:15 INFO  SparkContext:54 - Created broadcast 116 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_117 stored as values in memory (estimated size 277.7 KB, free 360.9 MB)
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_117_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.8 MB)
2018-05-12 18:16:15 INFO  BlockManagerInfo:54 - Added broadcast_117_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:16:15 INFO  SparkContext:54 - Created broadcast 117 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:15 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526174137599E12 * 1000.0) as double) + -1.0E7)
2018-05-12 18:16:15 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526174127598
2018-05-12 18:16:15 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526174137599E12 * 1000.0) as double)
2018-05-12 18:16:15 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526174137598
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_118 stored as values in memory (estimated size 277.7 KB, free 360.6 MB)
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_118_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.5 MB)
2018-05-12 18:16:15 INFO  BlockManagerInfo:54 - Added broadcast_118_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:16:15 INFO  SparkContext:54 - Created broadcast 118 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_119 stored as values in memory (estimated size 277.7 KB, free 360.3 MB)
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_119_piece0 stored as bytes in memory (estimated size 23.5 KB, free 360.2 MB)
2018-05-12 18:16:15 INFO  BlockManagerInfo:54 - Added broadcast_119_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:16:15 INFO  SparkContext:54 - Created broadcast 119 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_120 stored as values in memory (estimated size 277.7 KB, free 360.0 MB)
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_120_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.9 MB)
2018-05-12 18:16:15 INFO  BlockManagerInfo:54 - Added broadcast_120_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:16:15 INFO  SparkContext:54 - Created broadcast 120 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:15 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@65c9e070. The input RDD has 1 partitions.
2018-05-12 18:16:15 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:15 INFO  DAGScheduler:54 - Registering RDD 285 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:16:15 INFO  DAGScheduler:54 - Registering RDD 279 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:16:15 INFO  DAGScheduler:54 - Got job 26 (start at RateStreamStreamJoin.scala:51) with 1 output partitions
2018-05-12 18:16:15 INFO  DAGScheduler:54 - Final stage: ResultStage 41 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:16:15 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 39, ShuffleMapStage 40)
2018-05-12 18:16:15 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 39, ShuffleMapStage 40)
2018-05-12 18:16:15 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 39 (MapPartitionsRDD[285] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_121 stored as values in memory (estimated size 18.1 KB, free 359.9 MB)
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_121_piece0 stored as bytes in memory (estimated size 7.8 KB, free 359.9 MB)
2018-05-12 18:16:15 INFO  BlockManagerInfo:54 - Added broadcast_121_piece0 in memory on 192.168.19.162:43174 (size: 7.8 KB, free: 365.8 MB)
2018-05-12 18:16:15 INFO  SparkContext:54 - Created broadcast 121 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:16:15 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 39 (MapPartitionsRDD[285] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:16:15 INFO  TaskSchedulerImpl:54 - Adding task set 39.0 with 1 tasks
2018-05-12 18:16:15 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 40 (MapPartitionsRDD[279] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:16:15 INFO  TaskSetManager:54 - Starting task 0.0 in stage 39.0 (TID 37, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:16:15 INFO  Executor:54 - Running task 0.0 in stage 39.0 (TID 37)
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_122 stored as values in memory (estimated size 15.7 KB, free 359.9 MB)
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_122_piece0 stored as bytes in memory (estimated size 6.7 KB, free 359.9 MB)
2018-05-12 18:16:15 INFO  BlockManagerInfo:54 - Added broadcast_122_piece0 in memory on 192.168.19.162:43174 (size: 6.7 KB, free: 365.8 MB)
2018-05-12 18:16:15 INFO  SparkContext:54 - Created broadcast 122 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:16:15 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 40 (MapPartitionsRDD[279] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:16:15 INFO  TaskSchedulerImpl:54 - Adding task set 40.0 with 1 tasks
2018-05-12 18:16:15 INFO  TaskSetManager:54 - Starting task 0.0 in stage 40.0 (TID 38, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:16:15 INFO  Executor:54 - Running task 0.0 in stage 40.0 (TID 38)
2018-05-12 18:16:15 INFO  Executor:54 - Finished task 0.0 in stage 39.0 (TID 37). 1929 bytes result sent to driver
2018-05-12 18:16:15 INFO  TaskSetManager:54 - Finished task 0.0 in stage 39.0 (TID 37) in 40 ms on localhost (executor driver) (1/1)
2018-05-12 18:16:15 INFO  TaskSchedulerImpl:54 - Removed TaskSet 39.0, whose tasks have all completed, from pool 
2018-05-12 18:16:15 INFO  DAGScheduler:54 - ShuffleMapStage 39 (start at RateStreamStreamJoin.scala:51) finished in 0.062 s
2018-05-12 18:16:15 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:16:15 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 40)
2018-05-12 18:16:15 INFO  DAGScheduler:54 - waiting: Set(ResultStage 41)
2018-05-12 18:16:15 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:16:15 INFO  Executor:54 - Finished task 0.0 in stage 40.0 (TID 38). 1867 bytes result sent to driver
2018-05-12 18:16:15 INFO  TaskSetManager:54 - Finished task 0.0 in stage 40.0 (TID 38) in 46 ms on localhost (executor driver) (1/1)
2018-05-12 18:16:15 INFO  TaskSchedulerImpl:54 - Removed TaskSet 40.0, whose tasks have all completed, from pool 
2018-05-12 18:16:15 INFO  DAGScheduler:54 - ShuffleMapStage 40 (start at RateStreamStreamJoin.scala:51) finished in 0.064 s
2018-05-12 18:16:15 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:16:15 INFO  DAGScheduler:54 - running: Set()
2018-05-12 18:16:15 INFO  DAGScheduler:54 - waiting: Set(ResultStage 41)
2018-05-12 18:16:15 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:16:15 INFO  DAGScheduler:54 - Submitting ResultStage 41 (StateStoreAwareZipPartitionsRDD[287] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_123 stored as values in memory (estimated size 18.7 KB, free 359.9 MB)
2018-05-12 18:16:15 INFO  MemoryStore:54 - Block broadcast_123_piece0 stored as bytes in memory (estimated size 9.2 KB, free 359.9 MB)
2018-05-12 18:16:15 INFO  BlockManagerInfo:54 - Added broadcast_123_piece0 in memory on 192.168.19.162:43174 (size: 9.2 KB, free: 365.7 MB)
2018-05-12 18:16:15 INFO  SparkContext:54 - Created broadcast 123 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:16:15 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 41 (StateStoreAwareZipPartitionsRDD[287] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:16:15 INFO  TaskSchedulerImpl:54 - Adding task set 41.0 with 1 tasks
2018-05-12 18:16:15 INFO  TaskSetManager:54 - Starting task 0.0 in stage 41.0 (TID 39, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 18:16:15 INFO  Executor:54 - Running task 0.0 in stage 41.0 (TID 39)
2018-05-12 18:16:15 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:16:15 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:16:15 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:16:15 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2018-05-12 18:16:15 INFO  StateStore:54 - Env is not null
2018-05-12 18:16:15 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:16:15 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@5f7f44ad
2018-05-12 18:16:15 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:16:15 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 13 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] for update
2018-05-12 18:16:15 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues)
2018-05-12 18:16:15 INFO  StateStore:54 - Env is not null
2018-05-12 18:16:15 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:16:15 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@27fd3838
2018-05-12 18:16:15 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:16:15 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 13 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 18:16:15 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue)
2018-05-12 18:16:15 INFO  CodeGenerator:54 - Code generated in 14.376612 ms
2018-05-12 18:16:15 INFO  StateStore:54 - Env is not null
2018-05-12 18:16:15 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:16:15 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@287fd12c
2018-05-12 18:16:15 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:16:15 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 13 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] for update
2018-05-12 18:16:15 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues)
2018-05-12 18:16:15 INFO  StateStore:54 - Env is not null
2018-05-12 18:16:15 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:16:15 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@18fb7d1b
2018-05-12 18:16:15 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:16:15 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 13 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 18:16:15 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue)
2018-05-12 18:16:15 INFO  CodeGenerator:54 - Code generated in 11.269913 ms
2018-05-12 18:16:15 INFO  CodeGenerator:54 - Code generated in 7.914533 ms
2018-05-12 18:16:15 INFO  HDFSBackedStateStoreProvider:54 - Committed version 14 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/14.delta
2018-05-12 18:16:15 INFO  HDFSBackedStateStoreProvider:54 - Committed version 14 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/14.delta
2018-05-12 18:16:15 INFO  HDFSBackedStateStoreProvider:54 - Committed version 14 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/14.delta
2018-05-12 18:16:15 INFO  HDFSBackedStateStoreProvider:54 - Committed version 14 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/14.delta
2018-05-12 18:16:15 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 18:16:15 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 18:16:15 INFO  Executor:54 - Finished task 0.0 in stage 41.0 (TID 39). 5792 bytes result sent to driver
2018-05-12 18:16:15 INFO  TaskSetManager:54 - Finished task 0.0 in stage 41.0 (TID 39) in 186 ms on localhost (executor driver) (1/1)
2018-05-12 18:16:15 INFO  TaskSchedulerImpl:54 - Removed TaskSet 41.0, whose tasks have all completed, from pool 
2018-05-12 18:16:15 INFO  DAGScheduler:54 - ResultStage 41 (start at RateStreamStreamJoin.scala:51) finished in 0.235 s
2018-05-12 18:16:15 INFO  DAGScheduler:54 - Job 26 finished: start at RateStreamStreamJoin.scala:51, took 0.336810 s
2018-05-12 18:16:15 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@65c9e070 is committing.
-------------------------------------------
Batch: 13
-------------------------------------------
+--------------+-----------------------+---------+-----------------------+
|impressionAdId|impressionTime         |clickAdId|clickTime              |
+--------------+-----------------------+---------+-----------------------+
|1428          |2018-05-12 18:15:44.529|1428     |2018-05-12 18:15:52.599|
|1444          |2018-05-12 18:15:47.729|1444     |2018-05-12 18:15:55.799|
|1445          |2018-05-12 18:15:47.929|1445     |2018-05-12 18:15:55.999|
|1454          |2018-05-12 18:15:49.729|1454     |2018-05-12 18:15:57.799|
|1468          |2018-05-12 18:15:52.529|1468     |2018-05-12 18:16:00.599|
|1477          |2018-05-12 18:15:54.329|1477     |2018-05-12 18:16:02.399|
|1498          |2018-05-12 18:15:58.529|1498     |2018-05-12 18:16:06.599|
|1506          |2018-05-12 18:16:00.129|1506     |2018-05-12 18:16:08.199|
|1515          |2018-05-12 18:16:01.929|1515     |2018-05-12 18:16:09.999|
|1519          |2018-05-12 18:16:02.729|1519     |2018-05-12 18:16:10.799|
|1528          |2018-05-12 18:16:04.529|1528     |2018-05-12 18:16:12.599|
+--------------+-----------------------+---------+-----------------------+

2018-05-12 18:16:15 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@65c9e070 committed.
2018-05-12 18:16:15 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:15 INFO  DAGScheduler:54 - Job 27 finished: start at RateStreamStreamJoin.scala:51, took 0.000092 s
2018-05-12 18:16:15 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "0c6f7eb6-4f85-4322-9d17-ad4b241cd696",
  "runId" : "1f2f6927-f050-4179-8503-b350fe3ac6a4",
  "name" : null,
  "timestamp" : "2018-05-13T01:16:15.001Z",
  "batchId" : 13,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 10.0,
  "processedRowsPerSecond" : 295.159386068477,
  "durationMs" : {
    "addBatch" : 512,
    "getBatch" : 32,
    "getOffset" : 0,
    "queryPlanning" : 260,
    "triggerExecution" : 846,
    "walCommit" : 37
  },
  "eventTime" : {
    "avg" : "2018-05-13T01:16:02.329Z",
    "max" : "2018-05-13T01:16:14.729Z",
    "min" : "2018-05-13T01:15:49.929Z",
    "watermark" : "2018-05-13T01:15:37.599Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 252,
    "numRowsUpdated" : 136,
    "memoryUsedBytes" : 90078
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 291,
    "endOffset" : 316,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 147.5796930342385
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 291,
    "endOffset" : 316,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 147.5796930342385
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@18366d4b"
  }
}
2018-05-12 18:16:40 INFO  MicroBatchExecution:54 - Updating eventTime watermark to: 1526174162599 ms
2018-05-12 18:16:40 INFO  MicroBatchExecution:54 - Committed offsets for batch 14. Metadata OffsetSeqMetadata(1526174162599,1526174200002,Map(spark.sql.shuffle.partitions -> 1, spark.sql.streaming.stateStore.providerClass -> org.apache.spark.sql.execution.streaming.state.HDFSBackedStateStoreProvider))
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_124 stored as values in memory (estimated size 277.7 KB, free 359.6 MB)
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_124_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.6 MB)
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Added broadcast_124_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:16:40 INFO  SparkContext:54 - Created broadcast 124 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_125 stored as values in memory (estimated size 277.7 KB, free 359.3 MB)
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_125_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.3 MB)
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Added broadcast_125_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:16:40 INFO  SparkContext:54 - Created broadcast 125 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_126 stored as values in memory (estimated size 277.7 KB, free 359.0 MB)
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_126_piece0 stored as bytes in memory (estimated size 23.5 KB, free 359.0 MB)
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Added broadcast_126_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:16:40 INFO  SparkContext:54 - Created broadcast 126 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:40 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	(cast((1.526174162599E12 * 1000.0) as double) + -1.0E7)
2018-05-12 18:16:40 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526174152598
2018-05-12 18:16:40 INFO  StreamingJoinHelper:54 - Final expression to evaluate constraint:	cast((1.526174162599E12 * 1000.0) as double)
2018-05-12 18:16:40 INFO  StreamingJoinHelper:54 - Condition Some(((clickTime#18-T10000ms >= impressionTime#7-T10000ms) && (clickTime#18-T10000ms <= impressionTime#7-T10000ms + interval 10 seconds))) generated watermark constraint = 1526174162598
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_127 stored as values in memory (estimated size 277.7 KB, free 358.7 MB)
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_127_piece0 stored as bytes in memory (estimated size 23.5 KB, free 358.7 MB)
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Added broadcast_127_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.6 MB)
2018-05-12 18:16:40 INFO  SparkContext:54 - Created broadcast 127 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_128 stored as values in memory (estimated size 277.7 KB, free 358.4 MB)
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_128_piece0 stored as bytes in memory (estimated size 23.5 KB, free 358.4 MB)
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Added broadcast_128_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.6 MB)
2018-05-12 18:16:40 INFO  SparkContext:54 - Created broadcast 128 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_129 stored as values in memory (estimated size 277.7 KB, free 358.1 MB)
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_129_piece0 stored as bytes in memory (estimated size 23.5 KB, free 358.1 MB)
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Added broadcast_129_piece0 in memory on 192.168.19.162:43174 (size: 23.5 KB, free: 365.6 MB)
2018-05-12 18:16:40 INFO  SparkContext:54 - Created broadcast 129 from start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1307
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1143
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1141
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1226
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1304
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1339
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1323
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1374
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1315
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1346
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned shuffle 24
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1362
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1326
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1324
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1214
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1381
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1411
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1329
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1370
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1158
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1176
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1169
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1275
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_112_piece0 on 192.168.19.162:43174 in memory (size: 7.8 KB, free: 365.6 MB)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1153
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1357
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1284
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1344
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_107_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.6 MB)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1268
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1263
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1356
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1116
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1209
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1126
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1139
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_114_piece0 on 192.168.19.162:43174 in memory (size: 9.2 KB, free: 365.6 MB)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1166
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1352
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1199
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1333
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1168
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1335
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1194
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_118_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1127
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_128_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1290
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1222
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1331
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1197
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1135
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1291
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1202
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1180
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1392
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1261
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1270
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1224
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1206
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1359
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1388
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1239
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1159
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1322
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1250
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1193
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1348
2018-05-12 18:16:40 INFO  WriteToDataSourceV2Exec:54 - Start processing data source writer: org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@64c19159. The input RDD has 1 partitions.
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_102_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:16:40 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:40 INFO  DAGScheduler:54 - Registering RDD 300 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:16:40 INFO  DAGScheduler:54 - Registering RDD 306 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:16:40 INFO  DAGScheduler:54 - Got job 28 (start at RateStreamStreamJoin.scala:51) with 1 output partitions
2018-05-12 18:16:40 INFO  DAGScheduler:54 - Final stage: ResultStage 44 (start at RateStreamStreamJoin.scala:51)
2018-05-12 18:16:40 INFO  DAGScheduler:54 - Parents of final stage: List(ShuffleMapStage 42, ShuffleMapStage 43)
2018-05-12 18:16:40 INFO  DAGScheduler:54 - Missing parents: List(ShuffleMapStage 42, ShuffleMapStage 43)
2018-05-12 18:16:40 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 42 (MapPartitionsRDD[300] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_130 stored as values in memory (estimated size 15.7 KB, free 359.3 MB)
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_108_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.7 MB)
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_130_piece0 stored as bytes in memory (estimated size 6.7 KB, free 359.6 MB)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1249
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Added broadcast_130_piece0 in memory on 192.168.19.162:43174 (size: 6.7 KB, free: 365.7 MB)
2018-05-12 18:16:40 INFO  SparkContext:54 - Created broadcast 130 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:16:40 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 42 (MapPartitionsRDD[300] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:16:40 INFO  TaskSchedulerImpl:54 - Adding task set 42.0 with 1 tasks
2018-05-12 18:16:40 INFO  DAGScheduler:54 - Submitting ShuffleMapStage 43 (MapPartitionsRDD[306] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:16:40 INFO  TaskSetManager:54 - Starting task 0.0 in stage 42.0 (TID 40, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:16:40 INFO  Executor:54 - Running task 0.0 in stage 42.0 (TID 40)
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_121_piece0 on 192.168.19.162:43174 in memory (size: 7.8 KB, free: 365.7 MB)
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_131 stored as values in memory (estimated size 18.1 KB, free 359.6 MB)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1154
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1350
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1123
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1229
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1390
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1328
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1204
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1171
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1327
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1248
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1397
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1225
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_131_piece0 stored as bytes in memory (estimated size 7.8 KB, free 359.6 MB)
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Added broadcast_131_piece0 in memory on 192.168.19.162:43174 (size: 7.8 KB, free: 365.7 MB)
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_110_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:16:40 INFO  Executor:54 - Finished task 0.0 in stage 42.0 (TID 40). 1867 bytes result sent to driver
2018-05-12 18:16:40 INFO  SparkContext:54 - Created broadcast 131 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1243
2018-05-12 18:16:40 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ShuffleMapStage 43 (MapPartitionsRDD[306] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:16:40 INFO  TaskSchedulerImpl:54 - Adding task set 43.0 with 1 tasks
2018-05-12 18:16:40 INFO  TaskSetManager:54 - Starting task 0.0 in stage 43.0 (TID 41, localhost, executor driver, partition 0, PROCESS_LOCAL, 7842 bytes)
2018-05-12 18:16:40 INFO  TaskSetManager:54 - Finished task 0.0 in stage 42.0 (TID 40) in 28 ms on localhost (executor driver) (1/1)
2018-05-12 18:16:40 INFO  TaskSchedulerImpl:54 - Removed TaskSet 42.0, whose tasks have all completed, from pool 
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_109_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:16:40 INFO  Executor:54 - Running task 0.0 in stage 43.0 (TID 41)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1132
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1336
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1181
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1170
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1174
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_120_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:16:40 INFO  DAGScheduler:54 - ShuffleMapStage 42 (start at RateStreamStreamJoin.scala:51) finished in 0.061 s
2018-05-12 18:16:40 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1377
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1113
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1255
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1337
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1309
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1338
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1137
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1330
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1211
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1173
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1198
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1369
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1404
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1130
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1396
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1155
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1190
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1172
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1276
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1308
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1378
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1241
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1160
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1399
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1142
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1282
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1297
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1133
2018-05-12 18:16:40 INFO  DAGScheduler:54 - running: Set(ShuffleMapStage 43)
2018-05-12 18:16:40 INFO  DAGScheduler:54 - waiting: Set(ResultStage 44)
2018-05-12 18:16:40 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_106_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1267
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1269
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1256
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1131
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1257
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1121
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1205
2018-05-12 18:16:40 INFO  Executor:54 - Finished task 0.0 in stage 43.0 (TID 41). 1929 bytes result sent to driver
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned shuffle 26
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1238
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1244
2018-05-12 18:16:40 INFO  TaskSetManager:54 - Finished task 0.0 in stage 43.0 (TID 41) in 33 ms on localhost (executor driver) (1/1)
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_119_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.8 MB)
2018-05-12 18:16:40 INFO  TaskSchedulerImpl:54 - Removed TaskSet 43.0, whose tasks have all completed, from pool 
2018-05-12 18:16:40 INFO  DAGScheduler:54 - ShuffleMapStage 43 (start at RateStreamStreamJoin.scala:51) finished in 0.064 s
2018-05-12 18:16:40 INFO  DAGScheduler:54 - looking for newly runnable stages
2018-05-12 18:16:40 INFO  DAGScheduler:54 - running: Set()
2018-05-12 18:16:40 INFO  DAGScheduler:54 - waiting: Set(ResultStage 44)
2018-05-12 18:16:40 INFO  DAGScheduler:54 - failed: Set()
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1310
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1147
2018-05-12 18:16:40 INFO  DAGScheduler:54 - Submitting ResultStage 44 (StateStoreAwareZipPartitionsRDD[308] at start at RateStreamStreamJoin.scala:51), which has no missing parents
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1182
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1364
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1295
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1192
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1281
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1254
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1301
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1187
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1221
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1321
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1161
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1183
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1253
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1157
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1314
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1125
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_127_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1367
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1383
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1122
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1119
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1240
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_125_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_132 stored as values in memory (estimated size 18.7 KB, free 361.7 MB)
2018-05-12 18:16:40 INFO  MemoryStore:54 - Block broadcast_132_piece0 stored as bytes in memory (estimated size 9.2 KB, free 361.6 MB)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1258
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Added broadcast_132_piece0 in memory on 192.168.19.162:43174 (size: 9.2 KB, free: 365.9 MB)
2018-05-12 18:16:40 INFO  SparkContext:54 - Created broadcast 132 from broadcast at DAGScheduler.scala:1039
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_117_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:16:40 INFO  DAGScheduler:54 - Submitting 1 missing tasks from ResultStage 44 (StateStoreAwareZipPartitionsRDD[308] at start at RateStreamStreamJoin.scala:51) (first 15 tasks are for partitions Vector(0))
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1179
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1217
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1382
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1406
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1320
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1407
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1196
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1105
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1347
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1115
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1175
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1150
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1391
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1371
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1264
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1313
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1365
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1341
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1148
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1164
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1351
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1334
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1195
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1117
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1140
2018-05-12 18:16:40 INFO  TaskSchedulerImpl:54 - Adding task set 44.0 with 1 tasks
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_124_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 365.9 MB)
2018-05-12 18:16:40 INFO  TaskSetManager:54 - Starting task 0.0 in stage 44.0 (TID 42, localhost, executor driver, partition 0, PROCESS_LOCAL, 8082 bytes)
2018-05-12 18:16:40 INFO  Executor:54 - Running task 0.0 in stage 44.0 (TID 42)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1145
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1136
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1237
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1152
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1106
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1273
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1343
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1306
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1372
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1318
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_104_piece0 on 192.168.19.162:43174 in memory (size: 7.8 KB, free: 365.9 MB)
2018-05-12 18:16:40 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1114
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1102
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1373
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1231
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1118
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1274
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1236
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1215
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1203
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1111
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1234
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1361
2018-05-12 18:16:40 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 0 ms
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_123_piece0 on 192.168.19.162:43174 in memory (size: 9.2 KB, free: 365.9 MB)
2018-05-12 18:16:40 INFO  ShuffleBlockFetcherIterator:54 - Getting 1 non-empty blocks out of 1 blocks
2018-05-12 18:16:40 INFO  ShuffleBlockFetcherIterator:54 - Started 0 remote fetches in 1 ms
2018-05-12 18:16:40 INFO  StateStore:54 - Env is not null
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1292
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1312
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1128
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1144
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1213
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1242
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1405
2018-05-12 18:16:40 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:16:40 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@63e01858
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_103_piece0 on 192.168.19.162:43174 in memory (size: 6.7 KB, free: 365.9 MB)
2018-05-12 18:16:40 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:16:40 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 14 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] for update
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1384
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1146
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1311
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1245
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1134
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1354
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1186
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1207
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1156
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1285
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1110
2018-05-12 18:16:40 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyToNumValues)
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_105_piece0 on 192.168.19.162:43174 in memory (size: 9.2 KB, free: 366.0 MB)
2018-05-12 18:16:40 INFO  StateStore:54 - Env is not null
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1262
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1233
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1299
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1389
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1300
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1302
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1394
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1283
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1178
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1260
2018-05-12 18:16:40 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_111_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:16:40 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@69799453
2018-05-12 18:16:40 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1303
2018-05-12 18:16:40 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 14 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] for update
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned shuffle 27
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1165
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1235
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1184
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1288
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1345
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1201
2018-05-12 18:16:40 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,left-keyWithIndexToValue)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned shuffle 22
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1294
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1259
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1293
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_116_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1167
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1246
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_99_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.0 MB)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1185
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1210
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1393
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1342
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1277
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1305
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1319
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1363
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1232
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_113_piece0 on 192.168.19.162:43174 in memory (size: 6.7 KB, free: 366.0 MB)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1271
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1376
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1380
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1349
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1317
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1227
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1189
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1296
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1410
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1107
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1151
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1379
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1385
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_122_piece0 on 192.168.19.162:43174 in memory (size: 6.7 KB, free: 366.0 MB)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1177
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1230
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1353
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1366
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1124
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1228
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1287
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1220
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1265
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1402
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1400
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1191
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1289
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1395
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1163
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1138
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1398
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1358
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1355
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1108
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1109
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1162
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1272
2018-05-12 18:16:40 INFO  CodeGenerator:54 - Code generated in 15.248088 ms
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1212
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1252
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1298
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1218
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1097
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1247
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1223
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned shuffle 25
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1251
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1103
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1216
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1208
2018-05-12 18:16:40 INFO  StateStore:54 - Env is not null
2018-05-12 18:16:40 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:16:40 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@69677068
2018-05-12 18:16:40 INFO  BlockManagerInfo:54 - Removed broadcast_115_piece0 on 192.168.19.162:43174 in memory (size: 23.5 KB, free: 366.1 MB)
2018-05-12 18:16:40 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:16:40 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 14 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] for update
2018-05-12 18:16:40 INFO  SymmetricHashJoinStateManager$KeyToNumValuesStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyToNumValues)
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1386
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1101
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1096
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1112
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1129
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1266
2018-05-12 18:16:40 INFO  StateStore:54 - Env is not null
2018-05-12 18:16:40 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1200
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1368
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1401
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1325
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1278
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1188
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1279
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1316
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1120
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1149
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1340
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1403
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1360
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1387
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1280
2018-05-12 18:16:40 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@41dd73e7
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1375
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1286
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1332
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1219
2018-05-12 18:16:40 INFO  StateStore:54 - Reported that the loaded instance StateStoreProviderId(StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue),1f2f6927-f050-4179-8503-b350fe3ac6a4) is active
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned shuffle 23
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1100
2018-05-12 18:16:40 INFO  ContextCleaner:54 - Cleaned accumulator 1104
2018-05-12 18:16:40 INFO  HDFSBackedStateStoreProvider:54 - Retrieved version 14 of HDFSStateStoreProvider[id = (op=0,part=0),dir = file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] for update
2018-05-12 18:16:40 INFO  SymmetricHashJoinStateManager$KeyWithIndexToValueStore:54 - Loaded store StateStoreId(file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state,0,0,right-keyWithIndexToValue)
2018-05-12 18:16:40 INFO  CodeGenerator:54 - Code generated in 8.927908 ms
2018-05-12 18:16:40 INFO  CodeGenerator:54 - Code generated in 9.894424 ms
2018-05-12 18:16:40 INFO  HDFSBackedStateStoreProvider:54 - Committed version 15 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyToNumValues/15.delta
2018-05-12 18:16:40 INFO  HDFSBackedStateStoreProvider:54 - Committed version 15 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/left-keyWithIndexToValue/15.delta
2018-05-12 18:16:40 INFO  HDFSBackedStateStoreProvider:54 - Committed version 15 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyToNumValues/15.delta
2018-05-12 18:16:40 INFO  HDFSBackedStateStoreProvider:54 - Committed version 15 for HDFSStateStore[id=(op=0,part=0),dir=file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue] to file file:/tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89/state/0/0/right-keyWithIndexToValue/15.delta
2018-05-12 18:16:40 INFO  DataWritingSparkTask:54 - Writer for partition 0 is committing.
2018-05-12 18:16:40 INFO  DataWritingSparkTask:54 - Writer for partition 0 committed.
2018-05-12 18:16:40 INFO  Executor:54 - Finished task 0.0 in stage 44.0 (TID 42). 5835 bytes result sent to driver
2018-05-12 18:16:40 INFO  TaskSetManager:54 - Finished task 0.0 in stage 44.0 (TID 42) in 171 ms on localhost (executor driver) (1/1)
2018-05-12 18:16:40 INFO  TaskSchedulerImpl:54 - Removed TaskSet 44.0, whose tasks have all completed, from pool 
2018-05-12 18:16:40 INFO  DAGScheduler:54 - ResultStage 44 (start at RateStreamStreamJoin.scala:51) finished in 0.219 s
2018-05-12 18:16:40 INFO  DAGScheduler:54 - Job 28 finished: start at RateStreamStreamJoin.scala:51, took 0.316608 s
2018-05-12 18:16:40 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@64c19159 is committing.
-------------------------------------------
Batch: 14
-------------------------------------------
+--------------+-----------------------+---------+-----------------------+
|impressionAdId|impressionTime         |clickAdId|clickTime              |
+--------------+-----------------------+---------+-----------------------+
|1553          |2018-05-12 18:16:09.529|1553     |2018-05-12 18:16:17.599|
|1569          |2018-05-12 18:16:12.729|1569     |2018-05-12 18:16:20.799|
|1570          |2018-05-12 18:16:12.929|1570     |2018-05-12 18:16:20.999|
|1579          |2018-05-12 18:16:14.729|1579     |2018-05-12 18:16:22.799|
|1593          |2018-05-12 18:16:17.529|1593     |2018-05-12 18:16:25.599|
|1602          |2018-05-12 18:16:19.329|1602     |2018-05-12 18:16:27.399|
|1623          |2018-05-12 18:16:23.529|1623     |2018-05-12 18:16:31.599|
|1631          |2018-05-12 18:16:25.129|1631     |2018-05-12 18:16:33.199|
|1640          |2018-05-12 18:16:26.929|1640     |2018-05-12 18:16:34.999|
|1644          |2018-05-12 18:16:27.729|1644     |2018-05-12 18:16:35.799|
|1653          |2018-05-12 18:16:29.529|1653     |2018-05-12 18:16:37.599|
+--------------+-----------------------+---------+-----------------------+

2018-05-12 18:16:40 INFO  WriteToDataSourceV2Exec:54 - Data source writer org.apache.spark.sql.execution.streaming.sources.MicroBatchWriter@64c19159 committed.
2018-05-12 18:16:40 INFO  SparkContext:54 - Starting job: start at RateStreamStreamJoin.scala:51
2018-05-12 18:16:40 INFO  DAGScheduler:54 - Job 29 finished: start at RateStreamStreamJoin.scala:51, took 0.000056 s
2018-05-12 18:16:40 INFO  MicroBatchExecution:54 - Streaming query made progress: {
  "id" : "0c6f7eb6-4f85-4322-9d17-ad4b241cd696",
  "runId" : "1f2f6927-f050-4179-8503-b350fe3ac6a4",
  "name" : null,
  "timestamp" : "2018-05-13T01:16:40.001Z",
  "batchId" : 14,
  "numInputRows" : 250,
  "inputRowsPerSecond" : 10.0,
  "processedRowsPerSecond" : 275.3303964757709,
  "durationMs" : {
    "addBatch" : 567,
    "getBatch" : 31,
    "getOffset" : 0,
    "queryPlanning" : 265,
    "triggerExecution" : 908,
    "walCommit" : 42
  },
  "eventTime" : {
    "avg" : "2018-05-13T01:16:27.329Z",
    "max" : "2018-05-13T01:16:39.729Z",
    "min" : "2018-05-13T01:16:14.929Z",
    "watermark" : "2018-05-13T01:16:02.599Z"
  },
  "stateOperators" : [ {
    "numRowsTotal" : 252,
    "numRowsUpdated" : 136,
    "memoryUsedBytes" : 103726
  } ],
  "sources" : [ {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 316,
    "endOffset" : 341,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 137.66519823788545
  }, {
    "description" : "RateSource[rowsPerSecond=5, rampUpTimeSeconds=0, numPartitions=1]",
    "startOffset" : 316,
    "endOffset" : 341,
    "numInputRows" : 125,
    "inputRowsPerSecond" : 5.0,
    "processedRowsPerSecond" : 137.66519823788545
  } ],
  "sink" : {
    "description" : "org.apache.spark.sql.execution.streaming.ConsoleSinkProvider@18366d4b"
  }
}
2018-05-12 18:17:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:17:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:17:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@6f0200f0
2018-05-12 18:17:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:17:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:17:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@13029f8
2018-05-12 18:17:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:17:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:17:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@734f424
2018-05-12 18:17:01 INFO  StateStore:54 - Env is not null
2018-05-12 18:17:01 INFO  StateStore:54 - Getting StateStoreCoordinatorRef
2018-05-12 18:17:01 INFO  StateStore:54 - Retrieved reference to StateStoreCoordinator: org.apache.spark.sql.execution.streaming.state.StateStoreCoordinatorRef@7bf29b72
2018-05-12 18:17:02 INFO  SparkContext:54 - Invoking stop() from shutdown hook
2018-05-12 18:17:02 INFO  AbstractConnector:318 - Stopped Spark@2a7b6f69{HTTP/1.1,[http/1.1]}{0.0.0.0:4040}
2018-05-12 18:17:02 INFO  SparkUI:54 - Stopped Spark web UI at http://192.168.19.162:4040
2018-05-12 18:17:02 INFO  MapOutputTrackerMasterEndpoint:54 - MapOutputTrackerMasterEndpoint stopped!
2018-05-12 18:17:02 INFO  MemoryStore:54 - MemoryStore cleared
2018-05-12 18:17:02 INFO  BlockManager:54 - BlockManager stopped
2018-05-12 18:17:02 INFO  BlockManagerMaster:54 - BlockManagerMaster stopped
2018-05-12 18:17:02 INFO  OutputCommitCoordinator$OutputCommitCoordinatorEndpoint:54 - OutputCommitCoordinator stopped!
2018-05-12 18:17:02 INFO  SparkContext:54 - Successfully stopped SparkContext
2018-05-12 18:17:02 INFO  ShutdownHookManager:54 - Shutdown hook called
2018-05-12 18:17:02 INFO  ShutdownHookManager:54 - Deleting directory /tmp/temporary-bafdc08a-3fdd-4fe5-84df-4f70cc058e89
2018-05-12 18:17:02 INFO  ShutdownHookManager:54 - Deleting directory /tmp/spark-f24fcbce-343c-4734-80e6-ada2553e7ced
2018-05-12 18:17:02 INFO  ShutdownHookManager:54 - Deleting directory /tmp/temporaryReader-efdfc1b7-7d92-4b58-a575-bfc4a43213c4
2018-05-12 18:17:02 INFO  ShutdownHookManager:54 - Deleting directory /tmp/temporaryReader-2e312807-0348-44d2-ab0e-95c39e3fefad
2018-05-12 18:17:02 INFO  ShutdownHookManager:54 - Deleting directory /tmp/spark-d53eaa07-e045-4a2f-9b74-f8b01911e0e9
